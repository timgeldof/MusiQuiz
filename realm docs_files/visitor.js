/*! 2019-10-17 3:54:09 PM */
window.livechat=window.livechat||{},window.livechat.VERSION="1.0.0",Object.defineProperty(Array.prototype,"nativeReduce",{enumerable:!1,value:nativeReduce});var nativeReduce=function(e){"use strict";if(null==this)throw new TypeError("Array.prototype.reduce called on null or undefined");if("function"!=typeof e)throw new TypeError(e+" is not a function");var t,n=Object(this),i=n.length>>>0,r=0;if(2==arguments.length)t=arguments[1];else{for(;r<i&&!r in n;)r++;if(i<=r)throw new TypeError("Reduce of empty array with no initial value");t=n[r++]}for(;r<i;r++)r in n&&(t=e(t,n[r],r,n));return t},livechat=livechat||{};if(window.io&&(window.previous_io=window.io),function(e){var t,C;"undefined"!=typeof window?t=window:"undefined"!=typeof global?t=global:"undefined"!=typeof self&&(t=self),t.io=function r(o,s,a){function c(n,e){if(!s[n]){if(!o[n]){var t="function"==typeof require&&require;if(!e&&t)return t(n,!0);if(l)return l(n,!0);throw new Error("Cannot find module '"+n+"'")}var i=s[n]={exports:{}};o[n][0].call(i.exports,function(e){var t=o[n][1][e];return c(t||e)},i,i.exports,r,o,s,a)}return s[n].exports}for(var l="function"==typeof require&&require,e=0;e<a.length;e++)c(a[e]);return c}({1:[function(e,t,n){t.exports=e("./lib/")},{"./lib/":2}],2:[function(e,t,n){var o=e("./url"),i=e("socket.io-parser"),s=e("./manager"),a=e("debug")("socket.io-client");t.exports=n=r;var c=n.managers={};function r(e,t){"object"==typeof e&&(t=e,e=void 0),t=t||{};var n=o(e),i=n.source,r=n.id;return(t.forceNew||t["force new connection"]||!1===t.multiplex?(a("ignoring socket cache for %s",i),s(i,t)):(c[r]||(a("new io instance for %s",i),c[r]=s(i,t)),c[r])).socket(n.path)}n.protocol=i.protocol,n.connect=r,n.Manager=e("./manager"),n.Socket=e("./socket")},{"./manager":3,"./socket":5,"./url":6,debug:10,"socket.io-parser":46}],3:[function(e,t,n){e("./url");var a=e("engine.io-client"),i=e("./socket"),r=e("component-emitter"),o=e("socket.io-parser"),c=e("./on"),s=e("component-bind"),l=(e("object-component"),e("debug")("socket.io-client:manager")),u=e("indexof"),h=e("backo2");function d(e,t){if(!(this instanceof d))return new d(e,t);e&&"object"==typeof e&&(t=e,e=void 0),(t=t||{}).path=t.path||"/socket.io",this.nsps={},this.subs=[],this.opts=t,this.reconnection(!1!==t.reconnection),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor(t.randomizationFactor||.5),this.backoff=new h({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==t.timeout?2e4:t.timeout),this.readyState="closed",this.uri=e,this.connected=[],this.encoding=!1,this.packetBuffer=[],this.encoder=new o.Encoder,this.decoder=new o.Decoder,this.autoConnect=!1!==t.autoConnect,this.autoConnect&&this.open()}(t.exports=d).prototype.emitAll=function(){for(var e in this.emit.apply(this,arguments),this.nsps)this.nsps[e].emit.apply(this.nsps[e],arguments)},d.prototype.updateSocketIds=function(){for(var e in this.nsps)this.nsps[e].id=this.engine.id},r(d.prototype),d.prototype.reconnection=function(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection},d.prototype.reconnectionAttempts=function(e){return arguments.length?(this._reconnectionAttempts=e,this):this._reconnectionAttempts},d.prototype.reconnectionDelay=function(e){return arguments.length?(this._reconnectionDelay=e,this.backoff&&this.backoff.setMin(e),this):this._reconnectionDelay},d.prototype.randomizationFactor=function(e){return arguments.length?(this._randomizationFactor=e,this.backoff&&this.backoff.setJitter(e),this):this._randomizationFactor},d.prototype.reconnectionDelayMax=function(e){return arguments.length?(this._reconnectionDelayMax=e,this.backoff&&this.backoff.setMax(e),this):this._reconnectionDelayMax},d.prototype.timeout=function(e){return arguments.length?(this._timeout=e,this):this._timeout},d.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()},d.prototype.open=d.prototype.connect=function(n){if(l("readyState %s",this.readyState),~this.readyState.indexOf("open"))return this;l("opening %s",this.uri),this.engine=a(this.uri,this.opts);var e=this.engine,i=this;this.readyState="opening",this.skipReconnect=!1;var t=c(e,"open",function(){i.onopen(),n&&n()}),r=c(e,"error",function(e){if(l("connect_error"),i.cleanup(),i.readyState="closed",i.emitAll("connect_error",e),n){var t=new Error("Connection error");t.data=e,n(t)}else i.maybeReconnectOnOpen()});if(!1!==this._timeout){var o=this._timeout;l("connect attempt will timeout after %d",o);var s=setTimeout(function(){l("connect attempt timed out after %d",o),t.destroy(),e.close(),e.emit("error","timeout"),i.emitAll("connect_timeout",o)},o);this.subs.push({destroy:function(){clearTimeout(s)}})}return this.subs.push(t),this.subs.push(r),this},d.prototype.onopen=function(){l("open"),this.cleanup(),this.readyState="open",this.emit("open");var e=this.engine;this.subs.push(c(e,"data",s(this,"ondata"))),this.subs.push(c(this.decoder,"decoded",s(this,"ondecoded"))),this.subs.push(c(e,"error",s(this,"onerror"))),this.subs.push(c(e,"close",s(this,"onclose")))},d.prototype.ondata=function(e){this.decoder.add(e)},d.prototype.ondecoded=function(e){this.emit("packet",e)},d.prototype.onerror=function(e){l("error",e),this.emitAll("error",e)},d.prototype.socket=function(e){var t=this.nsps[e];if(!t){t=new i(this,e),this.nsps[e]=t;var n=this;t.on("connect",function(){t.id=n.engine.id,~u(n.connected,t)||n.connected.push(t)})}return t},d.prototype.destroy=function(e){var t=u(this.connected,e);~t&&this.connected.splice(t,1),this.connected.length||this.close()},d.prototype.packet=function(e){l("writing packet %j",e);var n=this;n.encoding?n.packetBuffer.push(e):(n.encoding=!0,this.encoder.encode(e,function(e){for(var t=0;t<e.length;t++)n.engine.write(e[t]);n.encoding=!1,n.processPacketQueue()}))},d.prototype.processPacketQueue=function(){if(0<this.packetBuffer.length&&!this.encoding){var e=this.packetBuffer.shift();this.packet(e)}},d.prototype.cleanup=function(){for(var e;e=this.subs.shift();)e.destroy();this.packetBuffer=[],this.encoding=!1,this.decoder.destroy()},d.prototype.close=d.prototype.disconnect=function(){this.skipReconnect=!0,this.backoff.reset(),this.readyState="closed",this.engine&&this.engine.close()},d.prototype.onclose=function(e){l("close"),this.cleanup(),this.backoff.reset(),this.readyState="closed",this.emit("close",e),this._reconnection&&!this.skipReconnect&&this.reconnect()},d.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var t=this;if(this.backoff.attempts>=this._reconnectionAttempts)l("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1;else{var e=this.backoff.duration();l("will wait %dms before reconnect attempt",e),this.reconnecting=!0;var n=setTimeout(function(){t.skipReconnect||(l("attempting reconnect"),t.emitAll("reconnect_attempt",t.backoff.attempts),t.emitAll("reconnecting",t.backoff.attempts),t.skipReconnect||t.open(function(e){e?(l("reconnect attempt error"),t.reconnecting=!1,t.reconnect(),t.emitAll("reconnect_error",e.data)):(l("reconnect success"),t.onreconnect())}))},e);this.subs.push({destroy:function(){clearTimeout(n)}})}},d.prototype.onreconnect=function(){var e=this.backoff.attempts;this.reconnecting=!1,this.backoff.reset(),this.updateSocketIds(),this.emitAll("reconnect",e)}},{"./on":4,"./socket":5,"./url":6,backo2:7,"component-bind":8,"component-emitter":9,debug:10,"engine.io-client":11,indexof:42,"object-component":43,"socket.io-parser":46}],4:[function(e,t,n){t.exports=function(e,t,n){return e.on(t,n),{destroy:function(){e.removeListener(t,n)}}}},{}],5:[function(e,t,n){var o=e("socket.io-parser"),i=e("component-emitter"),s=e("to-array"),r=e("./on"),a=e("component-bind"),c=e("debug")("socket.io-client:socket"),l=e("has-binary");t.exports=d;var u={connect:1,connect_error:1,connect_timeout:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1},h=i.prototype.emit;function d(e,t){this.io=e,this.nsp=t,(this.json=this).ids=0,this.acks={},this.io.autoConnect&&this.open(),this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0}i(d.prototype),d.prototype.subEvents=function(){if(!this.subs){var e=this.io;this.subs=[r(e,"open",a(this,"onopen")),r(e,"packet",a(this,"onpacket")),r(e,"close",a(this,"onclose"))]}},d.prototype.open=d.prototype.connect=function(){return this.connected||(this.subEvents(),this.io.open(),"open"==this.io.readyState&&this.onopen()),this},d.prototype.send=function(){var e=s(arguments);return e.unshift("message"),this.emit.apply(this,e),this},d.prototype.emit=function(e){if(u.hasOwnProperty(e))return h.apply(this,arguments),this;var t=s(arguments),n=o.EVENT;l(t)&&(n=o.BINARY_EVENT);var i={type:n,data:t};return"function"==typeof t[t.length-1]&&(c("emitting packet with ack id %d",this.ids),this.acks[this.ids]=t.pop(),i.id=this.ids++),this.connected?this.packet(i):this.sendBuffer.push(i),this},d.prototype.packet=function(e){e.nsp=this.nsp,this.io.packet(e)},d.prototype.onopen=function(){c("transport is open - connecting"),"/"!=this.nsp&&this.packet({type:o.CONNECT})},d.prototype.onclose=function(e){c("close (%s)",e),this.connected=!1,this.disconnected=!0,delete this.id,this.emit("disconnect",e)},d.prototype.onpacket=function(e){if(e.nsp==this.nsp)switch(e.type){case o.CONNECT:this.onconnect();break;case o.EVENT:case o.BINARY_EVENT:this.onevent(e);break;case o.ACK:case o.BINARY_ACK:this.onack(e);break;case o.DISCONNECT:this.ondisconnect();break;case o.ERROR:this.emit("error",e.data)}},d.prototype.onevent=function(e){var t=e.data||[];c("emitting event %j",t),null!=e.id&&(c("attaching ack callback to event"),t.push(this.ack(e.id))),this.connected?h.apply(this,t):this.receiveBuffer.push(t)},d.prototype.ack=function(n){var i=this,r=!1;return function(){if(!r){r=!0;var e=s(arguments);c("sending ack %j",e);var t=l(e)?o.BINARY_ACK:o.ACK;i.packet({type:t,id:n,data:e})}}},d.prototype.onack=function(e){c("calling ack %s with %j",e.id,e.data);var t=this.acks[e.id];t.apply(this,e.data),delete this.acks[e.id]},d.prototype.onconnect=function(){this.connected=!0,this.disconnected=!1,this.emit("connect"),this.emitBuffered()},d.prototype.emitBuffered=function(){var e;for(e=0;e<this.receiveBuffer.length;e++)h.apply(this,this.receiveBuffer[e]);for(this.receiveBuffer=[],e=0;e<this.sendBuffer.length;e++)this.packet(this.sendBuffer[e]);this.sendBuffer=[]},d.prototype.ondisconnect=function(){c("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")},d.prototype.destroy=function(){if(this.subs){for(var e=0;e<this.subs.length;e++)this.subs[e].destroy();this.subs=null}this.io.destroy(this)},d.prototype.close=d.prototype.disconnect=function(){return this.connected&&(c("performing disconnect (%s)",this.nsp),this.packet({type:o.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}},{"./on":4,"component-bind":8,"component-emitter":9,debug:10,"has-binary":38,"socket.io-parser":46,"to-array":50}],6:[function(e,t,n){(function(i){var r=e("parseuri"),o=e("debug")("socket.io-client:url");t.exports=function(e,t){var n=e,t=t||i.location;return null==e&&(e=t.protocol+"//"+t.host),"string"==typeof e&&("/"==e.charAt(0)&&(e="/"==e.charAt(1)?t.protocol+e:t.hostname+e),/^(https?|wss?):\/\//.test(e)||(o("protocol-less url %s",e),e=void 0!==t?t.protocol+"//"+e:"https://"+e),o("parse %s",e),n=r(e)),n.port||(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443")),n.path=n.path||"/",n.id=n.protocol+"://"+n.host+":"+n.port,n.href=n.protocol+"://"+n.host+(t&&t.port==n.port?"":":"+n.port),n}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{debug:10,parseuri:44}],7:[function(e,t,n){function i(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=0<e.jitter&&e.jitter<=1?e.jitter:0,this.attempts=0}(t.exports=i).prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),n=Math.floor(t*this.jitter*e);e=0==(1&Math.floor(10*t))?e-n:e+n}return 0|Math.min(e,this.max)},i.prototype.reset=function(){this.attempts=0},i.prototype.setMin=function(e){this.ms=e},i.prototype.setMax=function(e){this.max=e},i.prototype.setJitter=function(e){this.jitter=e}},{}],8:[function(e,t,n){var i=[].slice;t.exports=function(e,t){if("string"==typeof t&&(t=e[t]),"function"!=typeof t)throw new Error("bind() requires a function");var n=i.call(arguments,2);return function(){return t.apply(e,n.concat(i.call(arguments)))}}},{}],9:[function(e,t,n){function i(e){if(e)return function(e){for(var t in i.prototype)e[t]=i.prototype[t];return e}(e)}(t.exports=i).prototype.on=i.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks[e]=this._callbacks[e]||[]).push(t),this},i.prototype.once=function(e,t){var n=this;function i(){n.off(e,i),t.apply(this,arguments)}return this._callbacks=this._callbacks||{},i.fn=t,this.on(e,i),this},i.prototype.off=i.prototype.removeListener=i.prototype.removeAllListeners=i.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,i=this._callbacks[e];if(!i)return this;if(1==arguments.length)return delete this._callbacks[e],this;for(var r=0;r<i.length;r++)if((n=i[r])===t||n.fn===t){i.splice(r,1);break}return this},i.prototype.emit=function(e){this._callbacks=this._callbacks||{};var t=[].slice.call(arguments,1),n=this._callbacks[e];if(n){n=n.slice(0);for(var i=0,r=n.length;i<r;++i)n[i].apply(this,t)}return this},i.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks[e]||[]},i.prototype.hasListeners=function(e){return!!this.listeners(e).length}},{}],10:[function(e,t,n){function o(r){return o.enabled(r)?function(e){var t;e=(t=e)instanceof Error?t.stack||t.message:t;var n=new Date,i=n-(o[r]||n);o[r]=n,e=r+" "+e+" +"+o.humanize(i),window.console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}:function(){}}(t.exports=o).names=[],o.skips=[],o.enable=function(e){try{localStorage.debug=e}catch(e){}for(var t=(e||"").split(/[\s,]+/),n=t.length,i=0;i<n;i++)"-"===(e=t[i].replace("*",".*?"))[0]?o.skips.push(new RegExp("^"+e.substr(1)+"$")):o.names.push(new RegExp("^"+e+"$"))},o.disable=function(){o.enable("")},o.humanize=function(e){return 36e5<=e?(e/36e5).toFixed(1)+"h":6e4<=e?(e/6e4).toFixed(1)+"m":1e3<=e?(e/1e3|0)+"s":e+"ms"},o.enabled=function(e){for(var t=0,n=o.skips.length;t<n;t++)if(o.skips[t].test(e))return!1;for(var t=0,n=o.names.length;t<n;t++)if(o.names[t].test(e))return!0;return!1};try{window.localStorage&&o.enable(localStorage.debug)}catch(e){}},{}],11:[function(e,t,n){t.exports=e("./lib/")},{"./lib/":12}],12:[function(e,t,n){t.exports=e("./socket"),t.exports.parser=e("engine.io-parser")},{"./socket":13,"engine.io-parser":25}],13:[function(t,l,e){(function(i){var r=t("./transports"),e=t("component-emitter"),h=t("debug")("engine.io-client:socket"),o=t("indexof"),s=t("engine.io-parser"),a=t("parseuri"),n=t("parsejson"),c=t("parseqs");function d(e,t){if(!(this instanceof d))return new d(e,t);if(t=t||{},e&&"object"==typeof e&&(t=e,e=null),e&&(e=a(e),t.host=e.host,t.secure="https"==e.protocol||"wss"==e.protocol,t.port=e.port,e.query&&(t.query=e.query)),this.secure=null!=t.secure?t.secure:i.location&&"https:"==location.protocol,t.host){var n=t.host.split(":");t.hostname=n.shift(),n.length?t.port=n.pop():t.port||(t.port=this.secure?"443":"80")}this.agent=t.agent||!1,this.hostname=t.hostname||(i.location?location.hostname:"localhost"),this.port=t.port||(i.location&&location.port?location.port:this.secure?443:80),this.query=t.query||{},"string"==typeof this.query&&(this.query=c.decode(this.query)),this.upgrade=!1!==t.upgrade,this.path=(t.path||"/engine.io").replace(/\/$/,"")+"/",this.forceJSONP=!!t.forceJSONP,this.jsonp=!1!==t.jsonp,this.forceBase64=!!t.forceBase64,this.enablesXDR=!!t.enablesXDR,this.timestampParam=t.timestampParam||"t",this.timestampRequests=t.timestampRequests,this.transports=t.transports||["polling","websocket"],this.readyState="",this.writeBuffer=[],this.callbackBuffer=[],this.policyPort=t.policyPort||843,this.rememberUpgrade=t.rememberUpgrade||!1,this.binaryType=null,this.onlyBinaryUpgrades=t.onlyBinaryUpgrades,this.pfx=t.pfx||null,this.key=t.key||null,this.passphrase=t.passphrase||null,this.cert=t.cert||null,this.ca=t.ca||null,this.ciphers=t.ciphers||null,this.rejectUnauthorized=t.rejectUnauthorized||null,this.open()}(l.exports=d).priorWebsocketSuccess=!1,e(d.prototype),d.protocol=s.protocol,(d.Socket=d).Transport=t("./transport"),d.transports=t("./transports"),d.parser=t("engine.io-parser"),d.prototype.createTransport=function(e){h('creating transport "%s"',e);var t=function(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}(this.query);t.EIO=s.protocol,t.transport=e,this.id&&(t.sid=this.id);var n=new r[e]({agent:this.agent,hostname:this.hostname,port:this.port,secure:this.secure,path:this.path,query:t,forceJSONP:this.forceJSONP,jsonp:this.jsonp,forceBase64:this.forceBase64,enablesXDR:this.enablesXDR,timestampRequests:this.timestampRequests,timestampParam:this.timestampParam,policyPort:this.policyPort,socket:this,pfx:this.pfx,key:this.key,passphrase:this.passphrase,cert:this.cert,ca:this.ca,ciphers:this.ciphers,rejectUnauthorized:this.rejectUnauthorized});return n},d.prototype.open=function(){var e;if(this.rememberUpgrade&&d.priorWebsocketSuccess&&-1!=this.transports.indexOf("websocket"))e="websocket";else{if(0==this.transports.length){var t=this;return void setTimeout(function(){t.emit("error","No transports available")},0)}e=this.transports[0]}this.readyState="opening";try{e=this.createTransport(e)}catch(e){return this.transports.shift(),void this.open()}e.open(),this.setTransport(e)},d.prototype.setTransport=function(e){h("setting transport %s",e.name);var t=this;this.transport&&(h("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),(this.transport=e).on("drain",function(){t.onDrain()}).on("packet",function(e){t.onPacket(e)}).on("error",function(e){t.onError(e)}).on("close",function(){t.onClose("transport close")})},d.prototype.probe=function(n){h('probing transport "%s"',n);var i=this.createTransport(n,{probe:1}),r=!1,o=this;function e(){if(o.onlyBinaryUpgrades){var e=!this.supportsBinary&&o.transport.supportsBinary;r=r||e}r||(h('probe transport "%s" opened',n),i.send([{type:"ping",data:"probe"}]),i.once("packet",function(e){if(!r)if("pong"==e.type&&"probe"==e.data){if(h('probe transport "%s" pong',n),o.upgrading=!0,o.emit("upgrading",i),!i)return;d.priorWebsocketSuccess="websocket"==i.name,h('pausing current transport "%s"',o.transport.name),o.transport.pause(function(){r||"closed"!=o.readyState&&(h("changing transport and sending upgrade packet"),u(),o.setTransport(i),i.send([{type:"upgrade"}]),o.emit("upgrade",i),i=null,o.upgrading=!1,o.flush())})}else{h('probe transport "%s" failed',n);var t=new Error("probe error");t.transport=i.name,o.emit("upgradeError",t)}}))}function s(){r||(r=!0,u(),i.close(),i=null)}function t(e){var t=new Error("probe error: "+e);t.transport=i.name,s(),h('probe transport "%s" failed because of error: %s',n,e),o.emit("upgradeError",t)}function a(){t("transport closed")}function c(){t("socket closed")}function l(e){i&&e.name!=i.name&&(h('"%s" works - aborting "%s"',e.name,i.name),s())}function u(){i.removeListener("open",e),i.removeListener("error",t),i.removeListener("close",a),o.removeListener("close",c),o.removeListener("upgrading",l)}d.priorWebsocketSuccess=!1,i.once("open",e),i.once("error",t),i.once("close",a),this.once("close",c),this.once("upgrading",l),i.open()},d.prototype.onOpen=function(){if(h("socket open"),this.readyState="open",d.priorWebsocketSuccess="websocket"==this.transport.name,this.emit("open"),this.flush(),"open"==this.readyState&&this.upgrade&&this.transport.pause){h("starting upgrade probes");for(var e=0,t=this.upgrades.length;e<t;e++)this.probe(this.upgrades[e])}},d.prototype.onPacket=function(e){if("opening"==this.readyState||"open"==this.readyState)switch(h('socket receive: type "%s", data "%s"',e.type,e.data),this.emit("packet",e),this.emit("heartbeat"),e.type){case"open":this.onHandshake(n(e.data));break;case"pong":this.setPing();break;case"error":var t=new Error("server error");t.code=e.data,this.emit("error",t);break;case"message":this.emit("data",e.data),this.emit("message",e.data)}else h('packet received with socket readyState "%s"',this.readyState)},d.prototype.onHandshake=function(e){this.emit("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.onOpen(),"closed"!=this.readyState&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))},d.prototype.onHeartbeat=function(e){clearTimeout(this.pingTimeoutTimer);var t=this;t.pingTimeoutTimer=setTimeout(function(){"closed"!=t.readyState&&t.onClose("ping timeout")},e||t.pingInterval+t.pingTimeout)},d.prototype.setPing=function(){var e=this;clearTimeout(e.pingIntervalTimer),e.pingIntervalTimer=setTimeout(function(){h("writing ping packet - expecting pong within %sms",e.pingTimeout),e.ping(),e.onHeartbeat(e.pingTimeout)},e.pingInterval)},d.prototype.ping=function(){this.sendPacket("ping")},d.prototype.onDrain=function(){for(var e=0;e<this.prevBufferLen;e++)this.callbackBuffer[e]&&this.callbackBuffer[e]();this.writeBuffer.splice(0,this.prevBufferLen),this.callbackBuffer.splice(0,this.prevBufferLen),(this.prevBufferLen=0)==this.writeBuffer.length?this.emit("drain"):this.flush()},d.prototype.flush=function(){"closed"!=this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(h("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))},d.prototype.write=d.prototype.send=function(e,t){return this.sendPacket("message",e,t),this},d.prototype.sendPacket=function(e,t,n){if("closing"!=this.readyState&&"closed"!=this.readyState){var i={type:e,data:t};this.emit("packetCreate",i),this.writeBuffer.push(i),this.callbackBuffer.push(n),this.flush()}},d.prototype.close=function(){if("opening"==this.readyState||"open"==this.readyState){this.readyState="closing";var e=this;function t(){e.onClose("forced close"),h("socket closing - telling transport to close"),e.transport.close()}function n(){e.removeListener("upgrade",n),e.removeListener("upgradeError",n),t()}function i(){e.once("upgrade",n),e.once("upgradeError",n)}this.writeBuffer.length?this.once("drain",function(){this.upgrading?i():t()}):this.upgrading?i():t()}return this},d.prototype.onError=function(e){h("socket error %j",e),d.priorWebsocketSuccess=!1,this.emit("error",e),this.onClose("transport error",e)},d.prototype.onClose=function(e,t){if("opening"==this.readyState||"open"==this.readyState||"closing"==this.readyState){h('socket close with reason: "%s"',e);var n=this;clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),setTimeout(function(){n.writeBuffer=[],n.callbackBuffer=[],n.prevBufferLen=0},0),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",e,t)}},d.prototype.filterUpgrades=function(e){for(var t=[],n=0,i=e.length;n<i;n++)~o(this.transports,e[n])&&t.push(e[n]);return t}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./transport":14,"./transports":15,"component-emitter":9,debug:22,"engine.io-parser":25,indexof:42,parsejson:34,parseqs:35,parseuri:36}],14:[function(e,t,n){var i=e("engine.io-parser"),r=e("component-emitter");function o(e){this.path=e.path,this.hostname=e.hostname,this.port=e.port,this.secure=e.secure,this.query=e.query,this.timestampParam=e.timestampParam,this.timestampRequests=e.timestampRequests,this.readyState="",this.agent=e.agent||!1,this.socket=e.socket,this.enablesXDR=e.enablesXDR,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized}t.exports=o,r(o.prototype),o.timestamps=0,o.prototype.onError=function(e,t){var n=new Error(e);return n.type="TransportError",n.description=t,this.emit("error",n),this},o.prototype.open=function(){return"closed"!=this.readyState&&""!=this.readyState||(this.readyState="opening",this.doOpen()),this},o.prototype.close=function(){return"opening"!=this.readyState&&"open"!=this.readyState||(this.doClose(),this.onClose()),this},o.prototype.send=function(e){if("open"!=this.readyState)throw new Error("Transport not open");this.write(e)},o.prototype.onOpen=function(){this.readyState="open",this.writable=!0,this.emit("open")},o.prototype.onData=function(e){var t=i.decodePacket(e,this.socket.binaryType);this.onPacket(t)},o.prototype.onPacket=function(e){this.emit("packet",e)},o.prototype.onClose=function(){this.readyState="closed",this.emit("close")}},{"component-emitter":9,"engine.io-parser":25}],15:[function(t,e,n){(function(s){var a=t("xmlhttprequest"),c=t("./polling-xhr"),l=t("./polling-jsonp"),e=t("./websocket");n.polling=function(e){var t=!1,n=!1,i=!1!==e.jsonp;if(s.location){var r="https:"==location.protocol,o=location.port;o||(o=r?443:80),t=e.hostname!=location.hostname||o!=e.port,n=e.secure!=r}if(e.xdomain=t,e.xscheme=n,"open"in new a(e)&&!e.forceJSONP)return new c(e);if(!i)throw new Error("JSONP disabled");return new l(e)},n.websocket=e}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./polling-jsonp":16,"./polling-xhr":17,"./websocket":19,xmlhttprequest:20}],16:[function(s,a,e){(function(n){var i=s("./polling"),e=s("component-inherit");a.exports=t;var r,l=/\n/g,u=/\\n/g;function o(){}function t(e){i.call(this,e),this.query=this.query||{},r||(n.___eio||(n.___eio=[]),r=n.___eio),this.index=r.length;var t=this;r.push(function(e){t.onData(e)}),this.query.j=this.index,n.document&&n.addEventListener&&n.addEventListener("beforeunload",function(){t.script&&(t.script.onerror=o)},!1)}e(t,i),t.prototype.supportsBinary=!1,t.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),i.prototype.doClose.call(this)},t.prototype.doPoll=function(){var t=this,e=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),e.async=!0,e.src=this.uri(),e.onerror=function(e){t.onError("jsonp poll error",e)};var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(e,n),this.script=e;var i="undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent);i&&setTimeout(function(){var e=document.createElement("iframe");document.body.appendChild(e),document.body.removeChild(e)},100)},t.prototype.doWrite=function(e,t){var n=this;if(!this.form){var i,r=document.createElement("form"),o=document.createElement("textarea"),s=this.iframeId="eio_iframe_"+this.index;r.className="socketio",r.style.position="absolute",r.style.top="-1000px",r.style.left="-1000px",r.target=s,r.method="POST",r.setAttribute("accept-charset","utf-8"),o.name="d",r.appendChild(o),document.body.appendChild(r),this.form=r,this.area=o}function a(){c(),t()}function c(){if(n.iframe)try{n.form.removeChild(n.iframe)}catch(e){n.onError("jsonp polling iframe removal error",e)}try{var e='<iframe src="javascript:0" name="'+n.iframeId+'">';i=document.createElement(e)}catch(e){(i=document.createElement("iframe")).name=n.iframeId,i.src="javascript:0"}i.id=n.iframeId,n.form.appendChild(i),n.iframe=i}this.form.action=this.uri(),c(),e=e.replace(u,"\\\n"),this.area.value=e.replace(l,"\\n");try{this.form.submit()}catch(e){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"==n.iframe.readyState&&a()}:this.iframe.onload=a}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./polling":18,"component-inherit":21}],17:[function(u,h,e){(function(i){var r=u("xmlhttprequest"),o=u("./polling"),e=u("component-emitter"),t=u("component-inherit"),s=u("debug")("engine.io-client:polling-xhr");function n(){}function a(e){if(o.call(this,e),i.location){var t="https:"==location.protocol,n=location.port;n||(n=t?443:80),this.xd=e.hostname!=i.location.hostname||n!=e.port,this.xs=e.secure!=t}}function c(e){this.method=e.method||"GET",this.uri=e.uri,this.xd=!!e.xd,this.xs=!!e.xs,this.async=!1!==e.async,this.data=null!=e.data?e.data:null,this.agent=e.agent,this.isBinary=e.isBinary,this.supportsBinary=e.supportsBinary,this.enablesXDR=e.enablesXDR,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized,this.create()}function l(){for(var e in c.requests)c.requests.hasOwnProperty(e)&&c.requests[e].abort()}h.exports=a,h.exports.Request=c,t(a,o),a.prototype.supportsBinary=!0,a.prototype.request=function(e){return(e=e||{}).uri=this.uri(),e.xd=this.xd,e.xs=this.xs,e.agent=this.agent||!1,e.supportsBinary=this.supportsBinary,e.enablesXDR=this.enablesXDR,e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized,new c(e)},a.prototype.doWrite=function(e,t){var n="string"!=typeof e&&void 0!==e,i=this.request({method:"POST",data:e,isBinary:n}),r=this;i.on("success",t),i.on("error",function(e){r.onError("xhr post error",e)}),this.sendXhr=i},a.prototype.doPoll=function(){s("xhr poll");var e=this.request(),t=this;e.on("data",function(e){t.onData(e)}),e.on("error",function(e){t.onError("xhr poll error",e)}),this.pollXhr=e},e(c.prototype),c.prototype.create=function(){var e={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized;var t=this.xhr=new r(e),n=this;try{if(s("xhr open %s: %s",this.method,this.uri),t.open(this.method,this.uri,this.async),this.supportsBinary&&(t.responseType="arraybuffer"),"POST"==this.method)try{this.isBinary?t.setRequestHeader("Content-type","application/octet-stream"):t.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(e){}"withCredentials"in t&&(t.withCredentials=!0),this.hasXDR()?(t.onload=function(){n.onLoad()},t.onerror=function(){n.onError(t.responseText)}):t.onreadystatechange=function(){4==t.readyState&&(200==t.status||1223==t.status?n.onLoad():setTimeout(function(){n.onError(t.status)},0))},s("xhr data %s",this.data),t.send(this.data)}catch(e){return void setTimeout(function(){n.onError(e)},0)}i.document&&(this.index=c.requestsCount++,c.requests[this.index]=this)},c.prototype.onSuccess=function(){this.emit("success"),this.cleanup()},c.prototype.onData=function(e){this.emit("data",e),this.onSuccess()},c.prototype.onError=function(e){this.emit("error",e),this.cleanup(!0)},c.prototype.cleanup=function(e){if(void 0!==this.xhr&&null!==this.xhr){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=n:this.xhr.onreadystatechange=n,e)try{this.xhr.abort()}catch(e){}i.document&&delete c.requests[this.index],this.xhr=null}},c.prototype.onLoad=function(){var e;try{var t;try{t=this.xhr.getResponseHeader("Content-Type").split(";")[0]}catch(e){}e="application/octet-stream"===t?this.xhr.response:this.supportsBinary?"ok":this.xhr.responseText}catch(e){this.onError(e)}null!=e&&this.onData(e)},c.prototype.hasXDR=function(){return void 0!==i.XDomainRequest&&!this.xs&&this.enablesXDR},c.prototype.abort=function(){this.cleanup()},i.document&&(c.requestsCount=0,c.requests={},i.attachEvent?i.attachEvent("onunload",l):i.addEventListener&&i.addEventListener("beforeunload",l,!1))}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./polling":18,"component-emitter":9,"component-inherit":21,debug:22,xmlhttprequest:20}],18:[function(e,t,n){var i=e("../transport"),r=e("parseqs"),o=e("engine.io-parser"),s=e("component-inherit"),a=e("debug")("engine.io-client:polling");t.exports=l;var c=null!=new(e("xmlhttprequest"))({xdomain:!1}).responseType;function l(e){var t=e&&e.forceBase64;c&&!t||(this.supportsBinary=!1),i.call(this,e)}s(l,i),l.prototype.name="polling",l.prototype.doOpen=function(){this.poll()},l.prototype.pause=function(e){var t=this;function n(){a("paused"),t.readyState="paused",e()}if(this.readyState="pausing",this.polling||!this.writable){var i=0;this.polling&&(a("we are currently polling - waiting to pause"),i++,this.once("pollComplete",function(){a("pre-pause polling complete"),--i||n()})),this.writable||(a("we are currently writing - waiting to pause"),i++,this.once("drain",function(){a("pre-pause writing complete"),--i||n()}))}else n()},l.prototype.poll=function(){a("polling"),this.polling=!0,this.doPoll(),this.emit("poll")},l.prototype.onData=function(e){var i=this;a("polling got data %s",e),o.decodePayload(e,this.socket.binaryType,function(e,t,n){if("opening"==i.readyState&&i.onOpen(),"close"==e.type)return i.onClose(),!1;i.onPacket(e)}),"closed"!=this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"==this.readyState?this.poll():a('ignoring poll - transport state "%s"',this.readyState))},l.prototype.doClose=function(){var e=this;function t(){a("writing close packet"),e.write([{type:"close"}])}"open"==this.readyState?(a("transport open - closing"),t()):(a("transport not open - deferring close"),this.once("open",t))},l.prototype.write=function(e){var t=this;this.writable=!1;var n=function(){t.writable=!0,t.emit("drain")},t=this;o.encodePayload(e,this.supportsBinary,function(e){t.doWrite(e,n)})},l.prototype.uri=function(){var e=this.query||{},t=this.secure?"https":"http",n="";return!1!==this.timestampRequests&&(e[this.timestampParam]=+new Date+"-"+i.timestamps++),this.supportsBinary||e.sid||(e.b64=1),e=r.encode(e),this.port&&("https"==t&&443!=this.port||"http"==t&&80!=this.port)&&(n=":"+this.port),e.length&&(e="?"+e),t+"://"+this.hostname+n+this.path+e}},{"../transport":14,"component-inherit":21,debug:22,"engine.io-parser":25,parseqs:35,xmlhttprequest:20}],19:[function(e,t,n){var i=e("../transport"),r=e("engine.io-parser"),o=e("parseqs"),s=e("component-inherit"),a=e("debug")("engine.io-client:websocket"),c=e("ws");function l(e){var t=e&&e.forceBase64;t&&(this.supportsBinary=!1),i.call(this,e)}t.exports=l,s(l,i),l.prototype.name="websocket",l.prototype.supportsBinary=!0,l.prototype.doOpen=function(){if(this.check()){var e=this.uri(),t={agent:this.agent};t.pfx=this.pfx,t.key=this.key,t.passphrase=this.passphrase,t.cert=this.cert,t.ca=this.ca,t.ciphers=this.ciphers,t.rejectUnauthorized=this.rejectUnauthorized,this.ws=new c(e,void 0,t),void 0===this.ws.binaryType&&(this.supportsBinary=!1),this.ws.binaryType="arraybuffer",this.addEventListeners()}},l.prototype.addEventListeners=function(){var t=this;this.ws.onopen=function(){t.onOpen()},this.ws.onclose=function(){t.onClose()},this.ws.onmessage=function(e){t.onData(e.data)},this.ws.onerror=function(e){t.onError("websocket error",e)}},"undefined"!=typeof navigator&&/iPad|iPhone|iPod/i.test(navigator.userAgent)&&(l.prototype.onData=function(e){var t=this;setTimeout(function(){i.prototype.onData.call(t,e)},0)}),l.prototype.write=function(e){var t=this;this.writable=!1;for(var n=0,i=e.length;n<i;n++)r.encodePacket(e[n],this.supportsBinary,function(e){try{t.ws.send(e)}catch(e){a("websocket closed before onclose event")}});setTimeout(function(){t.writable=!0,t.emit("drain")},0)},l.prototype.onClose=function(){i.prototype.onClose.call(this)},l.prototype.doClose=function(){void 0!==this.ws&&this.ws.close()},l.prototype.uri=function(){var e=this.query||{},t=this.secure?"wss":"ws",n="";return this.port&&("wss"==t&&443!=this.port||"ws"==t&&80!=this.port)&&(n=":"+this.port),this.timestampRequests&&(e[this.timestampParam]=+new Date),this.supportsBinary||(e.b64=1),(e=o.encode(e)).length&&(e="?"+e),t+"://"+this.hostname+n+this.path+e},l.prototype.check=function(){return!(!c||"__initialize"in c&&this.name===l.prototype.name)}},{"../transport":14,"component-inherit":21,debug:22,"engine.io-parser":25,parseqs:35,ws:37}],20:[function(e,t,n){var r=e("has-cors");t.exports=function(e){var t=e.xdomain,n=e.xscheme,i=e.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!t||r))return new XMLHttpRequest}catch(e){}try{if("undefined"!=typeof XDomainRequest&&!n&&i)return new XDomainRequest}catch(e){}if(!t)try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(e){}}},{"has-cors":40}],21:[function(e,t,n){t.exports=function(e,t){var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},{}],22:[function(e,t,o){function n(){var e;try{e=localStorage.debug}catch(e){}return e}(o=t.exports=e("./debug")).log=function(){return"object"==typeof console&&"function"==typeof console.log&&Function.prototype.apply.call(console.log,console,arguments)},o.formatArgs=function(){var e=arguments,t=this.useColors;if(e[0]=(t?"%c":"")+this.namespace+(t?" %c":" ")+e[0]+(t?"%c ":" ")+"+"+o.humanize(this.diff),!t)return e;var n="color: "+this.color;e=[e[0],n,"color: inherit"].concat(Array.prototype.slice.call(e,1));var i=0,r=0;return e[0].replace(/%[a-z%]/g,function(e){"%"!==e&&(i++,"%c"===e&&(r=i))}),e.splice(r,0,n),e},o.save=function(e){try{null==e?localStorage.removeItem("debug"):localStorage.debug=e}catch(e){}},o.load=n,o.useColors=function(){return"WebkitAppearance"in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&31<=parseInt(RegExp.$1,10)},o.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],o.formatters.j=function(e){return JSON.stringify(e)},o.enable(n())},{"./debug":23}],23:[function(e,t,a){(a=t.exports=function(e){function t(){}function i(){var r=i,e=+new Date,t=e-(c||e);r.diff=t,r.prev=c,r.curr=e,c=e,null==r.useColors&&(r.useColors=a.useColors()),null==r.color&&r.useColors&&(r.color=a.colors[l++%a.colors.length]);var o=Array.prototype.slice.call(arguments);o[0]=a.coerce(o[0]),"string"!=typeof o[0]&&(o=["%o"].concat(o));var s=0;o[0]=o[0].replace(/%([a-z%])/g,function(e,t){if("%"===e)return e;s++;var n=a.formatters[t];if("function"==typeof n){var i=o[s];e=n.call(r,i),o.splice(s,1),s--}return e}),"function"==typeof a.formatArgs&&(o=a.formatArgs.apply(r,o));var n=i.log||a.log||console.log.bind(console);n.apply(r,o)}i.enabled=!(t.enabled=!1);var n=a.enabled(e)?i:t;return n.namespace=e,n}).coerce=function(e){return e instanceof Error?e.stack||e.message:e},a.disable=function(){a.enable("")},a.enable=function(e){a.save(e);for(var t=(e||"").split(/[\s,]+/),n=t.length,i=0;i<n;i++)t[i]&&("-"===(e=t[i].replace(/\*/g,".*?"))[0]?a.skips.push(new RegExp("^"+e.substr(1)+"$")):a.names.push(new RegExp("^"+e+"$")))},a.enabled=function(e){var t,n;for(t=0,n=a.skips.length;t<n;t++)if(a.skips[t].test(e))return!1;for(t=0,n=a.names.length;t<n;t++)if(a.names[t].test(e))return!0;return!1},a.humanize=e("ms"),a.names=[],a.skips=[],a.formatters={};var c,l=0},{ms:24}],24:[function(e,t,n){var r=36e5,o=864e5;function s(e,t,n){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+n:Math.ceil(e/t)+" "+n+"s"}t.exports=function(e,t){return t=t||{},"string"==typeof e?function(e){var t=/^((?:\d+)?\.?\d+) *(ms|seconds?|s|minutes?|m|hours?|h|days?|d|years?|y)?$/i.exec(e);if(t){var n=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"y":return 315576e5*n;case"days":case"day":case"d":return n*o;case"hours":case"hour":case"h":return n*r;case"minutes":case"minute":case"m":return 6e4*n;case"seconds":case"second":case"s":return 1e3*n;case"ms":return n}}}(e):t.long?s(i=e,o,"day")||s(i,r,"hour")||s(i,6e4,"minute")||s(i,1e3,"second")||i+" ms":o<=(n=e)?Math.round(n/o)+"d":r<=n?Math.round(n/r)+"h":6e4<=n?Math.round(n/6e4)+"m":1e3<=n?Math.round(n/1e3)+"s":n+"ms";var n,i}},{}],25:[function(i,e,m){(function(l){var e=i("./keys"),r=i("has-binary"),p=i("arraybuffer.slice"),o=i("base64-arraybuffer"),a=i("after"),u=i("utf8"),t=navigator.userAgent.match(/Android/i),n=/PhantomJS/i.test(navigator.userAgent),h=t||n;m.protocol=3;var d=m.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},s=e(d),f={type:"error",data:"parser error"},g=i("blob");function c(e,t,n){for(var r=new Array(e.length),i=a(e.length,n),o=function(n,e,i){t(e,function(e,t){r[n]=t,i(e,r)})},s=0;s<e.length;s++)o(s,e[s],i)}m.encodePacket=function(e,t,n,i){"function"==typeof t&&(i=t,t=!1),"function"==typeof n&&(i=n,n=null);var r,o,s,a=void 0===e.data?void 0:e.data.buffer||e.data;if(l.ArrayBuffer&&a instanceof ArrayBuffer)return function(e,t,n){if(!t)return m.encodeBase64Packet(e,n);var i=e.data,r=new Uint8Array(i),o=new Uint8Array(1+i.byteLength);o[0]=d[e.type];for(var s=0;s<r.length;s++)o[s+1]=r[s];return n(o.buffer)}(e,t,i);if(g&&a instanceof l.Blob)return function(e,t,n){if(!t)return m.encodeBase64Packet(e,n);if(h)return function(e,t,n){if(!t)return m.encodeBase64Packet(e,n);var i=new FileReader;return i.onload=function(){e.data=i.result,m.encodePacket(e,t,!0,n)},i.readAsArrayBuffer(e.data)}(e,t,n);var i=new Uint8Array(1);i[0]=d[e.type];var r=new g([i.buffer,e.data]);return n(r)}(e,t,i);if(a&&a.base64)return r=e,o=i,s="b"+m.packets[r.type]+r.data.data,o(s);var c=d[e.type];return void 0!==e.data&&(c+=n?u.encode(String(e.data)):String(e.data)),i(""+c)},m.encodeBase64Packet=function(t,n){var i,r="b"+m.packets[t.type];if(g&&t.data instanceof g){var o=new FileReader;return o.onload=function(){var e=o.result.split(",")[1];n(r+e)},o.readAsDataURL(t.data)}try{i=String.fromCharCode.apply(null,new Uint8Array(t.data))}catch(e){for(var s=new Uint8Array(t.data),a=new Array(s.length),c=0;c<s.length;c++)a[c]=s[c];i=String.fromCharCode.apply(null,a)}return r+=l.btoa(i),n(r)},m.decodePacket=function(e,t,n){if("string"==typeof e||void 0===e){if("b"==e.charAt(0))return m.decodeBase64Packet(e.substr(1),t);if(n)try{e=u.decode(e)}catch(e){return f}var i=e.charAt(0);return Number(i)==i&&s[i]?1<e.length?{type:s[i],data:e.substring(1)}:{type:s[i]}:f}var r=new Uint8Array(e),i=r[0],o=p(e,1);return g&&"blob"===t&&(o=new g([o])),{type:s[i],data:o}},m.decodeBase64Packet=function(e,t){var n=s[e.charAt(0)];if(!l.ArrayBuffer)return{type:n,data:{base64:!0,data:e.substr(1)}};var i=o.decode(e.substr(1));return"blob"===t&&g&&(i=new g([i])),{type:n,data:i}},m.encodePayload=function(e,t,n){"function"==typeof t&&(n=t,t=null);var i=r(e);return t&&i?g&&!h?m.encodePayloadAsBlob(e,n):m.encodePayloadAsArrayBuffer(e,n):e.length?void c(e,function(e,n){m.encodePacket(e,!!i&&t,!0,function(e){var t;n(null,(t=e).length+":"+t)})},function(e,t){return n(t.join(""))}):n("0:")},m.decodePayload=function(e,t,n){if("string"!=typeof e)return m.decodePayloadAsBinary(e,t,n);var i;if("function"==typeof t&&(n=t,t=null),""==e)return n(f,0,1);for(var r,o,s="",a=0,c=e.length;a<c;a++){var l=e.charAt(a);if(":"!=l)s+=l;else{if(""==s||s!=(r=Number(s)))return n(f,0,1);if(o=e.substr(a+1,r),s!=o.length)return n(f,0,1);if(o.length){if(i=m.decodePacket(o,t,!0),f.type==i.type&&f.data==i.data)return n(f,0,1);var u=n(i,a+r,c);if(!1===u)return}a+=r,s=""}}return""!=s?n(f,0,1):void 0},m.encodePayloadAsArrayBuffer=function(e,i){if(!e.length)return i(new ArrayBuffer(0));c(e,function(e,t){m.encodePacket(e,!0,!0,function(e){return t(null,e)})},function(e,t){var n=t.nativeReduce(function(e,t){var n;return n="string"==typeof t?t.length:t.byteLength,e+n.toString().length+n+2},0),s=new Uint8Array(n),a=0;return t.forEach(function(e){var t="string"==typeof e,n=e;if(t){for(var i=new Uint8Array(e.length),r=0;r<e.length;r++)i[r]=e.charCodeAt(r);n=i.buffer}s[a++]=t?0:1;for(var o=n.byteLength.toString(),r=0;r<o.length;r++)s[a++]=parseInt(o[r]);s[a++]=255;for(var i=new Uint8Array(n),r=0;r<i.length;r++)s[a++]=i[r]}),i(s.buffer)})},m.encodePayloadAsBlob=function(e,n){c(e,function(e,c){m.encodePacket(e,!0,!0,function(e){var t=new Uint8Array(1);if(t[0]=1,"string"==typeof e){for(var n=new Uint8Array(e.length),i=0;i<e.length;i++)n[i]=e.charCodeAt(i);e=n.buffer,t[0]=0}for(var r=e instanceof ArrayBuffer?e.byteLength:e.size,o=r.toString(),s=new Uint8Array(o.length+1),i=0;i<o.length;i++)s[i]=parseInt(o[i]);if(s[o.length]=255,g){var a=new g([t.buffer,s.buffer,e]);c(null,a)}})},function(e,t){return n(new g(t))})},m.decodePayloadAsBinary=function(e,n,i){"function"==typeof n&&(i=n,n=null);for(var t=e,r=[],o=!1;0<t.byteLength;){for(var s=new Uint8Array(t),a=0===s[0],c="",l=1;255!=s[l];l++){if(310<c.length){o=!0;break}c+=s[l]}if(o)return i(f,0,1);t=p(t,2+c.length),c=parseInt(c);var u=p(t,0,c);if(a)try{u=String.fromCharCode.apply(null,new Uint8Array(u))}catch(e){var h=new Uint8Array(u);u="";for(var l=0;l<h.length;l++)u+=String.fromCharCode(h[l])}r.push(u),t=p(t,c)}var d=r.length;r.forEach(function(e,t){i(m.decodePacket(e,n,!0),t,d)})}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./keys":26,after:27,"arraybuffer.slice":28,"base64-arraybuffer":29,blob:30,"has-binary":31,utf8:33}],26:[function(e,t,n){t.exports=Object.keys||function(e){var t=[],n=Object.prototype.hasOwnProperty;for(var i in e)n.call(e,i)&&t.push(i);return t}},{}],27:[function(e,t,n){function s(){}t.exports=function(e,n,i){var r=!1;return i=i||s,0===(o.count=e)?n():o;function o(e,t){if(o.count<=0)throw new Error("after called too many times");--o.count,e?(r=!0,n(e),n=i):0!==o.count||r||n(null,t)}}},{}],28:[function(e,t,n){t.exports=function(e,t,n){var i=e.byteLength;if(t=t||0,n=n||i,e.slice)return e.slice(t,n);if(t<0&&(t+=i),n<0&&(n+=i),i<n&&(n=i),i<=t||n<=t||0===i)return new ArrayBuffer(0);for(var r=new Uint8Array(e),o=new Uint8Array(n-t),s=t,a=0;s<n;s++,a++)o[a]=r[s];return o.buffer}},{}],29:[function(e,t,n){!function(h){"use strict";n.encode=function(e){var t,n=new Uint8Array(e),i=n.length,r="";for(t=0;t<i;t+=3)r+=h[n[t]>>2],r+=h[(3&n[t])<<4|n[t+1]>>4],r+=h[(15&n[t+1])<<2|n[t+2]>>6],r+=h[63&n[t+2]];return i%3==2?r=r.substring(0,r.length-1)+"=":i%3==1&&(r=r.substring(0,r.length-2)+"=="),r},n.decode=function(e){var t,n,i,r,o,s=.75*e.length,a=e.length,c=0;"="===e[e.length-1]&&(s--,"="===e[e.length-2]&&s--);var l=new ArrayBuffer(s),u=new Uint8Array(l);for(t=0;t<a;t+=4)n=h.indexOf(e[t]),i=h.indexOf(e[t+1]),r=h.indexOf(e[t+2]),o=h.indexOf(e[t+3]),u[c++]=n<<2|i>>4,u[c++]=(15&i)<<4|r>>2,u[c++]=(3&r)<<6|63&o;return l}}("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/")},{}],30:[function(e,o,t){(function(e){var r=e.BlobBuilder||e.WebKitBlobBuilder||e.MSBlobBuilder||e.MozBlobBuilder,t=function(){try{var e=new Blob(["hi"]);return 2==e.size}catch(e){return!1}}(),n=r&&r.prototype.append&&r.prototype.getBlob;function i(e,t){t=t||{};for(var n=new r,i=0;i<e.length;i++)n.append(e[i]);return t.type?n.getBlob(t.type):n.getBlob()}o.exports=t?e.Blob:n?i:void 0}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],31:[function(e,t,n){(function(r){var o=e("isarray");t.exports=function(e){return function e(t){if(!t)return!1;if(r.Buffer&&r.Buffer.isBuffer(t)||r.ArrayBuffer&&t instanceof ArrayBuffer||r.Blob&&t instanceof Blob||r.File&&t instanceof File)return!0;if(o(t)){for(var n=0;n<t.length;n++)if(e(t[n]))return!0}else if(t&&"object"==typeof t)for(var i in t.toJSON&&(t=t.toJSON()),t)if(t.hasOwnProperty(i)&&e(t[i]))return!0;return!1}(e)}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{isarray:32}],32:[function(e,t,n){t.exports=Array.isArray||function(e){return"[object Array]"==Object.prototype.toString.call(e)}},{}],33:[function(e,y,b){(function(v){!function(e){var t="object"==typeof b&&b,n="object"==typeof y&&y&&y.exports==t&&y,i="object"==typeof v&&v;i.global!==i&&i.window!==i||(e=i);var o,s,a,c=String.fromCharCode;function l(e){for(var t,n,i=[],r=0,o=e.length;r<o;)55296<=(t=e.charCodeAt(r++))&&t<=56319&&r<o?56320==(64512&(n=e.charCodeAt(r++)))?i.push(((1023&t)<<10)+(1023&n)+65536):(i.push(t),r--):i.push(t);return i}function r(e){for(var t,n=e.length,i=-1,r="";++i<n;)65535<(t=e[i])&&(r+=c((t-=65536)>>>10&1023|55296),t=56320|1023&t),r+=c(t);return r}function u(e,t){return c(e>>t&63|128)}function h(e){if(0==(4294967168&e))return c(e);var t="";return 0==(4294965248&e)?t=c(e>>6&31|192):0==(4294901760&e)?(t=c(e>>12&15|224),t+=u(e,6)):0==(4292870144&e)&&(t=c(e>>18&7|240),t+=u(e,12),t+=u(e,6)),t+=c(63&e|128)}function d(){if(s<=a)throw Error("Invalid byte index");var e=255&o[a];if(a++,128==(192&e))return 63&e;throw Error("Invalid continuation byte")}function p(){var e,t,n,i;if(s<a)throw Error("Invalid byte index");if(a==s)return!1;if(e=255&o[a],a++,0==(128&e))return e;if(192==(224&e)){var r=d();if(128<=(i=(31&e)<<6|r))return i;throw Error("Invalid continuation byte")}if(224==(240&e)){if(r=d(),t=d(),2048<=(i=(15&e)<<12|r<<6|t))return i;throw Error("Invalid continuation byte")}if(240==(248&e)&&(r=d(),t=d(),n=d(),65536<=(i=(15&e)<<18|r<<12|t<<6|n)&&i<=1114111))return i;throw Error("Invalid UTF-8 detected")}var f={version:"2.0.0",encode:function(e){for(var t,n=l(e),i=n.length,r=-1,o="";++r<i;)t=n[r],o+=h(t);return o},decode:function(e){o=l(e),s=o.length,a=0;for(var t,n=[];!1!==(t=p());)n.push(t);return r(n)}};if(t&&!t.nodeType)if(n)n.exports=f;else{var g={}.hasOwnProperty;for(var m in f)g.call(f,m)&&(t[m]=f[m])}else e.utf8=f}(this)}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],34:[function(e,c,t){(function(t){var n=/^[\],:{}\s]*$/,i=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,r=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,o=/(?:^|:|,)(?:\s*\[)+/g,s=/^\s+/,a=/\s+$/;c.exports=function(e){return"string"==typeof e&&e?(e=e.replace(s,"").replace(a,""),t.JSON&&JSON.parse?JSON.parse(e):n.test(e.replace(i,"@").replace(r,"]").replace(o,""))?new Function("return "+e)():void 0):null}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],35:[function(e,t,n){n.encode=function(e){var t="";for(var n in e)e.hasOwnProperty(n)&&(t.length&&(t+="&"),t+=encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t},n.decode=function(e){for(var t={},n=e.split("&"),i=0,r=n.length;i<r;i++){var o=n[i].split("=");t[decodeURIComponent(o[0])]=decodeURIComponent(o[1])}return t}},{}],36:[function(e,t,n){var a=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,c=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];t.exports=function(e){var t=e,n=e.indexOf("["),i=e.indexOf("]");-1!=n&&-1!=i&&(e=e.substring(0,n)+e.substring(n,i).replace(/:/g,";")+e.substring(i,e.length));for(var r=a.exec(e||""),o={},s=14;s--;)o[c[s]]=r[s]||"";return-1!=n&&-1!=i&&(o.source=t,o.host=o.host.substring(1,o.host.length-1).replace(/;/g,":"),o.authority=o.authority.replace("[","").replace("]","").replace(/;/g,":"),o.ipv6uri=!0),o}},{}],37:[function(e,t,n){var i=function(){return this}(),r=i.WebSocket||i.MozWebSocket;function o(e,t,n){return t?new r(e,t):new r(e)}t.exports=r?o:null,r&&(o.prototype=r.prototype)},{}],38:[function(e,t,n){(function(r){var o=e("isarray");t.exports=function(e){return function e(t){if(!t)return!1;if(r.Buffer&&r.Buffer.isBuffer(t)||r.ArrayBuffer&&t instanceof ArrayBuffer||r.Blob&&t instanceof Blob||r.File&&t instanceof File)return!0;if(o(t)){for(var n=0;n<t.length;n++)if(e(t[n]))return!0}else if(t&&"object"==typeof t)for(var i in t.toJSON&&(t=t.toJSON()),t)if(Object.prototype.hasOwnProperty.call(t,i)&&e(t[i]))return!0;return!1}(e)}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{isarray:39}],39:[function(e,t,n){t.exports=e(32)},{}],40:[function(e,t,n){var i=e("global");try{t.exports="XMLHttpRequest"in i&&"withCredentials"in new i.XMLHttpRequest}catch(e){t.exports=!1}},{global:41}],41:[function(e,t,n){t.exports=function(){return this}()},{}],42:[function(e,t,n){var i=[].indexOf;t.exports=function(e,t){if(i)return e.indexOf(t);for(var n=0;n<e.length;++n)if(e[n]===t)return n;return-1}},{}],43:[function(e,t,n){var i=Object.prototype.hasOwnProperty;n.keys=Object.keys||function(e){var t=[];for(var n in e)i.call(e,n)&&t.push(n);return t},n.values=function(e){var t=[];for(var n in e)i.call(e,n)&&t.push(e[n]);return t},n.merge=function(e,t){for(var n in t)i.call(t,n)&&(e[n]=t[n]);return e},n.length=function(e){return n.keys(e).length},n.isEmpty=function(e){return 0==n.length(e)}},{}],44:[function(e,t,n){var r=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,o=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];t.exports=function(e){for(var t=r.exec(e||""),n={},i=14;i--;)n[o[i]]=t[i]||"";return n}},{}],45:[function(e,t,n){(function(u){var h=e("isarray"),d=e("./is-buffer");n.deconstructPacket=function(e){var s=[],t=e.data,n=e;return n.data=function e(t){if(!t)return t;if(d(t)){var n={_placeholder:!0,num:s.length};return s.push(t),n}if(h(t)){for(var i=new Array(t.length),r=0;r<t.length;r++)i[r]=e(t[r]);return i}if("object"!=typeof t||t instanceof Date)return t;var i={};for(var o in t)i[o]=e(t[o]);return i}(t),n.attachments=s.length,{packet:n,buffers:s}},n.reconstructPacket=function(e,o){return e.data=function e(t){if(t&&t._placeholder){var n=o[t.num];return n}if(h(t)){for(var i=0;i<t.length;i++)t[i]=e(t[i]);return t}if(t&&"object"==typeof t){for(var r in t)t[r]=e(t[r]);return t}return t}(e.data),e.attachments=void 0,e},n.removeBlobs=function(e,a){var c=0,l=e;!function e(t,n,i){if(!t)return t;if(u.Blob&&t instanceof Blob||u.File&&t instanceof File){c++;var r=new FileReader;r.onload=function(){i?i[n]=this.result:l=this.result,--c||a(l)},r.readAsArrayBuffer(t)}else if(h(t))for(var o=0;o<t.length;o++)e(t[o],o,t);else if(t&&"object"==typeof t&&!d(t))for(var s in t)e(t[s],s,t)}(l),c||a(l)}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./is-buffer":47,isarray:48}],46:[function(e,t,s){var a=e("debug")("socket.io-parser"),c=e("json3"),n=(e("isarray"),e("component-emitter")),o=e("./binary"),i=e("./is-buffer");function r(){}function l(e){var t="",n=!1;return t+=e.type,s.BINARY_EVENT!=e.type&&s.BINARY_ACK!=e.type||(t+=e.attachments,t+="-"),e.nsp&&"/"!=e.nsp&&(n=!0,t+=e.nsp),null!=e.id&&(n&&(t+=",",n=!1),t+=e.id),null!=e.data&&(n&&(t+=","),t+=c.stringify(e.data)),a("encoded %j as %s",e,t),t}function u(){this.reconstructor=null}function h(e){this.reconPack=e,this.buffers=[]}function d(e){return{type:s.ERROR,data:"parser error"}}s.protocol=4,s.types=["CONNECT","DISCONNECT","EVENT","BINARY_EVENT","ACK","BINARY_ACK","ERROR"],s.CONNECT=0,s.DISCONNECT=1,s.EVENT=2,s.ACK=3,s.ERROR=4,s.BINARY_EVENT=5,s.BINARY_ACK=6,s.Encoder=r,s.Decoder=u,r.prototype.encode=function(e,t){if(a("encoding packet %j",e),s.BINARY_EVENT==e.type||s.BINARY_ACK==e.type)i=e,r=t,o.removeBlobs(i,function(e){var t=o.deconstructPacket(e),n=l(t.packet),i=t.buffers;i.unshift(n),r(i)});else{var n=l(e);t([n])}var i,r},n(u.prototype),u.prototype.add=function(e){var t;if("string"==typeof e)t=function(e){var t={},n=0;if(t.type=Number(e.charAt(0)),null==s.types[t.type])return d();if(s.BINARY_EVENT==t.type||s.BINARY_ACK==t.type){for(var i="";"-"!=e.charAt(++n)&&(i+=e.charAt(n),n!=e.length););if(i!=Number(i)||"-"!=e.charAt(n))throw new Error("Illegal attachments");t.attachments=Number(i)}if("/"==e.charAt(n+1))for(t.nsp="";++n;){var r=e.charAt(n);if(","==r)break;if(t.nsp+=r,n==e.length)break}else t.nsp="/";var o=e.charAt(n+1);if(""!==o&&Number(o)==o){for(t.id="";++n;){var r=e.charAt(n);if(null==r||Number(r)!=r){--n;break}if(t.id+=e.charAt(n),n==e.length)break}t.id=Number(t.id)}if(e.charAt(++n))try{t.data=c.parse(e.substr(n))}catch(e){return d()}return a("decoded %s as %j",e,t),t}(e),s.BINARY_EVENT==t.type||s.BINARY_ACK==t.type?(this.reconstructor=new h(t),0===this.reconstructor.reconPack.attachments&&this.emit("decoded",t)):this.emit("decoded",t);else{if(!i(e)&&!e.base64)throw new Error("Unknown type: "+e);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");(t=this.reconstructor.takeBinaryData(e))&&(this.reconstructor=null,this.emit("decoded",t))}},u.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()},h.prototype.takeBinaryData=function(e){if(this.buffers.push(e),this.buffers.length!=this.reconPack.attachments)return null;var t=o.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),t},h.prototype.finishedReconstruction=function(){this.reconPack=null,this.buffers=[]}},{"./binary":45,"./is-buffer":47,"component-emitter":9,debug:10,isarray:48,json3:49}],47:[function(e,n,t){(function(t){n.exports=function(e){return t.Buffer&&t.Buffer.isBuffer(e)||t.ArrayBuffer&&e instanceof ArrayBuffer}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],48:[function(e,t,n){t.exports=e(32)},{}],49:[function(e,t,w){!function(e){var k,T,S,x={}.toString,t=!1,n="object"==typeof JSON&&JSON,c="object"==typeof w&&w&&!w.nodeType&&w;c&&n?(c.stringify=n.stringify,c.parse=n.parse):c=e.JSON=n||{};var l=new Date(-0xc782b5b800cec);try{l=-109252==l.getUTCFullYear()&&0===l.getUTCMonth()&&1===l.getUTCDate()&&10==l.getUTCHours()&&37==l.getUTCMinutes()&&6==l.getUTCSeconds()&&708==l.getUTCMilliseconds()}catch(e){}function u(e){if(u[e]!==S)return u[e];var t;if("bug-string-char-index"==e)t="a"!="a"[0];else if("json"==e)t=u("json-stringify")&&u("json-parse");else{var n,i='{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}';if("json-stringify"==e){var r=c.stringify,o="function"==typeof r&&l;if(o){(n=function(){return 1}).toJSON=n;try{o="0"===r(0)&&"0"===r(new Number)&&'""'==r(new String)&&r(x)===S&&r(S)===S&&r()===S&&"1"===r(n)&&"[1]"==r([n])&&"[null]"==r([S])&&"null"==r(null)&&"[null,null,null]"==r([S,x,null])&&r({a:[n,!0,!1,null,"\0\b\n\f\r "]})==i&&"1"===r(null,n)&&"[\n 1,\n 2\n]"==r([1,2],null,1)&&'"-271821-04-20T00:00:00.000Z"'==r(new Date(-864e13))&&'"+275760-09-13T00:00:00.000Z"'==r(new Date(864e13))&&'"-000001-01-01T00:00:00.000Z"'==r(new Date(-621987552e5))&&'"1969-12-31T23:59:59.999Z"'==r(new Date(-1))}catch(e){o=!1}}t=o}if("json-parse"==e){var s=c.parse;if("function"==typeof s)try{if(0===s("0")&&!s(!1)){var a=5==(n=s(i)).a.length&&1===n.a[0];if(a){try{a=!s('" "')}catch(e){}if(a)try{a=1!==s("01")}catch(e){}if(a)try{a=1!==s("1.")}catch(e){}}}}catch(e){a=!1}t=a}}return u[e]=!!t}if(!u("json")){var h="[object Function]",E="[object Number]",N="[object String]",P="[object Array]",a=u("bug-string-char-index");if(!l)var A=Math.floor,i=[0,31,59,90,120,151,181,212,243,273,304,334],O=function(e,t){return i[t]+365*(e-1970)+A((e-1969+(t=+(1<t)))/4)-A((e-1901+t)/100)+A((e-1601+t)/400)};(k={}.hasOwnProperty)||(k=function(e){var n,t={};return k=(t.__proto__=null,t.__proto__={toString:1},t).toString!=x?function(e){var t=this.__proto__,n=e in(this.__proto__=null,this);return this.__proto__=t,n}:(n=t.constructor,function(e){var t=(this.constructor||n).prototype;return e in this&&!(e in t&&this[e]===t[e])}),t=null,k.call(this,e)});var d={boolean:1,number:1,string:1,undefined:1};if(T=function(e,t){var n,l,i,r=0;for(i in(n=function(){this.valueOf=0}).prototype.valueOf=0,l=new n)k.call(l,i)&&r++;return n=l=null,(T=r?2==r?function(e,t){var n,i={},r=x.call(e)==h;for(n in e)r&&"prototype"==n||k.call(i,n)||!(i[n]=1)||!k.call(e,n)||t(n)}:function(e,t){var n,i,r=x.call(e)==h;for(n in e)r&&"prototype"==n||!k.call(e,n)||(i="constructor"===n)||t(n);(i||k.call(e,n="constructor"))&&t(n)}:(l=["valueOf","toString","toLocaleString","propertyIsEnumerable","isPrototypeOf","hasOwnProperty","constructor"],function(e,t){var n,i,r,o,s,a=x.call(e)==h,c=a||"function"==typeof e.constructor||("object"==(s=typeof(r=e)[o="hasOwnProperty"])?!r[o]:d[s])?k:e.hasOwnProperty;for(n in e)a&&"prototype"==n||!c.call(e,n)||t(n);for(i=l.length;n=l[--i];c.call(e,n)&&t(n));}))(e,t)},!u("json-stringify")){var p={92:"\\\\",34:'\\"',8:"\\b",12:"\\f",10:"\\n",13:"\\r",9:"\\t"},I=function(e,t){return("000000"+(t||0)).slice(-e)},M=function(e){var t,n='"',i=0,r=e.length,o=10<r&&a;for(o&&(t=e.split(""));i<r;i++){var s=e.charCodeAt(i);switch(s){case 8:case 9:case 10:case 12:case 13:case 34:case 92:n+=p[s];break;default:if(s<32){n+="\\u00"+I(2,s.toString(16));break}n+=o?t[i]:a?e.charAt(i):e[i]}}return n+'"'},D=function(e,t,n,i,r,o,s){var a,c,l,u,h,d,p,f,g,m,v,y,b,w,C,_;try{a=t[e]}catch(e){}if("object"==typeof a&&a)if("[object Date]"!=(c=x.call(a))||k.call(a,"toJSON"))"function"==typeof a.toJSON&&(c!=E&&c!=N&&c!=P||k.call(a,"toJSON"))&&(a=a.toJSON(e));else if(-1/0<a&&a<1/0){if(O){for(h=A(a/864e5),l=A(h/365.2425)+1970-1;O(l+1,0)<=h;l++);for(u=A((h-O(l,0))/30.42);O(l,u+1)<=h;u++);h=1+h-O(l,u),p=A((d=(a%864e5+864e5)%864e5)/36e5)%24,f=A(d/6e4)%60,g=A(d/1e3)%60,m=d%1e3}else l=a.getUTCFullYear(),u=a.getUTCMonth(),h=a.getUTCDate(),p=a.getUTCHours(),f=a.getUTCMinutes(),g=a.getUTCSeconds(),m=a.getUTCMilliseconds();a=(l<=0||1e4<=l?(l<0?"-":"+")+I(6,l<0?-l:l):I(4,l))+"-"+I(2,u+1)+"-"+I(2,h)+"T"+I(2,p)+":"+I(2,f)+":"+I(2,g)+"."+I(3,m)+"Z"}else a=null;if(n&&(a=n.call(t,e,a)),null===a)return"null";if("[object Boolean]"==(c=x.call(a)))return""+a;if(c==E)return-1/0<a&&a<1/0?""+a:"null";if(c==N)return M(""+a);if("object"==typeof a){for(w=s.length;w--;)if(s[w]===a)throw TypeError();if(s.push(a),v=[],C=o,o+=r,c==P){for(b=0,w=a.length;b<w;b++)y=D(b,a,n,i,r,o,s),v.push(y===S?"null":y);_=v.length?r?"[\n"+o+v.join(",\n"+o)+"\n"+C+"]":"["+v.join(",")+"]":"[]"}else T(i||a,function(e){var t=D(e,a,n,i,r,o,s);t!==S&&v.push(M(e)+":"+(r?" ":"")+t)}),_=v.length?r?"{\n"+o+v.join(",\n"+o)+"\n"+C+"}":"{"+v.join(",")+"}":"{}";return s.pop(),_}};c.stringify=function(e,t,n){var i,r,o,s;if("function"==typeof t||"object"==typeof t&&t)if((s=x.call(t))==h)r=t;else if(s==P){o={};for(var a,c=0,l=t.length;c<l;a=t[c++],((s=x.call(a))==N||s==E)&&(o[a]=1));}if(n)if((s=x.call(n))==E){if(0<(n-=n%1))for(i="",10<n&&(n=10);i.length<n;i+=" ");}else s==N&&(i=n.length<=10?n:n.slice(0,10));return D("",((a={})[""]=e,a),r,o,i,"",[])}}if(!u("json-parse")){var f,g,m=String.fromCharCode,v={92:"\\",34:'"',47:"/",98:"\b",116:" ",110:"\n",102:"\f",114:"\r"},y=function(){throw f=g=null,SyntaxError()},r=function(){for(var e,t,n,i,r,o=g,s=o.length;f<s;)switch(r=o.charCodeAt(f)){case 9:case 10:case 13:case 32:f++;break;case 123:case 125:case 91:case 93:case 58:case 44:return e=a?o.charAt(f):o[f],f++,e;case 34:for(e="@",f++;f<s;)if((r=o.charCodeAt(f))<32)y();else if(92==r)switch(r=o.charCodeAt(++f)){case 92:case 34:case 47:case 98:case 116:case 110:case 102:case 114:e+=v[r],f++;break;case 117:for(t=++f,n=f+4;f<n;f++)48<=(r=o.charCodeAt(f))&&r<=57||97<=r&&r<=102||65<=r&&r<=70||y();e+=m("0x"+o.slice(t,f));break;default:y()}else{if(34==r)break;for(r=o.charCodeAt(f),t=f;32<=r&&92!=r&&34!=r;)r=o.charCodeAt(++f);e+=o.slice(t,f)}if(34==o.charCodeAt(f))return f++,e;y();default:if(t=f,45==r&&(i=!0,r=o.charCodeAt(++f)),48<=r&&r<=57){for(48==r&&48<=(r=o.charCodeAt(f+1))&&r<=57&&y(),i=!1;f<s&&48<=(r=o.charCodeAt(f))&&r<=57;f++);if(46==o.charCodeAt(f)){for(n=++f;n<s&&48<=(r=o.charCodeAt(n))&&r<=57;n++);n==f&&y(),f=n}if(101==(r=o.charCodeAt(f))||69==r){for(43!=(r=o.charCodeAt(++f))&&45!=r||f++,n=f;n<s&&48<=(r=o.charCodeAt(n))&&r<=57;n++);n==f&&y(),f=n}return+o.slice(t,f)}if(i&&y(),"true"==o.slice(f,f+4))return f+=4,!0;if("false"==o.slice(f,f+5))return f+=5,!1;if("null"==o.slice(f,f+4))return f+=4,null;y()}return"$"},o=function(e){var t,n;if("$"==e&&y(),"string"==typeof e){if("@"==(a?e.charAt(0):e[0]))return e.slice(1);if("["==e){for(t=[];"]"!=(e=r());n||(n=!0))n&&(","==e?"]"==(e=r())&&y():y()),","==e&&y(),t.push(o(e));return t}if("{"==e){for(t={};"}"!=(e=r());n||(n=!0))n&&(","==e?"}"==(e=r())&&y():y()),","!=e&&"string"==typeof e&&"@"==(a?e.charAt(0):e[0])&&":"==r()||y(),t[e.slice(1)]=o(r());return t}y()}return e},s=function(e,t,n){var i=b(e,t,n);i===S?delete e[t]:e[t]=i},b=function(e,t,n){var i,r=e[t];if("object"==typeof r&&r)if(x.call(r)==P)for(i=r.length;i--;)s(r,i,n);else T(r,function(e){s(r,e,n)});return n.call(e,t,r)};c.parse=function(e,t){var n,i;return f=0,g=""+e,n=o(r()),"$"!=r()&&y(),f=g=null,t&&x.call(t)==h?b(((i={})[""]=n,i),"",t):n}}}t&&C(function(){return c})}(this)},{}],50:[function(e,t,n){t.exports=function(e,t){for(var n=[],i=(t=t||0)||0;i<e.length;i++)n[i-t]=e[i];return n}},{}]},{},[1])(1)}(),livechat.io=window.io,window.io=window.previous_io,function(e,t){e.Pusher=function(){return function(){function n(e,t){null==e&&n.warn("Warning","You must pass your app key when you instantiate Pusher."),t=t||{};var i=this;this.key=e,this.config=n.Util.extend(n.getGlobalConfig(),t.cluster?n.getClusterConfig(t.cluster):{},t),this.channels=new n.Channels,this.global_emitter=new n.EventsDispatcher,this.sessionID=Math.floor(1e9*Math.random()),this.timeline=new n.Timeline(this.key,this.sessionID,{cluster:this.config.cluster,features:n.Util.getClientFeatures(),params:this.config.timelineParams||{},limit:50,level:n.Timeline.INFO,version:n.VERSION}),this.config.disableStats||(this.timelineSender=new n.TimelineSender(this.timeline,{host:this.config.statsHost,path:"/timeline/v2/jsonp"})),this.connection=new n.ConnectionManager(this.key,n.Util.extend({getStrategy:function(e){return e=n.Util.extend({},i.config,e),n.StrategyBuilder.build(n.getDefaultStrategy(e),e)},timeline:this.timeline,activityTimeout:this.config.activity_timeout,pongTimeout:this.config.pong_timeout,unavailableTimeout:this.config.unavailable_timeout},this.config,{encrypted:this.isEncrypted()})),this.connection.bind("connected",function(){i.subscribeAll(),i.timelineSender&&i.timelineSender.send(i.connection.isEncrypted())}),this.connection.bind("message",function(e){var t=0===e.event.indexOf("pusher_internal:");if(e.channel){var n=i.channel(e.channel);n&&n.handleEvent(e.event,e.data)}t||i.global_emitter.emit(e.event,e.data)}),this.connection.bind("disconnected",function(){i.channels.disconnect()}),this.connection.bind("error",function(e){n.warn("Error",e)}),n.instances.push(this),this.timeline.info({instances:n.instances.length}),n.isReady&&i.connect()}var e=n.prototype;n.instances=[],n.isReady=!1,n.debug=function(){n.log&&n.log(n.Util.stringify.apply(this,arguments))},n.warn=function(){var e=n.Util.stringify.apply(this,arguments);window.console&&(window.console.warn?window.console.warn(e):window.console.log&&window.console.log(e)),n.log&&n.log(e)},n.ready=function(){n.isReady=!0;for(var e=0,t=n.instances.length;e<t;e++)n.instances[e].connect()},e.channel=function(e){return this.channels.find(e)},e.allChannels=function(){return this.channels.all()},e.connect=function(){if(this.connection.connect(),this.timelineSender&&!this.timelineSenderTimer){var e=this.connection.isEncrypted(),t=this.timelineSender;this.timelineSenderTimer=new n.PeriodicTimer(6e4,function(){t.send(e)})}},e.disconnect=function(){this.connection.disconnect(),this.timelineSenderTimer&&(this.timelineSenderTimer.ensureAborted(),this.timelineSenderTimer=null)},e.bind=function(e,t){return this.global_emitter.bind(e,t),this},e.bind_all=function(e){return this.global_emitter.bind_all(e),this},e.subscribeAll=function(){for(var e in this.channels.channels)this.channels.channels.hasOwnProperty(e)&&this.subscribe(e)},e.subscribe=function(e){return e=this.channels.add(e,this),"connected"===this.connection.state&&e.subscribe(),e},e.unsubscribe=function(e){(e=this.channels.remove(e))&&"connected"===this.connection.state&&e.unsubscribe()},e.send_event=function(e,t,n){return this.connection.send_event(e,t,n)},e.isEncrypted=function(){return"https:"===n.Util.getDocument().location.protocol||Boolean(this.config.encrypted)},n.HTTP={},this.Pusher=n}.call(this),function(){function n(e){window.clearTimeout(e)}function i(e){window.clearInterval(e)}function r(e,t,n,i){var r=this;this.clear=t,this.timer=e(function(){null!==r.timer&&(r.timer=i(r.timer))},n)}var e=r.prototype;e.isRunning=function(){return null!==this.timer},e.ensureAborted=function(){this.timer&&(this.clear(this.timer),this.timer=null)},Pusher.Timer=function(e,t){return new r(setTimeout,n,e,function(e){return t(),null})},Pusher.PeriodicTimer=function(e,t){return new r(setInterval,i,e,function(e){return t(),e})}}.call(this),function(){Pusher.Util={now:function(){return Date.now?Date.now():(new Date).valueOf()},defer:function(e){return new Pusher.Timer(0,e)},extend:function(e){for(var t=1;t<arguments.length;t++){var n,i=arguments[t];for(n in i)e[n]=i[n]&&i[n].constructor&&i[n].constructor===Object?Pusher.Util.extend(e[n]||{},i[n]):i[n]}return e},stringify:function(){for(var e=["Pusher"],t=0;t<arguments.length;t++)"string"==typeof arguments[t]?e.push(arguments[t]):void 0===window.JSON?e.push(arguments[t].toString()):e.push(JSON.stringify(arguments[t]));return e.join(" : ")},arrayIndexOf:function(e,t){var n=Array.prototype.indexOf;if(null===e)return-1;if(n&&e.indexOf===n)return e.indexOf(t);n=0;for(var i=e.length;n<i;n++)if(e[n]===t)return n;return-1},objectApply:function(e,t){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(e[n],n,e)},keys:function(e){var n=[];return Pusher.Util.objectApply(e,function(e,t){n.push(t)}),n},values:function(e){var t=[];return Pusher.Util.objectApply(e,function(e){t.push(e)}),t},apply:function(e,t,n){for(var i=0;i<e.length;i++)t.call(n||window,e[i],i,e)},map:function(e,t){for(var n=[],i=0;i<e.length;i++)n.push(t(e[i],i,e,n));return n},mapObject:function(e,n){var i={};return Pusher.Util.objectApply(e,function(e,t){i[t]=n(e)}),i},filter:function(e,t){t=t||function(e){return!!e};for(var n=[],i=0;i<e.length;i++)t(e[i],i,e,n)&&n.push(e[i]);return n},filterObject:function(n,i){var r={};return Pusher.Util.objectApply(n,function(e,t){(i&&i(e,t,n,r)||Boolean(e))&&(r[t]=e)}),r},flatten:function(e){var n=[];return Pusher.Util.objectApply(e,function(e,t){n.push([t,e])}),n},any:function(e,t){for(var n=0;n<e.length;n++)if(t(e[n],n,e))return!0;return!1},all:function(e,t){for(var n=0;n<e.length;n++)if(!t(e[n],n,e))return!1;return!0},method:function(t){var n=Array.prototype.slice.call(arguments,1);return function(e){return e[t].apply(e,n.concat(arguments))}},getWindow:function(){return window},getDocument:function(){return document},getLocalStorage:function(){try{return window.localStorage}catch(e){}},getClientFeatures:function(){return Pusher.Util.keys(Pusher.Util.filterObject({ws:Pusher.WSTransport},function(e){return e.isSupported({})}))},addWindowListener:function(e,t){var n=Pusher.Util.getWindow();void 0!==n.addEventListener?n.addEventListener(e,t,!1):n.attachEvent("on"+e,t)},removeWindowListener:function(e,t){var n=Pusher.Util.getWindow();void 0!==n.addEventListener?n.removeEventListener(e,t,!1):n.detachEvent("on"+e,t)},isXHRSupported:function(){var e=window.XMLHttpRequest;return Boolean(e)&&void 0!==(new e).withCredentials},isXDRSupported:function(e){e=e?"https:":"http:";var t=Pusher.Util.getDocument().location.protocol;return Boolean(window.XDomainRequest)&&t===e}}}.call(this),function(){Pusher.VERSION="3.0.0",Pusher.PROTOCOL=7,Pusher.host="ws.pusherapp.com",Pusher.ws_port=80,Pusher.wss_port=443,Pusher.sockjs_host="sockjs.pusher.com",Pusher.sockjs_http_port=80,Pusher.sockjs_https_port=443,Pusher.sockjs_path="/pusher",Pusher.stats_host="stats.pusher.com",Pusher.channel_auth_endpoint="/pusher/auth",Pusher.channel_auth_transport="ajax",Pusher.activity_timeout=12e4,Pusher.pong_timeout=3e4,Pusher.unavailable_timeout=1e4,Pusher.cdn_http="http://js.pusher.com/",Pusher.cdn_https="https://js.pusher.com/",Pusher.dependency_suffix=".min",Pusher.getDefaultStrategy=function(e){return[[":def","ws_options",{hostUnencrypted:e.wsHost+":"+e.wsPort,hostEncrypted:e.wsHost+":"+e.wssPort}],[":def","wss_options",[":extend",":ws_options",{encrypted:!0}]],[":def","sockjs_options",{hostUnencrypted:e.httpHost+":"+e.httpPort,hostEncrypted:e.httpHost+":"+e.httpsPort,httpPath:e.httpPath}],[":def","timeouts",{loop:!0,timeout:15e3,timeoutLimit:6e4}],[":def","ws_manager",[":transport_manager",{lives:2,minPingDelay:1e4,maxPingDelay:e.activity_timeout}]],[":def","streaming_manager",[":transport_manager",{lives:2,minPingDelay:1e4,maxPingDelay:e.activity_timeout}]],[":def_transport","ws","ws",3,":ws_options",":ws_manager"],[":def_transport","wss","ws",3,":wss_options",":ws_manager"],[":def_transport","sockjs","sockjs",1,":sockjs_options"],[":def_transport","xhr_streaming","xhr_streaming",1,":sockjs_options",":streaming_manager"],[":def_transport","xdr_streaming","xdr_streaming",1,":sockjs_options",":streaming_manager"],[":def_transport","xhr_polling","xhr_polling",1,":sockjs_options"],[":def_transport","xdr_polling","xdr_polling",1,":sockjs_options"],[":def","ws_loop",[":sequential",":timeouts",":ws"]],[":def","wss_loop",[":sequential",":timeouts",":wss"]],[":def","sockjs_loop",[":sequential",":timeouts",":sockjs"]],[":def","streaming_loop",[":sequential",":timeouts",[":if",[":is_supported",":xhr_streaming"],":xhr_streaming",":xdr_streaming"]]],[":def","polling_loop",[":sequential",":timeouts",[":if",[":is_supported",":xhr_polling"],":xhr_polling",":xdr_polling"]]],[":def","http_loop",[":if",[":is_supported",":streaming_loop"],[":best_connected_ever",":streaming_loop",[":delayed",4e3,[":polling_loop"]]],[":polling_loop"]]],[":def","http_fallback_loop",[":if",[":is_supported",":http_loop"],[":http_loop"],[":sockjs_loop"]]],[":def","strategy",[":cached",18e5,[":first_connected",[":if",[":is_supported",":ws"],e.encrypted?[":best_connected_ever",":ws_loop",[":delayed",2e3,[":http_fallback_loop"]]]:[":best_connected_ever",":ws_loop",[":delayed",2e3,[":wss_loop"]],[":delayed",5e3,[":http_fallback_loop"]]],":http_fallback_loop"]]]]]}}.call(this),function(){Pusher.getGlobalConfig=function(){return{wsHost:Pusher.host,wsPort:Pusher.ws_port,wssPort:Pusher.wss_port,httpHost:Pusher.sockjs_host,httpPort:Pusher.sockjs_http_port,httpsPort:Pusher.sockjs_https_port,httpPath:Pusher.sockjs_path,statsHost:Pusher.stats_host,authEndpoint:Pusher.channel_auth_endpoint,authTransport:Pusher.channel_auth_transport,activity_timeout:Pusher.activity_timeout,pong_timeout:Pusher.pong_timeout,unavailable_timeout:Pusher.unavailable_timeout}},Pusher.getClusterConfig=function(e){return{wsHost:"ws-"+e+".pusher.com",httpHost:"sockjs-"+e+".pusher.com"}}}.call(this),function(){function e(t){var e=function(e){Error.call(this,e),this.name=t};return Pusher.Util.extend(e.prototype,Error.prototype),e}Pusher.Errors={BadEventName:e("BadEventName"),RequestTimedOut:e("RequestTimedOut"),TransportPriorityTooLow:e("TransportPriorityTooLow"),TransportClosed:e("TransportClosed"),UnsupportedTransport:e("UnsupportedTransport"),UnsupportedStrategy:e("UnsupportedStrategy")}}.call(this),function(){function e(e){this.callbacks=new t,this.global_callbacks=[],this.failThrough=e}function t(){this._callbacks={}}var n=e.prototype;n.bind=function(e,t,n){return this.callbacks.add(e,t,n),this},n.bind_all=function(e){return this.global_callbacks.push(e),this},n.unbind=function(e,t,n){return this.callbacks.remove(e,t,n),this},n.unbind_all=function(e,t){return this.callbacks.remove(e,t),this},n.emit=function(e,t){var n;for(n=0;n<this.global_callbacks.length;n++)this.global_callbacks[n](e,t);var i=this.callbacks.get(e);if(i&&0<i.length)for(n=0;n<i.length;n++)i[n].fn.call(i[n].context||window,t);else this.failThrough&&this.failThrough(e,t);return this},t.prototype.get=function(e){return this._callbacks["_"+e]},t.prototype.add=function(e,t,n){e="_"+e,this._callbacks[e]=this._callbacks[e]||[],this._callbacks[e].push({fn:t,context:n})},t.prototype.remove=function(e,t,n){e||t||n?(e=e?["_"+e]:Pusher.Util.keys(this._callbacks),t||n?Pusher.Util.apply(e,function(e){this._callbacks[e]=Pusher.Util.filter(this._callbacks[e]||[],function(e){return t&&t!==e.fn||n&&n!==e.context}),0===this._callbacks[e].length&&delete this._callbacks[e]},this):Pusher.Util.apply(e,function(e){delete this._callbacks[e]},this)):this._callbacks={}},Pusher.EventsDispatcher=e}.call(this),function(){function e(e,t){this.lastId=0,this.prefix=e,this.name=t}var t=e.prototype;t.create=function(e){this.lastId++;var t=this.lastId,n=this.prefix+t,i=this.name+"["+t+"]",r=!1,o=function(){r||(e.apply(null,arguments),r=!0)};return{number:t,id:n,name:i,callback:this[t]=o}},t.remove=function(e){delete this[e.number]},Pusher.ScriptReceiverFactory=e,Pusher.ScriptReceivers=new e("_pusher_script_","Pusher.ScriptReceivers")}.call(this),function(){function e(e){this.src=e}var t=e.prototype;t.send=function(e){var t=this,n="Error loading "+t.src;t.script=document.createElement("script"),t.script.id=e.id,t.script.src=t.src,t.script.type="text/javascript",t.script.charset="UTF-8",t.script.addEventListener?(t.script.onerror=function(){e.callback(n)},t.script.onload=function(){e.callback(null)}):t.script.onreadystatechange=function(){("loaded"===t.script.readyState||"complete"===t.script.readyState)&&e.callback(null)},void 0===t.script.async&&document.attachEvent&&/opera/i.test(navigator.userAgent)?(t.errorScript=document.createElement("script"),t.errorScript.id=e.id+"_error",t.errorScript.text=e.name+"('"+n+"');",t.script.async=t.errorScript.async=!1):t.script.async=!0;var i=document.getElementsByTagName("head")[0];i.insertBefore(t.script,i.firstChild),t.errorScript&&i.insertBefore(t.errorScript,t.script.nextSibling)},t.cleanup=function(){this.script&&(this.script.onload=this.script.onerror=null,this.script.onreadystatechange=null),this.script&&this.script.parentNode&&this.script.parentNode.removeChild(this.script),this.errorScript&&this.errorScript.parentNode&&this.errorScript.parentNode.removeChild(this.errorScript),this.errorScript=this.script=null},Pusher.ScriptRequest=e}.call(this),function(){function e(e){this.options=e,this.receivers=e.receivers||Pusher.ScriptReceivers,this.loading={}}var t=e.prototype;t.load=function(r,e,t){var o=this;if(o.loading[r]&&0<o.loading[r].length)o.loading[r].push(t);else{o.loading[r]=[t];var s=new Pusher.ScriptRequest(o.getPath(r,e)),a=o.receivers.create(function(e){if(o.receivers.remove(a),o.loading[r]){var t=o.loading[r];delete o.loading[r];for(var n=function(e){e||s.cleanup()},i=0;i<t.length;i++)t[i](e,n)}});s.send(a)}},t.getRoot=function(e){var t=Pusher.Util.getDocument().location.protocol;return(e&&e.encrypted||"https:"===t?this.options.cdn_https:this.options.cdn_http).replace(/\/*$/,"")+"/"+this.options.version},t.getPath=function(e,t){return this.getRoot(t)+"/"+e+this.options.suffix+".js"},Pusher.DependencyLoader=e}.call(this),function(){function e(){Pusher.ready()}function t(){!function e(t){document.body?t():setTimeout(function(){e(t)},0)}(e)}Pusher.DependenciesReceivers=new Pusher.ScriptReceiverFactory("_pusher_dependencies","Pusher.DependenciesReceivers"),Pusher.Dependencies=new Pusher.DependencyLoader({cdn_http:Pusher.cdn_http,cdn_https:Pusher.cdn_https,version:Pusher.VERSION,suffix:Pusher.dependency_suffix,receivers:Pusher.DependenciesReceivers}),window.JSON?t():Pusher.Dependencies.load("json2",{},t)}(),function(){for(var n=String.fromCharCode,e=0;e<64;e++)"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(e);var t=function(e){var t=e.charCodeAt(0);return t<128?e:t<2048?n(192|t>>>6)+n(128|63&t):n(224|t>>>12&15)+n(128|t>>>6&63)+n(128|63&t)},i=function(e){var t=[0,2,1][e.length%3];return e=e.charCodeAt(0)<<16|(1<e.length?e.charCodeAt(1):0)<<8|(2<e.length?e.charCodeAt(2):0),["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(e>>>18),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(e>>>12&63),2<=t?"=":"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(e>>>6&63),1<=t?"=":"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(63&e)].join("")},r=window.btoa||function(e){return e.replace(/[\s\S]{1,3}/g,i)};Pusher.Base64={encode:function(e){return r(e.replace(/[^\x00-\x7F]/g,t))}}}.call(this),function(){function e(e,t){this.url=e,this.data=t}var t=e.prototype;t.send=function(e){if(!this.request){var t=Pusher.Util.filterObject(this.data,function(e){return void 0!==e});t=Pusher.Util.map(Pusher.Util.flatten((n=t,Pusher.Util.mapObject(n,function(e){return"object"==typeof e&&(e=JSON.stringify(e)),encodeURIComponent(Pusher.Base64.encode(e.toString()))}))),Pusher.Util.method("join","=")).join("&"),this.request=new Pusher.ScriptRequest(this.url+"/"+e.number+"?"+t),this.request.send(e)}var n},t.cleanup=function(){this.request&&this.request.cleanup()},Pusher.JSONPRequest=e}.call(this),function(){function t(e,t,n){this.key=e,this.session=t,this.events=[],this.options=n||{},this.uniqueID=this.sent=0}var e=t.prototype;t.ERROR=3,t.INFO=6,t.DEBUG=7,e.log=function(e,t){e<=this.options.level&&(this.events.push(Pusher.Util.extend({},t,{timestamp:Pusher.Util.now()})),this.options.limit&&this.events.length>this.options.limit&&this.events.shift())},e.error=function(e){this.log(t.ERROR,e)},e.info=function(e){this.log(t.INFO,e)},e.debug=function(e){this.log(t.DEBUG,e)},e.isEmpty=function(){return 0===this.events.length},e.send=function(e,n){var i=this,t=Pusher.Util.extend({session:i.session,bundle:i.sent+1,key:i.key,lib:"js",version:i.options.version,cluster:i.options.cluster,features:i.options.features,timeline:i.events},i.options.params);return i.events=[],e(t,function(e,t){e||i.sent++,n&&n(e,t)}),!0},e.generateUniqueID=function(){return this.uniqueID++,this.uniqueID},Pusher.Timeline=t}.call(this),function(){function e(e,t){this.timeline=e,this.options=t||{}}e.prototype.send=function(t,e){var o=this;o.timeline.isEmpty()||o.timeline.send(function(e,n){var i=new Pusher.JSONPRequest("http"+(t?"s":"")+"://"+(o.host||o.options.host)+o.options.path,e),r=Pusher.ScriptReceivers.create(function(e,t){Pusher.ScriptReceivers.remove(r),i.cleanup(),t&&t.host&&(o.host=t.host),n&&n(e,t)});i.send(r)},e)},Pusher.TimelineSender=e}.call(this),function(){function e(e){this.strategies=e}function i(e){!e.error&&!e.aborted&&(e.abort(),e.aborted=!0)}var t=e.prototype;t.isSupported=function(){return Pusher.Util.any(this.strategies,Pusher.Util.method("isSupported"))},t.connect=function(e,o){return t=this.strategies,r=e,s=function(i,r){return function(e,t){var n;(r[i].error=e)?(n=r,Pusher.Util.all(n,function(e){return Boolean(e.error)})&&o(!0)):(Pusher.Util.apply(r,function(e){e.forceMinPriority(t.transport.priority)}),o(null,t))}},n=Pusher.Util.map(t,function(e,t,n,i){return e.connect(r,s(t,i))}),{abort:function(){Pusher.Util.apply(n,i)},forceMinPriority:function(t){Pusher.Util.apply(n,function(e){e.forceMinPriority(t)})}};var t,r,s,n},Pusher.BestConnectedEverStrategy=e}.call(this),function(){function e(e,t,n){this.strategy=e,this.transports=t,this.ttl=n.ttl||18e5,this.encrypted=n.encrypted,this.timeline=n.timeline}function d(e){return"pusherTransport"+(e?"Encrypted":"Unencrypted")}function p(e){var t=Pusher.Util.getLocalStorage();if(t)try{delete t[d(e)]}catch(e){}}var t=e.prototype;t.isSupported=function(){return this.strategy.isSupported()},t.connect=function(s,a){var c=this.encrypted,e=function(t){var e=Pusher.Util.getLocalStorage();if(e)try{var n=e[d(t)];if(n)return JSON.parse(n)}catch(e){p(t)}return null}(c),l=[this.strategy];if(e&&e.timestamp+this.ttl>=Pusher.Util.now()){var t=this.transports[e.transport];t&&(this.timeline.info({cached:!0,transport:e.transport,latency:e.latency}),l.push(new Pusher.SequentialStrategy([t],{timeout:2*e.latency+1e3,failFast:!0})))}var u=Pusher.Util.now(),h=l.pop().connect(s,function e(t,n){if(t)p(c),0<l.length?(u=Pusher.Util.now(),h=l.pop().connect(s,e)):a(t);else{var i=n.transport.name,r=Pusher.Util.now()-u,o=Pusher.Util.getLocalStorage();if(o)try{o[d(c)]=JSON.stringify({timestamp:Pusher.Util.now(),transport:i,latency:r})}catch(e){}a(null,n)}});return{abort:function(){h.abort()},forceMinPriority:function(e){s=e,h&&h.forceMinPriority(e)}}},Pusher.CachedStrategy=e}.call(this),function(){function e(e,t){this.strategy=e,this.options={delay:t.delay}}var t=e.prototype;t.isSupported=function(){return this.strategy.isSupported()},t.connect=function(t,e){var n,i=this.strategy,r=new Pusher.Timer(this.options.delay,function(){n=i.connect(t,e)});return{abort:function(){r.ensureAborted(),n&&n.abort()},forceMinPriority:function(e){t=e,n&&n.forceMinPriority(e)}}},Pusher.DelayedStrategy=e}.call(this),function(){function e(e){this.strategy=e}var t=e.prototype;t.isSupported=function(){return this.strategy.isSupported()},t.connect=function(e,n){var i=this.strategy.connect(e,function(e,t){t&&i.abort(),n(e,t)});return i},Pusher.FirstConnectedStrategy=e}.call(this),function(){function e(e,t,n){this.test=e,this.trueBranch=t,this.falseBranch=n}var t=e.prototype;t.isSupported=function(){return(this.test()?this.trueBranch:this.falseBranch).isSupported()},t.connect=function(e,t){return(this.test()?this.trueBranch:this.falseBranch).connect(e,t)},Pusher.IfStrategy=e}.call(this),function(){function e(e,t){this.strategies=e,this.loop=Boolean(t.loop),this.failFast=Boolean(t.failFast),this.timeout=t.timeout,this.timeoutLimit=t.timeoutLimit}var t=e.prototype;t.isSupported=function(){return Pusher.Util.any(this.strategies,Pusher.Util.method("isSupported"))},t.connect=function(n,i){var r=this,o=this.strategies,s=0,a=this.timeout,c=null,l=function(e,t){t?i(null,t):(s+=1,r.loop&&(s%=o.length),s<o.length?(a&&(a*=2,r.timeoutLimit&&(a=Math.min(a,r.timeoutLimit))),c=r.tryStrategy(o[s],n,{timeout:a,failFast:r.failFast},l)):i(!0))};return c=this.tryStrategy(o[s],n,{timeout:a,failFast:this.failFast},l),{abort:function(){c.abort()},forceMinPriority:function(e){n=e,c&&c.forceMinPriority(e)}}},t.tryStrategy=function(e,t,n,i){var r=null,o=null;return 0<n.timeout&&(r=new Pusher.Timer(n.timeout,function(){o.abort(),i(!0)})),o=e.connect(t,function(e,t){e&&r&&r.isRunning()&&!n.failFast||(r&&r.ensureAborted(),i(e,t))}),{abort:function(){r&&r.ensureAborted(),o.abort()},forceMinPriority:function(e){o.forceMinPriority(e)}}},Pusher.SequentialStrategy=e}.call(this),function(){function e(e,t,n,i){this.name=e,this.priority=t,this.transport=n,this.options=i||{}}function h(e,t){return Pusher.Util.defer(function(){t(e)}),{abort:function(){},forceMinPriority:function(){}}}var t=e.prototype;t.isSupported=function(){return this.transport.isSupported({encrypted:this.options.encrypted})},t.connect=function(e,t){if(!this.isSupported())return h(new Pusher.Errors.UnsupportedStrategy,t);if(this.priority<e)return h(new Pusher.Errors.TransportPriorityTooLow,t);var n=this,i=!1,r=this.transport.createConnection(this.name,this.priority,this.options.key,this.options),o=null,s=function(){r.unbind("initialized",s),r.connect()},a=function(){o=new Pusher.Handshake(r,function(e){i=!0,u(),t(null,e)})},c=function(e){u(),t(e)},l=function(){u(),t(new Pusher.Errors.TransportClosed(r))},u=function(){r.unbind("initialized",s),r.unbind("open",a),r.unbind("error",c),r.unbind("closed",l)};return r.bind("initialized",s),r.bind("open",a),r.bind("error",c),r.bind("closed",l),r.initialize(),{abort:function(){i||(u(),o?o.close():r.close())},forceMinPriority:function(e){i||n.priority<e&&(o?o.close():r.close())}}},Pusher.TransportStrategy=e}.call(this),function(){function n(e,t,n){return e+(t.encrypted?"s":"")+"://"+(t.encrypted?t.hostEncrypted:t.hostUnencrypted)+n}function i(e,t){return"/app/"+e+"?protocol="+Pusher.PROTOCOL+"&client=js&version="+Pusher.VERSION+(t?"&"+t:"")}Pusher.URLSchemes={ws:{getInitial:function(e,t){return n("ws",t,i(e,"flash=false"))}},sockjs:{getInitial:function(e,t){return n("http",t,t.httpPath||"/pusher")},getPath:function(e,t){return i(e)}},http:{getInitial:function(e,t){return n("http",t,(t.httpPath||"/pusher")+i(e))}}}}.call(this),function(){function e(e,t,n,i,r){Pusher.EventsDispatcher.call(this),this.hooks=e,this.name=t,this.priority=n,this.key=i,this.options=r,this.state="new",this.timeline=r.timeline,this.activityTimeout=r.activityTimeout,this.id=this.timeline.generateUniqueID()}var t=e.prototype;Pusher.Util.extend(t,Pusher.EventsDispatcher.prototype),t.handlesActivityChecks=function(){return Boolean(this.hooks.handlesActivityChecks)},t.supportsPing=function(){return Boolean(this.hooks.supportsPing)},t.initialize=function(){var n=this;n.timeline.info(n.buildTimelineMessage({transport:n.name+(n.options.encrypted?"s":"")})),n.hooks.isInitialized()?n.changeState("initialized"):n.hooks.file?(n.changeState("initializing"),Pusher.Dependencies.load(n.hooks.file,{encrypted:n.options.encrypted},function(e,t){n.hooks.isInitialized()?(n.changeState("initialized"),t(!0)):(e&&n.onError(e),n.onClose(),t(!1))})):n.onClose()},t.connect=function(){var t=this;if(t.socket||"initialized"!==t.state)return!1;var e=t.hooks.urls.getInitial(t.key,t.options);try{t.socket=t.hooks.getSocket(e,t.options)}catch(e){return Pusher.Util.defer(function(){t.onError(e),t.changeState("closed")}),!1}return t.bindListeners(),Pusher.debug("Connecting",{transport:t.name,url:e}),t.changeState("connecting"),!0},t.close=function(){return!!this.socket&&(this.socket.close(),!0)},t.send=function(e){var t=this;return"open"===t.state&&(Pusher.Util.defer(function(){t.socket&&t.socket.send(e)}),!0)},t.ping=function(){"open"===this.state&&this.supportsPing()&&this.socket.ping()},t.onOpen=function(){this.hooks.beforeOpen&&this.hooks.beforeOpen(this.socket,this.hooks.urls.getPath(this.key,this.options)),this.changeState("open"),this.socket.onopen=void 0},t.onError=function(e){this.emit("error",{type:"WebSocketError",error:e}),this.timeline.error(this.buildTimelineMessage({error:e.toString()}))},t.onClose=function(e){e?this.changeState("closed",{code:e.code,reason:e.reason,wasClean:e.wasClean}):this.changeState("closed"),this.unbindListeners(),this.socket=void 0},t.onMessage=function(e){this.emit("message",e)},t.onActivity=function(){this.emit("activity")},t.bindListeners=function(){var t=this;t.socket.onopen=function(){t.onOpen()},t.socket.onerror=function(e){t.onError(e)},t.socket.onclose=function(e){t.onClose(e)},t.socket.onmessage=function(e){t.onMessage(e)},t.supportsPing()&&(t.socket.onactivity=function(){t.onActivity()})},t.unbindListeners=function(){this.socket&&(this.socket.onopen=void 0,this.socket.onerror=void 0,this.socket.onclose=void 0,this.socket.onmessage=void 0,this.supportsPing()&&(this.socket.onactivity=void 0))},t.changeState=function(e,t){this.state=e,this.timeline.info(this.buildTimelineMessage({state:e,params:t})),this.emit(e,t)},t.buildTimelineMessage=function(e){return Pusher.Util.extend({cid:this.id},e)},Pusher.TransportConnection=e}.call(this),function(){function e(e){this.hooks=e}var t=e.prototype;t.isSupported=function(e){return this.hooks.isSupported(e)},t.createConnection=function(e,t,n,i){return new Pusher.TransportConnection(this.hooks,e,t,n,i)},Pusher.Transport=e}.call(this),function(){Pusher.WSTransport=new Pusher.Transport({urls:Pusher.URLSchemes.ws,handlesActivityChecks:!1,supportsPing:!1,isInitialized:function(){return Boolean(window.WebSocket||window.MozWebSocket)},isSupported:function(){return Boolean(window.WebSocket||window.MozWebSocket)},getSocket:function(e){return new(window.WebSocket||window.MozWebSocket)(e)}}),Pusher.SockJSTransport=new Pusher.Transport({file:"sockjs",urls:Pusher.URLSchemes.sockjs,handlesActivityChecks:!0,supportsPing:!1,isSupported:function(){return!0},isInitialized:function(){return void 0!==window.SockJS},getSocket:function(e,t){return new SockJS(e,null,{js_path:Pusher.Dependencies.getPath("sockjs",{encrypted:t.encrypted}),ignore_null_origin:t.ignoreNullOrigin})},beforeOpen:function(e,t){e.send(JSON.stringify({path:t}))}});var e={urls:Pusher.URLSchemes.http,handlesActivityChecks:!1,supportsPing:!0,isInitialized:function(){return Boolean(Pusher.HTTP.Socket)}},t=Pusher.Util.extend({getSocket:function(e){return Pusher.HTTP.getStreamingSocket(e)}},e),n=(e=Pusher.Util.extend({getSocket:function(e){return Pusher.HTTP.getPollingSocket(e)}},e),{file:"xhr",isSupported:Pusher.Util.isXHRSupported}),i={file:"xdr",isSupported:function(e){return Pusher.Util.isXDRSupported(e.encrypted)}};Pusher.XHRStreamingTransport=new Pusher.Transport(Pusher.Util.extend({},t,n)),Pusher.XDRStreamingTransport=new Pusher.Transport(Pusher.Util.extend({},t,i)),Pusher.XHRPollingTransport=new Pusher.Transport(Pusher.Util.extend({},e,n)),Pusher.XDRPollingTransport=new Pusher.Transport(Pusher.Util.extend({},e,i))}.call(this),function(){function e(e,t,n){this.manager=e,this.transport=t,this.minPingDelay=n.minPingDelay,this.maxPingDelay=n.maxPingDelay,this.pingDelay=void 0}var t=e.prototype;t.createConnection=function(e,t,n,i){var r=this;i=Pusher.Util.extend({},i,{activityTimeout:r.pingDelay});var o=r.transport.createConnection(e,t,n,i),s=null,a=function(){o.unbind("open",a),o.bind("closed",c),s=Pusher.Util.now()},c=function(e){o.unbind("closed",c),1002===e.code||1003===e.code?r.manager.reportDeath():!e.wasClean&&s&&(e=Pusher.Util.now()-s)<2*r.maxPingDelay&&(r.manager.reportDeath(),r.pingDelay=Math.max(e/2,r.minPingDelay))};return o.bind("open",a),o},t.isSupported=function(e){return this.manager.isAlive()&&this.transport.isSupported(e)},Pusher.AssistantToTheTransportManager=e}.call(this),function(){function e(e){this.options=e||{},this.livesLeft=this.options.lives||1/0}var t=e.prototype;t.getAssistant=function(e){return new Pusher.AssistantToTheTransportManager(this,e,{minPingDelay:this.options.minPingDelay,maxPingDelay:this.options.maxPingDelay})},t.isAlive=function(){return 0<this.livesLeft},t.reportDeath=function(){this.livesLeft-=1},Pusher.TransportManager=e}.call(this),function(){function e(t){return function(e){return[t.apply(this,arguments),e]}}function i(e,t){if("string"!=typeof e[0]||":"!==e[0].charAt(0))return function e(t,n){if(0===t.length)return[[],n];var i=o(t[0],n),r=e(t.slice(1),i[1]);return[[i[0]].concat(r[0]),r[1]]}(e,t);var n=t[e[0].slice(1)];if(1<e.length){if("function"!=typeof n)throw"Calling non-function "+e[0];var i=[Pusher.Util.extend({},t)].concat(Pusher.Util.map(e.slice(1),function(e){return o(e,Pusher.Util.extend({},t))[0]}));return n.apply(this,i)}return[n,t]}function o(e,t){if("string"!=typeof e)return"object"==typeof e&&e instanceof Array&&0<e.length?i(e,t):[e,t];var n;if("string"==typeof e&&":"===e.charAt(0)){if(void 0===(n=t[e.slice(1)]))throw"Undefined symbol "+e;n=[n,t]}else n=[e,t];return n}var a={ws:Pusher.WSTransport,sockjs:Pusher.SockJSTransport,xhr_streaming:Pusher.XHRStreamingTransport,xdr_streaming:Pusher.XDRStreamingTransport,xhr_polling:Pusher.XHRPollingTransport,xdr_polling:Pusher.XDRPollingTransport},c={isSupported:function(){return!1},connect:function(e,t){var n=Pusher.Util.defer(function(){t(new Pusher.Errors.UnsupportedStrategy)});return{abort:function(){n.ensureAborted()},forceMinPriority:function(){}}}},n={extend:function(e,t,n){return[Pusher.Util.extend({},t,n),e]},def:function(e,t,n){if(void 0!==e[t])throw"Redefining symbol "+t;return e[t]=n,[void 0,e]},def_transport:function(e,t,n,i,r,o){var s=a[n];if(!s)throw new Pusher.Errors.UnsupportedTransport(n);return n=e.enabledTransports&&-1===Pusher.Util.arrayIndexOf(e.enabledTransports,t)||e.disabledTransports&&-1!==Pusher.Util.arrayIndexOf(e.disabledTransports,t)?c:new Pusher.TransportStrategy(t,i,o?o.getAssistant(s):s,Pusher.Util.extend({key:e.key,encrypted:e.encrypted,timeline:e.timeline,ignoreNullOrigin:e.ignoreNullOrigin},r)),(i=e.def(e,t,n)[1]).transports=e.transports||{},i.transports[t]=n,[void 0,i]},transport_manager:e(function(e,t){return new Pusher.TransportManager(t)}),sequential:e(function(e,t){var n=Array.prototype.slice.call(arguments,2);return new Pusher.SequentialStrategy(n,t)}),cached:e(function(e,t,n){return new Pusher.CachedStrategy(n,e.transports,{ttl:t,timeline:e.timeline,encrypted:e.encrypted})}),first_connected:e(function(e,t){return new Pusher.FirstConnectedStrategy(t)}),best_connected_ever:e(function(){var e=Array.prototype.slice.call(arguments,1);return new Pusher.BestConnectedEverStrategy(e)}),delayed:e(function(e,t,n){return new Pusher.DelayedStrategy(n,{delay:t})}),"if":e(function(e,t,n,i){return new Pusher.IfStrategy(t,n,i)}),is_supported:e(function(e,t){return function(){return t.isSupported()}})};Pusher.StrategyBuilder={build:function(e,t){return o(e,Pusher.Util.extend({},n,t))[1].strategy}}}.call(this),function(){Pusher.Protocol={decodeMessage:function(t){try{var e=JSON.parse(t.data);if("string"==typeof e.data)try{e.data=JSON.parse(e.data)}catch(e){if(!(e instanceof SyntaxError))throw e}return e}catch(e){throw{type:"MessageParseError",error:e,data:t.data}}},encodeMessage:function(e){return JSON.stringify(e)},processHandshake:function(e){if("pusher:connection_established"===(e=this.decodeMessage(e)).event){if(!e.data.activity_timeout)throw"No activity timeout specified in handshake";return{action:"connected",id:e.data.socket_id,activityTimeout:1e3*e.data.activity_timeout}}if("pusher:error"===e.event)return{action:this.getCloseAction(e.data),error:this.getCloseError(e.data)};throw"Invalid handshake"},getCloseAction:function(e){return e.code<4e3?1002<=e.code&&e.code<=1004?"backoff":null:4e3===e.code?"ssl_only":e.code<4100?"refused":e.code<4200?"backoff":e.code<4300?"retry":"refused"},getCloseError:function(e){return 1e3!==e.code&&1001!==e.code?{type:"PusherError",data:{code:e.code,message:e.reason||e.message}}:null}}}.call(this),function(){function e(e,t){Pusher.EventsDispatcher.call(this),this.id=e,this.transport=t,this.activityTimeout=t.activityTimeout,this.bindListeners()}var t=e.prototype;Pusher.Util.extend(t,Pusher.EventsDispatcher.prototype),t.handlesActivityChecks=function(){return this.transport.handlesActivityChecks()},t.send=function(e){return this.transport.send(e)},t.send_event=function(e,t,n){return e={event:e,data:t},n&&(e.channel=n),Pusher.debug("Event sent",e),this.send(Pusher.Protocol.encodeMessage(e))},t.ping=function(){this.transport.supportsPing()?this.transport.ping():this.send_event("pusher:ping",{})},t.close=function(){this.transport.close()},t.bindListeners=function(){var n=this,e={message:function(t){var e;try{e=Pusher.Protocol.decodeMessage(t)}catch(e){n.emit("error",{type:"MessageParseError",error:e,data:t.data})}if(void 0!==e){switch(Pusher.debug("Event recd",e),e.event){case"pusher:error":n.emit("error",{type:"PusherError",data:e.data});break;case"pusher:ping":n.emit("ping");break;case"pusher:pong":n.emit("pong")}n.emit("message",e)}},activity:function(){n.emit("activity")},error:function(e){n.emit("error",{type:"WebSocketError",error:e})},closed:function(e){t(),e&&e.code&&n.handleCloseEvent(e),n.transport=null,n.emit("closed")}},t=function(){Pusher.Util.objectApply(e,function(e,t){n.transport.unbind(t,e)})};Pusher.Util.objectApply(e,function(e,t){n.transport.bind(t,e)})},t.handleCloseEvent=function(e){var t=Pusher.Protocol.getCloseAction(e);(e=Pusher.Protocol.getCloseError(e))&&this.emit("error",e),t&&this.emit(t)},Pusher.Connection=e}.call(this),function(){function e(e,t){this.transport=e,this.callback=t,this.bindListeners()}var t=e.prototype;t.close=function(){this.unbindListeners(),this.transport.close()},t.bindListeners=function(){var n=this;n.onMessage=function(e){n.unbindListeners();try{var t=Pusher.Protocol.processHandshake(e);"connected"===t.action?n.finish("connected",{connection:new Pusher.Connection(t.id,n.transport),activityTimeout:t.activityTimeout}):(n.finish(t.action,{error:t.error}),n.transport.close())}catch(e){n.finish("error",{error:e}),n.transport.close()}},n.onClosed=function(e){n.unbindListeners();var t=Pusher.Protocol.getCloseAction(e)||"backoff";e=Pusher.Protocol.getCloseError(e),n.finish(t,{error:e})},n.transport.bind("message",n.onMessage),n.transport.bind("closed",n.onClosed)},t.unbindListeners=function(){this.transport.unbind("message",this.onMessage),this.transport.unbind("closed",this.onClosed)},t.finish=function(e,t){this.callback(Pusher.Util.extend({transport:this.transport,action:e},t))},Pusher.Handshake=e}.call(this),function(){function e(e,t){Pusher.EventsDispatcher.call(this),this.key=e,this.options=t||{},this.state="initialized",this.connection=null,this.encrypted=!!t.encrypted,this.timeline=this.options.timeline,this.connectionCallbacks=this.buildConnectionCallbacks(),this.errorCallbacks=this.buildErrorCallbacks(),this.handshakeCallbacks=this.buildHandshakeCallbacks(this.errorCallbacks);var n=this;Pusher.Network.bind("online",function(){n.timeline.info({netinfo:"online"}),("connecting"===n.state||"unavailable"===n.state)&&n.retryIn(0)}),Pusher.Network.bind("offline",function(){n.timeline.info({netinfo:"offline"}),n.connection&&n.sendActivityCheck()}),this.updateStrategy()}var t=e.prototype;Pusher.Util.extend(t,Pusher.EventsDispatcher.prototype),t.connect=function(){!this.connection&&!this.runner&&(this.strategy.isSupported()?(this.updateState("connecting"),this.startConnecting(),this.setUnavailableTimer()):this.updateState("failed"))},t.send=function(e){return!!this.connection&&this.connection.send(e)},t.send_event=function(e,t,n){return!!this.connection&&this.connection.send_event(e,t,n)},t.disconnect=function(){this.disconnectInternally(),this.updateState("disconnected")},t.isEncrypted=function(){return this.encrypted},t.startConnecting=function(){var n=this,i=function(e,t){e?n.runner=n.strategy.connect(0,i):"error"===t.action?(n.emit("error",{type:"HandshakeError",error:t.error}),n.timeline.error({handshakeError:t.error})):(n.abortConnecting(),n.handshakeCallbacks[t.action](t))};n.runner=n.strategy.connect(0,i)},t.abortConnecting=function(){this.runner&&(this.runner.abort(),this.runner=null)},t.disconnectInternally=function(){this.abortConnecting(),this.clearRetryTimer(),this.clearUnavailableTimer(),this.connection&&this.abandonConnection().close()},t.updateStrategy=function(){this.strategy=this.options.getStrategy({key:this.key,timeline:this.timeline,encrypted:this.encrypted})},t.retryIn=function(e){var t=this;t.timeline.info({action:"retry",delay:e}),0<e&&t.emit("connecting_in",Math.round(e/1e3)),t.retryTimer=new Pusher.Timer(e||0,function(){t.disconnectInternally(),t.connect()})},t.clearRetryTimer=function(){this.retryTimer&&(this.retryTimer.ensureAborted(),this.retryTimer=null)},t.setUnavailableTimer=function(){var e=this;e.unavailableTimer=new Pusher.Timer(e.options.unavailableTimeout,function(){e.updateState("unavailable")})},t.clearUnavailableTimer=function(){this.unavailableTimer&&this.unavailableTimer.ensureAborted()},t.sendActivityCheck=function(){var e=this;e.stopActivityCheck(),e.connection.ping(),e.activityTimer=new Pusher.Timer(e.options.pongTimeout,function(){e.timeline.error({pong_timed_out:e.options.pongTimeout}),e.retryIn(0)})},t.resetActivityCheck=function(){var e=this;e.stopActivityCheck(),e.connection.handlesActivityChecks()||(e.activityTimer=new Pusher.Timer(e.activityTimeout,function(){e.sendActivityCheck()}))},t.stopActivityCheck=function(){this.activityTimer&&this.activityTimer.ensureAborted()},t.buildConnectionCallbacks=function(){var t=this;return{message:function(e){t.resetActivityCheck(),t.emit("message",e)},ping:function(){t.send_event("pusher:pong",{})},activity:function(){t.resetActivityCheck()},error:function(e){t.emit("error",{type:"WebSocketError",error:e})},closed:function(){t.abandonConnection(),t.shouldRetry()&&t.retryIn(1e3)}}},t.buildHandshakeCallbacks=function(e){var t=this;return Pusher.Util.extend({},e,{connected:function(e){t.activityTimeout=Math.min(t.options.activityTimeout,e.activityTimeout,e.connection.activityTimeout||1/0),t.clearUnavailableTimer(),t.setConnection(e.connection),t.socket_id=t.connection.id,t.updateState("connected",{socket_id:t.socket_id})}})},t.buildErrorCallbacks=function(){function e(t){return function(e){e.error&&n.emit("error",{type:"WebSocketError",error:e.error}),t(e)}}var n=this;return{ssl_only:e(function(){n.encrypted=!0,n.updateStrategy(),n.retryIn(0)}),refused:e(function(){n.disconnect()}),backoff:e(function(){n.retryIn(1e3)}),retry:e(function(){n.retryIn(0)})}},t.setConnection=function(e){for(var t in this.connection=e,this.connectionCallbacks)this.connection.bind(t,this.connectionCallbacks[t]);this.resetActivityCheck()},t.abandonConnection=function(){if(this.connection){for(var e in this.stopActivityCheck(),this.connectionCallbacks)this.connection.unbind(e,this.connectionCallbacks[e]);return e=this.connection,this.connection=null,e}},t.updateState=function(e,t){var n=this.state;n!==(this.state=e)&&(Pusher.debug("State changed",n+" -> "+e),this.timeline.info({state:e,params:t}),this.emit("state_change",{previous:n,current:e}),this.emit(e,t))},t.shouldRetry=function(){return"connecting"===this.state||"connected"===this.state},Pusher.ConnectionManager=e}.call(this),function(){function e(){Pusher.EventsDispatcher.call(this);var e=this;void 0!==window.addEventListener&&(window.addEventListener("online",function(){e.emit("online")},!1),window.addEventListener("offline",function(){e.emit("offline")},!1))}Pusher.Util.extend(e.prototype,Pusher.EventsDispatcher.prototype),e.prototype.isOnline=function(){return void 0===window.navigator.onLine||window.navigator.onLine},Pusher.NetInfo=e,Pusher.Network=new e}.call(this),function(){function e(){this.reset()}var t=e.prototype;t.get=function(e){return Object.prototype.hasOwnProperty.call(this.members,e)?{id:e,info:this.members[e]}:null},t.each=function(n){var i=this;Pusher.Util.objectApply(i.members,function(e,t){n(i.get(t))})},t.setMyID=function(e){this.myID=e},t.onSubscription=function(e){this.members=e.presence.hash,this.count=e.presence.count,this.me=this.get(this.myID)},t.addMember=function(e){return null===this.get(e.user_id)&&this.count++,this.members[e.user_id]=e.user_info,this.get(e.user_id)},t.removeMember=function(e){var t=this.get(e.user_id);return t&&(delete this.members[e.user_id],this.count--),t},t.reset=function(){this.members={},this.count=0,this.me=this.myID=null},Pusher.Members=e}.call(this),function(){function e(n,e){Pusher.EventsDispatcher.call(this,function(e,t){Pusher.debug("No callbacks on "+n+" for "+e)}),this.name=n,this.pusher=e,this.subscribed=!1}var t=e.prototype;Pusher.Util.extend(t,Pusher.EventsDispatcher.prototype),t.authorize=function(e,t){return t(!1,{})},t.trigger=function(e,t){if(0!==e.indexOf("client-"))throw new Pusher.Errors.BadEventName("Event '"+e+"' does not start with 'client-'");return this.pusher.send_event(e,t,this.name)},t.disconnect=function(){this.subscribed=!1},t.handleEvent=function(e,t){0===e.indexOf("pusher_internal:")?"pusher_internal:subscription_succeeded"===e&&(this.subscribed=!0,this.emit("pusher:subscription_succeeded",t)):this.emit(e,t)},t.subscribe=function(){var n=this;n.authorize(n.pusher.connection.socket_id,function(e,t){e?n.handleEvent("pusher:subscription_error",t):n.pusher.send_event("pusher:subscribe",{auth:t.auth,channel_data:t.channel_data,channel:n.name})})},t.unsubscribe=function(){this.pusher.send_event("pusher:unsubscribe",{channel:this.name})},Pusher.Channel=e}.call(this),function(){function e(e,t){Pusher.Channel.call(this,e,t)}var t=e.prototype;Pusher.Util.extend(t,Pusher.Channel.prototype),t.authorize=function(e,t){return new Pusher.Channel.Authorizer(this,this.pusher.config).authorize(e,t)},Pusher.PrivateChannel=e}.call(this),function(){function e(e,t){Pusher.PrivateChannel.call(this,e,t),this.members=new Pusher.Members}var t=e.prototype;Pusher.Util.extend(t,Pusher.PrivateChannel.prototype),t.authorize=function(e,i){var r=this;Pusher.PrivateChannel.prototype.authorize.call(r,e,function(e,t){if(!e){if(void 0===t.channel_data)return Pusher.warn("Invalid auth response for channel '"+r.name+"', expected 'channel_data' field"),void i("Invalid auth response");var n=JSON.parse(t.channel_data);r.members.setMyID(n.user_id)}i(e,t)})},t.handleEvent=function(e,t){switch(e){case"pusher_internal:subscription_succeeded":this.members.onSubscription(t),this.subscribed=!0,this.emit("pusher:subscription_succeeded",this.members);break;case"pusher_internal:member_added":var n=this.members.addMember(t);this.emit("pusher:member_added",n);break;case"pusher_internal:member_removed":(n=this.members.removeMember(t))&&this.emit("pusher:member_removed",n);break;default:Pusher.PrivateChannel.prototype.handleEvent.call(this,e,t)}},t.disconnect=function(){this.members.reset(),Pusher.PrivateChannel.prototype.disconnect.call(this)},Pusher.PresenceChannel=e}.call(this),function(){function e(){this.channels={}}var t=e.prototype;t.add=function(e,t){if(!this.channels[e]){var n,i=this.channels;n=0===e.indexOf("private-")?new Pusher.PrivateChannel(e,t):0===e.indexOf("presence-")?new Pusher.PresenceChannel(e,t):new Pusher.Channel(e,t),i[e]=n}return this.channels[e]},t.all=function(e){return Pusher.Util.values(this.channels)},t.find=function(e){return this.channels[e]},t.remove=function(e){var t=this.channels[e];return delete this.channels[e],t},t.disconnect=function(){Pusher.Util.objectApply(this.channels,function(e){e.disconnect()})},Pusher.Channels=e}.call(this),function(){Pusher.Channel.Authorizer=function(e,t){this.channel=e,this.type=t.authTransport,this.options=t,this.authOptions=(t||{}).auth||{}},Pusher.Channel.Authorizer.prototype={composeQuery:function(e){for(var t in e="socket_id="+encodeURIComponent(e)+"&channel_name="+encodeURIComponent(this.channel.name),this.authOptions.params)e+="&"+encodeURIComponent(t)+"="+encodeURIComponent(this.authOptions.params[t]);return e},authorize:function(e,t){return Pusher.authorizers[this.type].call(this,e,t)}};var o=1;Pusher.auth_callbacks={},Pusher.authorizers={ajax:function(e,n){var i;for(var t in(i=Pusher.XHR?new Pusher.XHR:window.XMLHttpRequest?new window.XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP")).open("POST",this.options.authEndpoint,!0),i.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),this.authOptions.headers)i.setRequestHeader(t,this.authOptions.headers[t]);return i.onreadystatechange=function(){if(4===i.readyState)if(200===i.status){var e,t=!1;try{e=JSON.parse(i.responseText),t=!0}catch(e){n(!0,"JSON returned from webapp was invalid, yet status code was 200. Data was: "+i.responseText)}t&&n(!1,e)}else Pusher.warn("Couldn't get auth info from your webapp",i.status),n(!0,i.status)},i.send(this.composeQuery(e)),i},jsonp:function(e,t){void 0!==this.authOptions.headers&&Pusher.warn("Warn","To send headers with the auth request, you must use AJAX, rather than JSONP.");var n=o.toString();o++;var i=Pusher.Util.getDocument(),r=i.createElement("script");Pusher.auth_callbacks[n]=function(e){t(!1,e)},r.src=this.options.authEndpoint+"?callback="+encodeURIComponent("Pusher.auth_callbacks['"+n+"']")+"&"+this.composeQuery(e),(n=i.getElementsByTagName("head")[0]||i.documentElement).insertBefore(r,n.firstChild)}}}.call(this),Pusher}()}(this),function(e,t){e.PUBNUBVisitor=t()}(this,function(){return function(n){var i={};function r(e){if(i[e])return i[e].exports;var t=i[e]={exports:{},id:e,loaded:!1};return n[e].call(t.exports,t,t.exports,r),t.loaded=!0,t.exports}return r.m=n,r.c=i,r.p="",r(0)}([function(e,t,n){n(1);var o=n(2),i=n(3),r=n(4),h=n(5),s=n(8),d="PubNub-JS-Web/"+r.version;window.console||(window.console=window.console||{}),console.log||(console.log=console.error=(window.opera||{}).postError||function(){});var a=function(){var i={},e=!1;try{e=window.localStorage}catch(e){return}var n=function(e){return-1===document.cookie.indexOf(e)?null:((document.cookie||"").match(RegExp(e+"=([^;]+)"))||[])[1]||null},r=function(e,t){document.cookie=e+"="+t+"; expires=Thu, 1 Aug "+((new Date).getFullYear()+1)+" 20:00:00 UTC; path=/"},o=function(){try{return r("pnctest","1"),"1"===n("pnctest")}catch(e){return!1}}();return{get:function(t){try{return e?e.getItem(t):o?n(t):i[t]}catch(e){return i[t]}},set:function(t,n){try{if(e)return e.setItem(t,n)&&0;o&&r(t,n),i[t]=n}catch(e){i[t]=n}}}}();function c(e,t){return i.HmacSHA256(e,t).toString(i.enc.Base64)}function l(e){return document.getElementById(e)}function u(e){console.error(e)}function p(e,t){var n=[];return h.each(e.split(/\s+/),function(e){h.each((t||document).getElementsByTagName(e),function(e){n.push(e)})}),n}function f(e,n,i){h.each(e.split(","),function(e){var t=function(e){e||(e=window.event),i(e)||(e.cancelBubble=!0,e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation())};n.addEventListener?n.addEventListener(e,t,!1):n.attachEvent?n.attachEvent("on"+e,t):n["on"+e]=t})}function g(){return p("head")[0]}function m(e,t,n){if(!n)return e&&e.getAttribute&&e.getAttribute(t);e.setAttribute(t,n)}function v(e,t){for(var n in t)if(t.hasOwnProperty(n))try{e.style[n]=t[n]+(0<"|width|height|top|left|".indexOf(n)&&"number"==typeof t[n]?"px":"")}catch(e){return}}function y(e){return document.createElement(e)}var b={list:{},unbind:function(e){b.list[e]=[]},bind:function(e,t){(b.list[e]=b.list[e]||[]).push(t)},fire:function(e,t){h.each(b.list[e]||[],function(e){e(t)})}};function w(e){var n,i,r=0,t=0,o=e.timeout||h.DEF_TIMEOUT,s=e.data||{},a=e.fail||function(){},c=e.success||function(){},l=function(e,t){r||(r=1,clearTimeout(i),n&&(n.onerror=n.onload=null,n.abort&&n.abort(),n=null),e&&a(t))};i=h.timeout(function(){l(1)},o);try{(n="undefined"!=typeof XDomainRequest&&new XDomainRequest||new XMLHttpRequest).onerror=n.onabort=function(){l(1,n.responseText||{error:"Network Connection Error"})},n.onload=n.onloadend=function(){if(!t){var e;t=1,clearTimeout(i);try{e=JSON.parse(n.responseText)}catch(e){return l(1)}c(e)}},s.pnsdk=d;var u=h.build_url(e.url,s);n.open("GET",u,!0),n.timeout=o,n.send()}catch(e){l(1,{error:"XHR Failed",stacktrace:e})}return l}function C(){if(!("onLine"in navigator))return 1;try{return navigator.onLine}catch(e){return!0}}function _(e){return"sendBeacon"in navigator&&navigator.sendBeacon(e)}var k=function(e){var t=e.leave_on_unload||0;e.xdr=w,e.db=a,e.error=e.error||u,e._is_online=C,e.hmac_SHA256=c,e.crypto_obj=o(),e.sendBeacon=_,e.params={pnsdk:d};var n=function(e){return k(e)},i=h.PN_API(e);for(var r in i)i.hasOwnProperty(r)&&(n[r]=i[r]);return n.css=v,n.$=l,n.create=y,n.bind=f,n.head=g,n.search=p,n.attr=m,n.events=b,((n.init=n).secure=n).crypto_obj=o(),n.WS=s,n.PNmessage=h.PNmessage,n.supplant=h.supplant,f("beforeunload",window,function(){return t&&n["each-channel"](function(e){n.LEAVE(e.name,0)}),!0}),n.ready(),e.notest||(f("offline",window,n.offline),f("offline",document,n.offline)),n};((k.init=k).secure=k).crypto_obj=o(),k.WS=s,k.db=a,k.PNmessage=h.PNmessage,k.uuid=h.uuid,k.css=v,k.$=l,k.create=l,k.bind=f,k.head=g,k.search=p,k.attr=m,k.events=b,k.map=h.map,k.each=h.each,k.grep=h.grep,k.supplant=h.supplant,k.now=h.now,k.unique=h.unique,k.updater=h.updater,window.jQuery&&(window.jQuery.PUBNUBVisitor=k),e.exports=k},function(module,exports){(function(){window.JSON&&window.JSON.stringify||function(){function toJSON(e){try{return this.valueOf()}catch(e){return null}}window.JSON||(window.JSON={});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;function quote(e){return escapable.lastIndex=0,escapable.test(e)?'"'+e.replace(escapable,function(e){var t=meta[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function str(e,t){var n,i,r,o,s,a=gap,c=t[e];switch(c&&"object"==typeof c&&(c=toJSON.call(c,e)),"function"==typeof rep&&(c=rep.call(t,e,c)),typeof c){case"string":return quote(c);case"number":return isFinite(c)?String(c):"null";case"boolean":case"null":return String(c);case"object":if(!c)return"null";if(gap+=indent,s=[],"[object Array]"===Object.prototype.toString.apply(c)){for(o=c.length,n=0;n<o;n+=1)s[n]=str(n,c)||"null";return r=0===s.length?"[]":gap?"[\n"+gap+s.join(",\n"+gap)+"\n"+a+"]":"["+s.join(",")+"]",gap=a,r}if(rep&&"object"==typeof rep)for(o=rep.length,n=0;n<o;n+=1)"string"==typeof(i=rep[n])&&(r=str(i,c))&&s.push(quote(i)+(gap?": ":":")+r);else for(i in c)Object.hasOwnProperty.call(c,i)&&(r=str(i,c))&&s.push(quote(i)+(gap?": ":":")+r);return r=0===s.length?"{}":gap?"{\n"+gap+s.join(",\n"+gap)+"\n"+a+"}":"{"+s.join(",")+"}",gap=a,r}}"function"!=typeof JSON.stringify&&(JSON.stringify=function(e,t,n){var i;if(indent=gap="","number"==typeof n)for(i=0;i<n;i+=1)indent+=" ";else"string"==typeof n&&(indent=n);if((rep=t)&&"function"!=typeof t&&("object"!=typeof t||"number"!=typeof t.length))throw new Error("JSON.stringify");return str("",{"":e})}),"function"!=typeof JSON.parse&&(JSON.parse=function(text){return eval("("+text+")")})}()}).call(window)},function(e,t,n){var d=n(3);e.exports=function(){var t=["hex","utf8","base64","binary"],n=[128,256],i=["ecb","cbc"],r=!0,o="utf8",s=256,a="cbc";function c(e){return(e=e||{}).hasOwnProperty("encryptKey")||(e.encryptKey=r),e.hasOwnProperty("keyEncoding")||(e.keyEncoding=o),e.hasOwnProperty("keyLength")||(e.keyLength=s),e.hasOwnProperty("mode")||(e.mode=a),-1==t.indexOf(e.keyEncoding.toLowerCase())&&(e.keyEncoding=o),-1==n.indexOf(parseInt(e.keyLength,10))&&(e.keyLength=s),-1==i.indexOf(e.mode.toLowerCase())&&(e.mode=a),e}function l(e,t){var n,i,r;return n=e,e="base64"===(i=t).keyEncoding?d.enc.Base64.parse(n):"hex"===i.keyEncoding?d.enc.Hex.parse(n):n,t.encryptKey?d.enc.Utf8.parse((r=e,d.SHA256(r).toString(d.enc.Hex)).slice(0,32)):e}function u(e){return"ecb"===e.mode?d.mode.ECB:d.mode.CBC}function h(e){return"cbc"===e.mode?d.enc.Utf8.parse("0123456789012345"):null}return{encrypt:function(e,t,n){if(!t)return e;var i=h(n=c(n)),r=u(n),o=l(t,n),s=JSON.stringify(e);return d.AES.encrypt(s,o,{iv:i,mode:r}).ciphertext.toString(d.enc.Base64)||e},decrypt:function(e,t,n){if(!t)return e;var i=h(n=c(n)),r=u(n),o=l(t,n);try{var s=d.enc.Base64.parse(e),a=d.AES.decrypt({ciphertext:s},o,{iv:i,mode:r}).toString(d.enc.Utf8);return JSON.parse(a)}catch(e){return}}}}},function(e,t){var n,l,i,c,r,o,s,u,a,h,N=N||function(a,e){var t={},n=t.lib={},i=function(){},r=n.Base={extend:function(e){i.prototype=this;var t=new i;return e&&t.mixIn(e),t.hasOwnProperty("init")||(t.init=function(){t.$super.init.apply(this,arguments)}),(t.init.prototype=t).$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},c=n.WordArray=r.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:4*e.length},toString:function(e){return(e||s).stringify(this)},concat:function(e){var t=this.words,n=e.words,i=this.sigBytes;if(e=e.sigBytes,this.clamp(),i%4)for(var r=0;r<e;r++)t[i+r>>>2]|=(n[r>>>2]>>>24-r%4*8&255)<<24-(i+r)%4*8;else if(65535<n.length)for(r=0;r<e;r+=4)t[i+r>>>2]=n[r>>>2];else t.push.apply(t,n);return this.sigBytes+=e,this},clamp:function(){var e=this.words,t=this.sigBytes;e[t>>>2]&=4294967295<<32-t%4*8,e.length=a.ceil(t/4)},clone:function(){var e=r.clone.call(this);return e.words=this.words.slice(0),e},random:function(e){for(var t=[],n=0;n<e;n+=4)t.push(4294967296*a.random()|0);return new c.init(t,e)}}),o=t.enc={},s=o.Hex={stringify:function(e){var t=e.words;e=e.sigBytes;for(var n=[],i=0;i<e;i++){var r=t[i>>>2]>>>24-i%4*8&255;n.push((r>>>4).toString(16)),n.push((15&r).toString(16))}return n.join("")},parse:function(e){for(var t=e.length,n=[],i=0;i<t;i+=2)n[i>>>3]|=parseInt(e.substr(i,2),16)<<24-i%8*4;return new c.init(n,t/2)}},l=o.Latin1={stringify:function(e){var t=e.words;e=e.sigBytes;for(var n=[],i=0;i<e;i++)n.push(String.fromCharCode(t[i>>>2]>>>24-i%4*8&255));return n.join("")},parse:function(e){for(var t=e.length,n=[],i=0;i<t;i++)n[i>>>2]|=(255&e.charCodeAt(i))<<24-i%4*8;return new c.init(n,t)}},u=o.Utf8={stringify:function(e){try{return decodeURIComponent(escape(l.stringify(e)))}catch(e){throw Error("Malformed UTF-8 data")}},parse:function(e){return l.parse(unescape(encodeURIComponent(e)))}},h=n.BufferedBlockAlgorithm=r.extend({reset:function(){this._data=new c.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=u.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(e){var t=this._data,n=t.words,i=t.sigBytes,r=this.blockSize,o=i/(4*r);if(e=(o=e?a.ceil(o):a.max((0|o)-this._minBufferSize,0))*r,i=a.min(4*e,i),e){for(var s=0;s<e;s+=r)this._doProcessBlock(n,s);s=n.splice(0,e),t.sigBytes-=i}return new c.init(s,i)},clone:function(){var e=r.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0});n.Hasher=h.extend({cfg:r.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){h.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(n){return function(e,t){return new n.init(t).finalize(e)}},_createHmacHelper:function(n){return function(e,t){return new d.HMAC.init(n,t).finalize(e)}}});var d=t.algo={};return t}(Math);!function(r){for(var e=N,t=(i=e.lib).WordArray,n=i.Hasher,i=e.algo,o=[],f=[],s=function(e){return 4294967296*(e-(0|e))|0},a=2,c=0;c<64;){var l;e:{l=a;for(var u=r.sqrt(l),h=2;h<=u;h++)if(!(l%h)){l=!1;break e}l=!0}l&&(c<8&&(o[c]=s(r.pow(a,.5))),f[c]=s(r.pow(a,1/3)),c++),a++}var g=[];i=i.SHA256=n.extend({_doReset:function(){this._hash=new t.init(o.slice(0))},_doProcessBlock:function(e,t){for(var n=this._hash.words,i=n[0],r=n[1],o=n[2],s=n[3],a=n[4],c=n[5],l=n[6],u=n[7],h=0;h<64;h++){if(h<16)g[h]=0|e[t+h];else{var d=g[h-15],p=g[h-2];g[h]=((d<<25|d>>>7)^(d<<14|d>>>18)^d>>>3)+g[h-7]+((p<<15|p>>>17)^(p<<13|p>>>19)^p>>>10)+g[h-16]}d=u+((a<<26|a>>>6)^(a<<21|a>>>11)^(a<<7|a>>>25))+(a&c^~a&l)+f[h]+g[h],p=((i<<30|i>>>2)^(i<<19|i>>>13)^(i<<10|i>>>22))+(i&r^i&o^r&o),u=l,l=c,c=a,a=s+d|0,s=o,o=r,r=i,i=d+p|0}n[0]=n[0]+i|0,n[1]=n[1]+r|0,n[2]=n[2]+o|0,n[3]=n[3]+s|0,n[4]=n[4]+a|0,n[5]=n[5]+c|0,n[6]=n[6]+l|0,n[7]=n[7]+u|0},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,i=8*e.sigBytes;return t[i>>>5]|=128<<24-i%32,t[14+(i+64>>>9<<4)]=r.floor(n/4294967296),t[15+(i+64>>>9<<4)]=n,e.sigBytes=4*t.length,this._process(),this._hash},clone:function(){var e=n.clone.call(this);return e._hash=this._hash.clone(),e}});e.SHA256=n._createHelper(i),e.HmacSHA256=n._createHmacHelper(i)}(Math),l=(n=N).enc.Utf8,n.algo.HMAC=n.lib.Base.extend({init:function(e,t){e=this._hasher=new e.init,"string"==typeof t&&(t=l.parse(t));var n=e.blockSize,i=4*n;t.sigBytes>i&&(t=e.finalize(t)),t.clamp();for(var r=this._oKey=t.clone(),o=this._iKey=t.clone(),s=r.words,a=o.words,c=0;c<n;c++)s[c]^=1549556828,a[c]^=909522486;r.sigBytes=o.sigBytes=i,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher;return e=t.finalize(e),t.reset(),t.finalize(this._oKey.clone().concat(e))}}),c=(i=N).lib.WordArray,i.enc.Base64={stringify:function(e){var t=e.words,n=e.sigBytes,i=this._map;e.clamp(),e=[];for(var r=0;r<n;r+=3)for(var o=(t[r>>>2]>>>24-r%4*8&255)<<16|(t[r+1>>>2]>>>24-(r+1)%4*8&255)<<8|t[r+2>>>2]>>>24-(r+2)%4*8&255,s=0;s<4&&r+.75*s<n;s++)e.push(i.charAt(o>>>6*(3-s)&63));if(t=i.charAt(64))for(;e.length%4;)e.push(t);return e.join("")},parse:function(e){var t=e.length,n=this._map;(i=n.charAt(64))&&-1!=(i=e.indexOf(i))&&(t=i);for(var i=[],r=0,o=0;o<t;o++)if(o%4){var s=n.indexOf(e.charAt(o-1))<<o%4*2,a=n.indexOf(e.charAt(o))>>>6-o%4*2;i[r>>>2]|=(s|a)<<24-r%4*8,r++}return c.create(i,r)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},function(o){function k(e,t,n,i,r,o,s){return((e=e+(t&n|~t&i)+r+s)<<o|e>>>32-o)+t}function T(e,t,n,i,r,o,s){return((e=e+(t&i|n&~i)+r+s)<<o|e>>>32-o)+t}function S(e,t,n,i,r,o,s){return((e=e+(t^n^i)+r+s)<<o|e>>>32-o)+t}function x(e,t,n,i,r,o,s){return((e=e+(n^(t|~i))+r+s)<<o|e>>>32-o)+t}for(var e=N,t=(i=e.lib).WordArray,n=i.Hasher,i=e.algo,E=[],r=0;r<64;r++)E[r]=4294967296*o.abs(o.sin(r+1))|0;i=i.MD5=n.extend({_doReset:function(){this._hash=new t.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(e,t){for(var n=0;n<16;n++){var i=e[s=t+n];e[s]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8)}n=this._hash.words;var r,o,s=e[t+0],a=(i=e[t+1],e[t+2]),c=e[t+3],l=e[t+4],u=e[t+5],h=e[t+6],d=e[t+7],p=e[t+8],f=e[t+9],g=e[t+10],m=e[t+11],v=e[t+12],y=e[t+13],b=e[t+14],w=e[t+15],C=n[0],_=x(_=x(_=x(_=x(_=S(_=S(_=S(_=S(_=T(_=T(_=T(_=T(_=k(_=k(_=k(_=k(_=n[1],o=k(o=n[2],r=k(r=n[3],C=k(C,_,o,r,s,7,E[0]),_,o,i,12,E[1]),C,_,a,17,E[2]),r,C,c,22,E[3]),o=k(o,r=k(r,C=k(C,_,o,r,l,7,E[4]),_,o,u,12,E[5]),C,_,h,17,E[6]),r,C,d,22,E[7]),o=k(o,r=k(r,C=k(C,_,o,r,p,7,E[8]),_,o,f,12,E[9]),C,_,g,17,E[10]),r,C,m,22,E[11]),o=k(o,r=k(r,C=k(C,_,o,r,v,7,E[12]),_,o,y,12,E[13]),C,_,b,17,E[14]),r,C,w,22,E[15]),o=T(o,r=T(r,C=T(C,_,o,r,i,5,E[16]),_,o,h,9,E[17]),C,_,m,14,E[18]),r,C,s,20,E[19]),o=T(o,r=T(r,C=T(C,_,o,r,u,5,E[20]),_,o,g,9,E[21]),C,_,w,14,E[22]),r,C,l,20,E[23]),o=T(o,r=T(r,C=T(C,_,o,r,f,5,E[24]),_,o,b,9,E[25]),C,_,c,14,E[26]),r,C,p,20,E[27]),o=T(o,r=T(r,C=T(C,_,o,r,y,5,E[28]),_,o,a,9,E[29]),C,_,d,14,E[30]),r,C,v,20,E[31]),o=S(o,r=S(r,C=S(C,_,o,r,u,4,E[32]),_,o,p,11,E[33]),C,_,m,16,E[34]),r,C,b,23,E[35]),o=S(o,r=S(r,C=S(C,_,o,r,i,4,E[36]),_,o,l,11,E[37]),C,_,d,16,E[38]),r,C,g,23,E[39]),o=S(o,r=S(r,C=S(C,_,o,r,y,4,E[40]),_,o,s,11,E[41]),C,_,c,16,E[42]),r,C,h,23,E[43]),o=S(o,r=S(r,C=S(C,_,o,r,f,4,E[44]),_,o,v,11,E[45]),C,_,w,16,E[46]),r,C,a,23,E[47]),o=x(o,r=x(r,C=x(C,_,o,r,s,6,E[48]),_,o,d,10,E[49]),C,_,b,15,E[50]),r,C,u,21,E[51]),o=x(o,r=x(r,C=x(C,_,o,r,v,6,E[52]),_,o,c,10,E[53]),C,_,g,15,E[54]),r,C,i,21,E[55]),o=x(o,r=x(r,C=x(C,_,o,r,p,6,E[56]),_,o,w,10,E[57]),C,_,h,15,E[58]),r,C,y,21,E[59]),o=x(o,r=x(r,C=x(C,_,o,r,l,6,E[60]),_,o,m,10,E[61]),C,_,a,15,E[62]),r,C,f,21,E[63]);n[0]=n[0]+C|0,n[1]=n[1]+_|0,n[2]=n[2]+o|0,n[3]=n[3]+r|0},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,i=8*e.sigBytes;t[i>>>5]|=128<<24-i%32;var r=o.floor(n/4294967296);for(t[15+(i+64>>>9<<4)]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8),t[14+(i+64>>>9<<4)]=16711935&(n<<8|n>>>24)|4278255360&(n<<24|n>>>8),e.sigBytes=4*(t.length+1),this._process(),t=(e=this._hash).words,n=0;n<4;n++)i=t[n],t[n]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8);return e},clone:function(){var e=n.clone.call(this);return e._hash=this._hash.clone(),e}}),e.MD5=n._createHelper(i),e.HmacMD5=n._createHmacHelper(i)}(Math),s=(r=(o=N).lib).Base,u=r.WordArray,a=(r=o.algo).EvpKDF=s.extend({cfg:s.extend({keySize:4,hasher:r.MD5,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var n=(s=this.cfg).hasher.create(),i=u.create(),r=i.words,o=s.keySize,s=s.iterations;r.length<o;){a&&n.update(a);var a=n.update(e).finalize(t);n.reset();for(var c=1;c<s;c++)a=n.finalize(a),n.reset();i.concat(a)}return i.sigBytes=4*o,i}}),o.EvpKDF=function(e,t,n){return a.create(n).compute(e,t)},N.lib.Cipher||function(e){var t=(p=N).lib,n=t.Base,s=t.WordArray,i=t.BufferedBlockAlgorithm,r=p.enc.Base64,o=p.algo.EvpKDF,a=t.Cipher=i.extend({cfg:n.extend(),createEncryptor:function(e,t){return this.create(this._ENC_XFORM_MODE,e,t)},createDecryptor:function(e,t){return this.create(this._DEC_XFORM_MODE,e,t)},init:function(e,t,n){this.cfg=this.cfg.extend(n),this._xformMode=e,this._key=t,this.reset()},reset:function(){i.reset.call(this),this._doReset()},process:function(e){return this._append(e),this._process()},finalize:function(e){return e&&this._append(e),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(i){return{encrypt:function(e,t,n){return("string"==typeof t?f:d).encrypt(i,e,t,n)},decrypt:function(e,t,n){return("string"==typeof t?f:d).decrypt(i,e,t,n)}}}});t.StreamCipher=a.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var c=p.mode={},l=function(e,t,n){var i=this._iv;i?this._iv=void 0:i=this._prevBlock;for(var r=0;r<n;r++)e[t+r]^=i[r]},u=(t.BlockCipherMode=n.extend({createEncryptor:function(e,t){return this.Encryptor.create(e,t)},createDecryptor:function(e,t){return this.Decryptor.create(e,t)},init:function(e,t){this._cipher=e,this._iv=t}})).extend();u.Encryptor=u.extend({processBlock:function(e,t){var n=this._cipher,i=n.blockSize;l.call(this,e,t,i),n.encryptBlock(e,t),this._prevBlock=e.slice(t,t+i)}}),u.Decryptor=u.extend({processBlock:function(e,t){var n=this._cipher,i=n.blockSize,r=e.slice(t,t+i);n.decryptBlock(e,t),l.call(this,e,t,i),this._prevBlock=r}}),c=c.CBC=u,u=(p.pad={}).Pkcs7={pad:function(e,t){for(var n,i=(n=(n=4*t)-e.sigBytes%n)<<24|n<<16|n<<8|n,r=[],o=0;o<n;o+=4)r.push(i);n=s.create(r,n),e.concat(n)},unpad:function(e){e.sigBytes-=255&e.words[e.sigBytes-1>>>2]}},t.BlockCipher=a.extend({cfg:a.cfg.extend({mode:c,padding:u}),reset:function(){a.reset.call(this);var e=(t=this.cfg).iv,t=t.mode;if(this._xformMode==this._ENC_XFORM_MODE)var n=t.createEncryptor;else n=t.createDecryptor,this._minBufferSize=1;this._mode=n.call(t,this,e&&e.words)},_doProcessBlock:function(e,t){this._mode.processBlock(e,t)},_doFinalize:function(){var e=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){e.pad(this._data,this.blockSize);var t=this._process(!0)}else t=this._process(!0),e.unpad(t);return t},blockSize:4});var h=t.CipherParams=n.extend({init:function(e){this.mixIn(e)},toString:function(e){return(e||this.formatter).stringify(this)}}),d=(c=(p.format={}).OpenSSL={stringify:function(e){var t=e.ciphertext;return((e=e.salt)?s.create([1398893684,1701076831]).concat(e).concat(t):t).toString(r)},parse:function(e){var t=(e=r.parse(e)).words;if(1398893684==t[0]&&1701076831==t[1]){var n=s.create(t.slice(2,4));t.splice(0,4),e.sigBytes-=16}return h.create({ciphertext:e,salt:n})}},t.SerializableCipher=n.extend({cfg:n.extend({format:c}),encrypt:function(e,t,n,i){i=this.cfg.extend(i);var r=e.createEncryptor(n,i);return t=r.finalize(t),r=r.cfg,h.create({ciphertext:t,key:n,iv:r.iv,algorithm:e,mode:r.mode,padding:r.padding,blockSize:e.blockSize,formatter:i.format})},decrypt:function(e,t,n,i){return i=this.cfg.extend(i),t=this._parse(t,i.format),e.createDecryptor(n,i).finalize(t.ciphertext)},_parse:function(e,t){return"string"==typeof e?t.parse(e,this):e}})),p=(p.kdf={}).OpenSSL={execute:function(e,t,n,i){return i||(i=s.random(8)),e=o.create({keySize:t+n}).compute(e,i),n=s.create(e.words.slice(t),4*n),e.sigBytes=4*t,h.create({key:e,iv:n,salt:i})}},f=t.PasswordBasedCipher=d.extend({cfg:d.cfg.extend({kdf:p}),encrypt:function(e,t,n,i){return n=(i=this.cfg.extend(i)).kdf.execute(n,e.keySize,e.ivSize),i.iv=n.iv,(e=d.encrypt.call(this,e,t,n.key,i)).mixIn(n),e},decrypt:function(e,t,n,i){return i=this.cfg.extend(i),t=this._parse(t,i.format),n=i.kdf.execute(n,e.keySize,e.ivSize,t.salt),i.iv=n.iv,d.decrypt.call(this,e,t,n.key,i)}})}(),function(){for(var e=N,t=e.lib.BlockCipher,n=e.algo,s=[],i=[],r=[],o=[],a=[],c=[],l=[],u=[],h=[],d=[],p=[],f=0;f<256;f++)p[f]=f<128?f<<1:f<<1^283;var g=0,m=0;for(f=0;f<256;f++){var v=(v=m^m<<1^m<<2^m<<3^m<<4)>>>8^255&v^99;s[g]=v;var y=p[i[v]=g],b=p[y],w=p[b],C=257*p[v]^16843008*v;r[g]=C<<24|C>>>8,o[g]=C<<16|C>>>16,a[g]=C<<8|C>>>24,c[g]=C,C=16843009*w^65537*b^257*y^16843008*g,l[v]=C<<24|C>>>8,u[v]=C<<16|C>>>16,h[v]=C<<8|C>>>24,d[v]=C,g?(g=y^p[p[p[w^y]]],m^=p[p[m]]):g=m=1}var _=[0,1,2,4,8,16,32,64,128,27,54];n=n.AES=t.extend({_doReset:function(){for(var e=(n=this._key).words,t=n.sigBytes/4,n=4*((this._nRounds=t+6)+1),i=this._keySchedule=[],r=0;r<n;r++)if(r<t)i[r]=e[r];else{var o=i[r-1];r%t?6<t&&4==r%t&&(o=s[o>>>24]<<24|s[o>>>16&255]<<16|s[o>>>8&255]<<8|s[255&o]):(o=s[(o=o<<8|o>>>24)>>>24]<<24|s[o>>>16&255]<<16|s[o>>>8&255]<<8|s[255&o],o^=_[r/t|0]<<24),i[r]=i[r-t]^o}for(e=this._invKeySchedule=[],t=0;t<n;t++)r=n-t,o=t%4?i[r]:i[r-4],e[t]=t<4||r<=4?o:l[s[o>>>24]]^u[s[o>>>16&255]]^h[s[o>>>8&255]]^d[s[255&o]]},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._keySchedule,r,o,a,c,s)},decryptBlock:function(e,t){var n=e[t+1];e[t+1]=e[t+3],e[t+3]=n,this._doCryptBlock(e,t,this._invKeySchedule,l,u,h,d,i),n=e[t+1],e[t+1]=e[t+3],e[t+3]=n},_doCryptBlock:function(e,t,n,i,r,o,s,a){for(var c=this._nRounds,l=e[t]^n[0],u=e[t+1]^n[1],h=e[t+2]^n[2],d=e[t+3]^n[3],p=4,f=1;f<c;f++){var g=i[l>>>24]^r[u>>>16&255]^o[h>>>8&255]^s[255&d]^n[p++],m=i[u>>>24]^r[h>>>16&255]^o[d>>>8&255]^s[255&l]^n[p++],v=i[h>>>24]^r[d>>>16&255]^o[l>>>8&255]^s[255&u]^n[p++];d=i[d>>>24]^r[l>>>16&255]^o[u>>>8&255]^s[255&h]^n[p++],l=g,u=m,h=v}g=(a[l>>>24]<<24|a[u>>>16&255]<<16|a[h>>>8&255]<<8|a[255&d])^n[p++],m=(a[u>>>24]<<24|a[h>>>16&255]<<16|a[d>>>8&255]<<8|a[255&l])^n[p++],v=(a[h>>>24]<<24|a[d>>>16&255]<<16|a[l>>>8&255]<<8|a[255&u])^n[p++],d=(a[d>>>24]<<24|a[l>>>16&255]<<16|a[u>>>8&255]<<8|a[255&h])^n[p++],e[t]=g,e[t+1]=m,e[t+2]=v,e[t+3]=d},keySize:8});e.AES=t._createHelper(n)}(),N.mode.ECB=((h=N.lib.BlockCipherMode.extend()).Encryptor=h.extend({processBlock:function(e,t){this._cipher.encryptBlock(e,t)}}),h.Decryptor=h.extend({processBlock:function(e,t){this._cipher.decryptBlock(e,t)}}),h),e.exports=N},function(e,t){e.exports={name:"pubnub",preferGlobal:!1,version:"3.15.2",author:"PubNub <support@pubnub.com>",description:"Publish & Subscribe Real-time Messaging with PubNub",contributors:[{name:"Stephen Blum",email:"stephen@pubnub.com"}],bin:{},scripts:{test:"grunt test --force"},main:"./node.js/pubnub.js",browser:"./modern/dist/pubnub.js",repository:{type:"git",url:"git://github.com/pubnub/javascript.git"},keywords:["cloud","publish","subscribe","websockets","comet","bosh","xmpp","real-time","messaging"],dependencies:{agentkeepalive:"~0.2",lodash:"^4.1.0"},noAnalyze:!1,devDependencies:{chai:"^3.5.0",eslint:"2.4.0","eslint-config-airbnb":"^6.0.2","eslint-plugin-flowtype":"^2.1.0","eslint-plugin-mocha":"^2.0.0","eslint-plugin-react":"^4.1.0","flow-bin":"^0.22.0",grunt:"^0.4.5","grunt-contrib-clean":"^1.0.0","grunt-contrib-copy":"^0.8.2","grunt-contrib-uglify":"^0.11.1","grunt-env":"^0.4.4","grunt-eslint":"^18.0.0","grunt-flow":"^1.0.3","grunt-karma":"^0.12.1","grunt-mocha-istanbul":"^3.0.1","grunt-text-replace":"^0.4.0","grunt-webpack":"^1.0.11","imports-loader":"^0.6.5",isparta:"^4.0.0","json-loader":"^0.5.4",karma:"^0.13.21","karma-chai":"^0.1.0","karma-mocha":"^0.2.1","karma-phantomjs-launcher":"^1.0.0","karma-spec-reporter":"0.0.24","load-grunt-tasks":"^3.4.0",mocha:"^2.4.5",nock:"^1.1.0","node-uuid":"^1.4.7",nodeunit:"^0.9.0","phantomjs-prebuilt":"^2.1.4",proxyquire:"^1.7.4",sinon:"^1.17.2","uglify-js":"^2.6.1",underscore:"^1.7.0",webpack:"^1.12.13","webpack-dev-server":"^1.14.1"},bundleDependencies:[],license:"MIT",engine:{node:">=0.8"},files:["core","node.js","modern","CHANGELOG","FUTURE.md","LICENSE","README.md"]}},function(e,t,n){var i=n(4),r=n(6),de=n(7),o=1,pe=!1,fe=[],ge="-pnpres",me=1e3,ve=i.version;function ye(){return"x"+ ++o+ +new Date}var s,be=(s=Math.floor(20*Math.random()),function(e,t){return 0<e.indexOf("pubsub.")&&e.replace("pubsub","ps"+(t?de.generateUUID().split("-")[0]:++s<20?s:s=1))||e});function we(e,n){var i=[];return de.each(e,function(e,t){n?e.search("-pnpres")<0&&t.subscribed&&i.push(e):t.subscribed&&i.push(e)}),i.sort()}function Ce(e,n){var i=[];return de.each(e,function(e,t){n?e.search("-pnpres")<0&&t.subscribed&&i.push(e):t.subscribed&&i.push(e)}),i.sort()}function _e(){pe||(pe=1,de.each(fe,function(e){e()}))}e.exports={PN_API:function(e){var n,i,C=+e.windowing||10,_=(+e.timeout||310)*me,r=(+e.keepalive||60)*me,o=e.timecheck||0,d=e.noleave||0,g=e.publish_key,k=e.subscribe_key,T=e.auth_key||"",m=e.secret_key||"",v=e.hmac_SHA256,p=e.ssl?"s":"",S="http"+p+"://"+(e.origin||"pubsub.pubnub.com"),x=be(S),E=be(S),N=function(){},y=[],h=!0,P=0,A=0,O=0,I=0,M=e.restore||0,D=0,L=!1,B={},R={},j={},t=null,U=Y(e.heartbeat||e.pnexpires||0,e.error),s=e.heartbeat_interval||U/2-1,a=!1,c=e.no_wait_for_pending,f=e["compatible_3.5"]||!1,z=e.xdr,l=e.params||{},F=e.error||function(){},u=e._is_online||function(){return 1},V=e.jsonp_cb||function(){return 0},H=e.db||{get:function(){},set:function(){}},b=e.cipher_key,q=e.uuid||!e.unique_uuid&&H&&H.get(k+"uuid")||"",W=e.instance_id||!1,G="",w=e.shutdown,J=void 0===e.use_send_beacon||e.use_send_beacon?e.sendBeacon:null;2===U&&(s=1);var X=e.crypto_obj||{encrypt:function(e,t){return e},decrypt:function(e,t){return e}};function K(n){return n||(n={}),de.each(l,function(e,t){e in n||(n[e]=t)}),n}function $(e){return(t=e,n=[],de.each(t,function(e,t){n.push(e)}),n).sort();var t,n}function Q(e){var t="",n=$(e);for(var i in n){var r=n[i];t+=r+"="+de.pamEncode(e[r]),i!=n.length-1&&(t+="&")}return t}function Y(e,t,n){var i=!1;if(void 0===e)return t;if("number"==typeof e)i=!(5<e||0==e);else{if("boolean"==typeof e)return e?30:0;i=!0}return i?(n&&n("Presence Heartbeat value invalid. Valid range ( x > 5 or x = 0). Current Value : "+(t||5)),t||5):e}function Z(e,t){return X.encrypt(e,t||b)||e}function ee(e,t){return X.decrypt(e,t||b)||X.decrypt(e,b)||e}function te(){clearTimeout(t),!s||500<=s||s<1||!we(B,!0).length&&!Ce(R,!0).length?a=!1:(a=!0,le.presence_heartbeat({callback:function(e){t=de.timeout(te,s*me)},error:function(e){F&&F("Presence Heartbeat unable to reach Pubnub servers."+JSON.stringify(e)),t=de.timeout(te,s*me)}}))}function ne(){!a&&te()}function ie(e){if(c){if(!y.length)return}else{if(e&&(y.sending=0),y.sending||!y.length)return;y.sending=1}z(y.shift())}function re(n){var i=0;return de.each(Ce(R),function(e){var t=R[e];t&&(i++,(n||function(){})(t))}),i}function oe(n){var i=0;return de.each(we(B),function(e){var t=B[e];t&&(i++,(n||function(){})(t))}),i}function se(e,t,n){if("object"==typeof e){if(e.error){var i={};return e.message&&(i.message=e.message),e.payload&&(i.payload=e.payload),void(n&&n(i))}if(e.payload)return void(e.next_page?t&&t(e.payload,e.next_page):t&&t(e.payload))}t&&t(e)}function ae(e,t){if("object"==typeof e&&e.error){var n={};return e.message&&(n.message=e.message),e.payload&&(n.payload=e.payload),void(t&&t(n))}t&&t(e)}function ce(e,t,n,i){t=e.callback||t;var r=e.error||F,o=V();(i=i||{}).auth||(i.auth=e.auth_key||T);var s=[x,"v1","channel-registration","sub-key",k];s.push.apply(s,n),o&&(i.callback=o),z({callback:o,data:K(i),success:function(e){se(e,t,r)},fail:function(e){ae(e,r)},url:s})}var le={LEAVE:function(e,t,n,i,r){var o,s,a={uuid:q,auth:n||T},c=be(S),l=(i=i||function(){},r||function(){}),u=V();if(0<e.indexOf(ge))return!0;if(f){if(!p)return!1;if("0"==u)return!1}if(d)return!1;if("0"!=u&&(a.callback=u),W&&(a.instanceid=G),o=[c,"v2","presence","sub_key",k,"channel",de.encode(e),"leave"],s=K(a),J){var h=de.buildURL(o,s);if(J(h))return i&&i({status:200,action:"leave",message:"OK",service:"Presence"}),!0}return z({blocking:t||p,callback:u,data:s,success:function(e){se(e,i,l)},fail:function(e){ae(e,l)},url:o}),!0},LEAVE_GROUP:function(e,t,n,i,r){var o,s,a={uuid:q,auth:n||T},c=be(S),l=(i=i||function(){},r||function(){}),u=V();if(0<e.indexOf(ge))return!0;if(f){if(!p)return!1;if("0"==u)return!1}if(d)return!1;if("0"!=u&&(a.callback=u),e&&0<e.length&&(a["channel-group"]=e),W&&(a.instanceid=G),o=[c,"v2","presence","sub_key",k,"channel",de.encode(","),"leave"],s=K(a),J){var h=de.buildURL(o,s);if(J(h))return i&&i({status:200,action:"leave",message:"OK",service:"Presence"}),!0}return z({blocking:t||p,callback:u,data:s,success:function(e){se(e,i,l)},fail:function(e){ae(e,l)},url:o}),!0},set_resumed:function(e){L=e},get_cipher_key:function(){return b},set_cipher_key:function(e){b=e},raw_encrypt:function(e,t){return Z(e,t)},raw_decrypt:function(e,t){return ee(e,t)},get_heartbeat:function(){return U},set_heartbeat:function(e,t){U=Y(e,U,F),s=t||U/2-1,2==U&&(s=1),N(),te()},get_heartbeat_interval:function(){return s},set_heartbeat_interval:function(e){s=e,te()},get_version:function(){return ve},getGcmMessageObject:function(e){return{data:e}},getApnsMessageObject:function(e){var t={aps:{badge:1,alert:""}};for(var n in e)n[t]=e[n];return t},_add_param:function(e,t){l[e]=t},channel_group:function(e,t){var n,i,r=e.channel_group,o=(t=t||e.callback,e.channels||e.channel),s=e.cloak,a=[],c={},l=e.mode||"add";if(r){var u=r.split(":");i=1<u.length?(n="*"===u[0]?null:u[0],u[1]):u[0]}n&&a.push("namespace")&&a.push(de.encode(n)),a.push("channel-group"),i&&"*"!==i&&a.push(i),o?(de.isArray(o)&&(o=o.join(",")),c[l]=o,c.cloak=h?"true":"false"):"remove"===l&&a.push("remove"),void 0!==s&&(c.cloak=s?"true":"false"),ce(e,t,a,c)},channel_group_list_groups:function(e,t){var n;(n=e.namespace||e.ns||e.channel_group||null)&&(e.channel_group=n+":*"),le.channel_group(e,t)},channel_group_list_channels:function(e,t){if(!e.channel_group)return F("Missing Channel Group");le.channel_group(e,t)},channel_group_remove_channel:function(e,t){return e.channel_group?e.channel||e.channels?(e.mode="remove",void le.channel_group(e,t)):F("Missing Channel"):F("Missing Channel Group")},channel_group_remove_group:function(e,t){return e.channel_group?e.channel?F("Use channel_group_remove_channel if you want to remove a channel from a group."):(e.mode="remove",void le.channel_group(e,t)):F("Missing Channel Group")},channel_group_add_channel:function(e,t){return e.channel_group?e.channel||e.channels?void le.channel_group(e,t):F("Missing Channel"):F("Missing Channel Group")},channel_group_cloak:function(e,t){void 0!==e.cloak?(h=e.cloak,le.channel_group(e,t)):t(h)},channel_group_list_namespaces:function(e,t){ce(e,t,["namespace"])},channel_group_remove_namespace:function(e,t){ce(e,t,["namespace",e.namespace,"remove"])},history:function(e,s){s=e.callback||s;var t=e.count||e.limit||100,n=e.reverse||"false",a=e.error||function(){},i=e.auth_key||T,c=e.cipher_key,r=e.channel,o=e.channel_group,l=e.start,u=e.end,h=e.include_token,d=e.string_message_token||!1,p={},f=V();return r||o?s?k?(p.stringtoken="true",p.count=t,p.reverse=n,p.auth=i,o&&(p["channel-group"]=o,r||(r=",")),f&&(p.callback=f),l&&(p.start=l),u&&(p.end=u),h&&(p.include_token="true"),d&&(p.string_message_token="true"),void z({callback:f,data:K(p),success:function(e){if("object"==typeof e&&e.error)a({message:e.message,payload:e.payload});else{for(var t=e[0],n=[],i=0;i<t.length;i++)if(h){var r=ee(t[i].message,c),o=t[i].timetoken;try{n.push({message:JSON.parse(r),timetoken:o})}catch(e){n.push({message:r,timetoken:o})}}else{r=ee(t[i],c);try{n.push(JSON.parse(r))}catch(e){n.push(r)}}s([n,e[1],e[2]])}},fail:function(e){ae(e,a)},url:[x,"v2","history","sub-key",k,"channel",de.encode(r)]})):F("Missing Subscribe Key"):F("Missing Callback"):F("Missing Channel")},replay:function(e,t){t=t||e.callback||function(){};var n=e.auth_key||T,i=e.source,r=e.destination,o=e.error||e.error||function(){},s=e.stop,a=e.start,c=e.end,l=e.reverse,u=e.limit,h=V(),d={};return i?r?g?k?("0"!=h&&(d.callback=h),s&&(d.stop="all"),l&&(d.reverse="true"),a&&(d.start=a),c&&(d.end=c),u&&(d.count=u),d.auth=n,void z({callback:h,success:function(e){se(e,t,o)},fail:function(){t([0,"Disconnected"])},url:[x,"v1","replay",g,k,i,r],data:K(d)})):F("Missing Subscribe Key"):F("Missing Publish Key"):F("Missing Destination Channel"):F("Missing Source Channel")},auth:function(e){T=e,N()},time:function(t){var e=V(),n={uuid:q,auth:T};W&&(n.instanceid=G),z({callback:e,data:K(n),url:[x,"time",e],success:function(e){t(e[0])},fail:function(){t(0)}})},publish:function(e,t){var n=e.message;if(!n)return F("Missing Message");t=t||e.callback||n.callback||e.success||function(){};var i,r,o=e.channel||n.channel,s=e.meta||e.metadata,a=e.auth_key||T,c=e.cipher_key,l=e.error||n.error||function(){},u=e.post||!1,h=!("store_in_history"in e)||e.store_in_history,d=!("replicate"in e)||e.replicate,p=V(),f="push";return e.prepend&&(f="unshift"),o?g?k?(n.getPubnubMessage&&(n=n.getPubnubMessage()),n=JSON.stringify(Z(n,c)),r=[x,"publish",g,k,0,de.encode(o),p,de.encode(n)],i={uuid:q,auth:a},s&&"object"==typeof s&&(i.meta=JSON.stringify(s)),h||(i.store="0"),d||(i.norep="true"),W&&(i.instanceid=G),y[f]({callback:p,url:r,data:K(i),fail:function(e){ae(e,l),ie(1)},success:function(e){se(e,t,l),ie(1)},mode:u?"POST":"GET"}),void ie()):F("Missing Subscribe Key"):F("Missing Publish Key"):F("Missing Channel")},fire:function(e,t){e.store_in_history=!1,e.replicate=!1,le.publish(e,t)},unsubscribe:function(e,t){var n=e.channel,i=e.channel_group,r=e.auth_key||T,o=(t=t||e.callback||function(){},e.error||function(){});if(!n&&!i)return F("Missing Channel or Channel Group");if(!k)return F("Missing Subscribe Key");if(n){var s=de.isArray(n)?n:(""+n).split(","),a=[],c=[];if(de.each(s,function(e){B[e]&&a.push(e)}),0==a.length)return void t({action:"leave"});de.each(a,function(e){c.push(e+ge)}),de.each(a.concat(c),function(e){e in B&&delete B[e],e in j&&delete j[e]}),0===B.length&&0===R.length&&(D=0);var l=!0;pe&&(l=le.LEAVE(a.join(","),0,r,t,o)),l||t({action:"leave"})}if(i){var u=de.isArray(i)?i:(""+i).split(","),h=[],d=[];if(de.each(u,function(e){R[e]&&h.push(e)}),0==h.length)return void t({action:"leave"});de.each(h,function(e){d.push(e+ge)}),de.each(h.concat(d),function(e){e in R&&delete R[e],e in j&&delete j[e]}),0===B.length&&0===R.length&&(D=0),l=!0,pe&&(l=le.LEAVE_GROUP(h.join(","),0,r,t,o)),l||t({action:"leave"})}N()},subscribe:function(t,i){var e=t.channel,n=t.channel_group,r=(i=(i=i||t.callback)||t.message,t.connect||function(){}),o=t.reconnect||function(){},s=t.disconnect||function(){},a=t.error||a||function(){},c=t.idle||function(){},l=t.presence||0,u=t.noheresync||0,h=t.backfill||0,d=t.timetoken||0,p=t.timeout||_,f=t.windowing||C,g=t.state,m=t.heartbeat||t.pnexpires,v=t.heartbeat_interval,y=t.restore||M;if(T=t.auth_key||T,M=y,D=d,!e&&!n)return F("Missing Channel");if(!i)return F("Missing Callback");if(!k)return F("Missing Subscribe Key");function b(t){t?de.timeout(N,f):(x=be(S,1),E=be(S,1),de.timeout(function(){le.time(b)},me)),oe(function(e){if(t&&e.disconnected)return e.disconnected=0,e.reconnect(e.name);t||e.disconnected||(e.disconnected=1,e.disconnect(e.name))}),re(function(e){if(t&&e.disconnected)return e.disconnected=0,e.reconnect(e.name);t||e.disconnected||(e.disconnected=1,e.disconnect(e.name))})}function w(){var e=V(),t=we(B).join(","),n=Ce(R).join(",");if(t||n){t||(t=","),ue();var i=K({uuid:q,auth:T});n&&(i["channel-group"]=n),2<JSON.stringify(j).length&&(i.state=JSON.stringify(j)),U&&(i.heartbeat=U),W&&(i.instanceid=G),ne(),I=z({timeout:p,callback:e,fail:function(t){t&&t.error&&t.service?(ae(t,a),b(!1)):le.time(function(e){!e&&ae(t,a),b(e)})},data:K(i),url:[E,"subscribe",k,de.encode(t),e,D],success:function(o){if(!o||"object"==typeof o&&"error"in o&&o.error)return a(o),de.timeout(N,me);if(c(o[1]),D=!D&&M&&H.get(k)||o[1],oe(function(e){e.connected||(e.connected=1,e.connect(e.name))}),re(function(e){e.connected||(e.connected=1,e.connect(e.name))}),L&&!M)return D=0,L=!1,H.set(k,0),void de.timeout(w,f);h&&(D=1e4,h=0),H.set(k,o[1]);var e,i=function(){var e="",t="";3<o.length?(e=o[3],t=o[2]):e=2<o.length?o[2]:de.map(we(B),function(e){return de.map(Array(o[0].length).join(",").split(","),function(){return e})}).join(",");var i=e.split(","),r=t?t.split(","):[];return function(){var e=i.shift()||O,t=r.shift(),n=[(t?(e&&0<=e.indexOf("-pnpres")&&t.indexOf("-pnpres")<0&&(t+="-pnpres"),R[t]||B[t]||{callback:function(){}}):B[e]).callback||A,e.split(ge)[0]];return t&&n.push(t.split(ge)[0]),n}}(),r=(e=+o[1],de.rnow()-P-e/1e4);de.each(o[0],function(e){var t=i(),n=ee(e,B[t[1]]?B[t[1]].cipher_key:null);t[0]&&t[0](n,o,t[2]||t[1],r,t[1])}),de.timeout(w,f)}})}}if((m||0===m||v||0===v)&&le.set_heartbeat(m,v),e&&de.each((e.join?e.join(","):""+e).split(","),function(n){var e=B[n]||{};B[O=n]={name:n,connected:e.connected,disconnected:e.disconnected,subscribed:1,callback:A=i,cipher_key:t.cipher_key,connect:r,disconnect:s,reconnect:o},g&&(j[n]=n in g?g[n]:g),l&&(le.subscribe({channel:n+ge,callback:l,restore:y}),e.subscribed||u||le.here_now({channel:n,data:K({uuid:q,auth:T}),callback:function(t){de.each("uuids"in t?t.uuids:[],function(e){l({action:"join",uuid:e,timestamp:Math.floor(de.rnow()/1e3),occupancy:t.occupancy||1},t,n)})}}))}),n&&de.each((n.join?n.join(","):""+n).split(","),function(n){var e=R[n]||{};R[n]={name:n,connected:e.connected,disconnected:e.disconnected,subscribed:1,callback:A=i,cipher_key:t.cipher_key,connect:r,disconnect:s,reconnect:o},l&&(le.subscribe({channel_group:n+ge,callback:l,restore:y,auth_key:T}),e.subscribed||u||le.here_now({channel_group:n,data:K({uuid:q,auth:T}),callback:function(t){de.each("uuids"in t?t.uuids:[],function(e){l({action:"join",uuid:e,timestamp:Math.floor(de.rnow()/1e3),occupancy:t.occupancy||1},t,n)})}}))}),N=function(){ue(),de.timeout(w,f)},!pe)return fe.push(N);N()},here_now:function(e,t){t=e.callback||t;var n=e.debug,i=e.error||function(){},r=e.auth_key||T,o=e.channel,s=e.channel_group,a=V(),c=!("uuids"in e)||e.uuids,l=e.state,u={uuid:q,auth:r};if(c||(u.disable_uuids=1),l&&(u.state=1),!t)return F("Missing Callback");if(!k)return F("Missing Subscribe Key");var h=[x,"v2","presence","sub_key",k];o&&h.push("channel")&&h.push(de.encode(o)),"0"!=a&&(u.callback=a),s&&(u["channel-group"]=s,!o&&h.push("channel")&&h.push(",")),W&&(u.instanceid=G),z({callback:a,data:K(u),success:function(e){se(e,t,i)},fail:function(e){ae(e,i)},debug:n,url:h})},where_now:function(e,t){t=e.callback||t;var n=e.error||function(){},i=e.auth_key||T,r=V(),o=e.uuid||q,s={auth:i};return t?k?("0"!=r&&(s.callback=r),W&&(s.instanceid=G),void z({callback:r,data:K(s),success:function(e){se(e,t,n)},fail:function(e){ae(e,n)},url:[x,"v2","presence","sub_key",k,"uuid",de.encode(o)]})):F("Missing Subscribe Key"):F("Missing Callback")},state:function(e,t){t=e.callback||t||function(e){};var n,i=e.error||function(){},r=e.auth_key||T,o=V(),s=e.state,a=e.uuid||q,c=e.channel,l=e.channel_group,u=K({auth:r});return k?a?c||l?("0"!=o&&(u.callback=o),void 0!==c&&B[c]&&B[c].subscribed&&s&&(j[c]=s),void 0!==l&&R[l]&&R[l].subscribed&&(s&&(j[l]=s),u["channel-group"]=l,c||(c=",")),u.state=JSON.stringify(s),W&&(u.instanceid=G),n=s?[x,"v2","presence","sub-key",k,"channel",c,"uuid",a,"data"]:[x,"v2","presence","sub-key",k,"channel",c,"uuid",de.encode(a)],void z({callback:o,data:K(u),success:function(e){se(e,t,i)},fail:function(e){ae(e,i)},url:n})):F("Missing Channel"):F("Missing UUID"):F("Missing Subscribe Key")},grant:function(e,t){t=e.callback||t;var n=e.error||function(){},i=e.channel||e.channels,r=e.channel_group,o=V(),s=e.ttl,a=e.read?"1":"0",c=e.write?"1":"0",l=e.manage?"1":"0",u=e.auth_key||e.auth_keys;if(!t)return F("Missing Callback");if(!k)return F("Missing Subscribe Key");if(!g)return F("Missing Publish Key");if(!m)return F("Missing Secret Key");var h=Math.floor((new Date).getTime()/1e3),d=k+"\n"+g+"\ngrant\n",p={w:c,r:a,timestamp:h};e.manage&&(p.m=l),de.isArray(i)&&(i=i.join(",")),de.isArray(u)&&(u=u.join(",")),void 0!==i&&null!=i&&0<i.length&&(p.channel=i),void 0!==r&&null!=r&&0<r.length&&(p["channel-group"]=r),"0"!=o&&(p.callback=o),(s||0===s)&&(p.ttl=s),u&&(p.auth=u),p=K(p),u||delete p.auth,d+=Q(p);var f=v(d,m);f=(f=f.replace(/\+/g,"-")).replace(/\//g,"_"),p.signature=f,z({callback:o,data:p,success:function(e){se(e,t,n)},fail:function(e){ae(e,n)},url:[x,"v1","auth","grant","sub-key",k]})},mobile_gw_provision:function(e){var t,n,i=e.callback||function(){},r=e.auth_key||T,o=e.error||function(){},s=V(),a=e.channel,c=e.op,l=e.gw_type,u=e.device_id;return u?l?c?a?k?(n=[x,"v1/push/sub-key",k,"devices",u],t={uuid:q,auth:r,type:l},"add"==c?t.add=a:"remove"==c&&(t.remove=a),W&&(t.instanceid=G),void z({callback:s,data:t,success:function(e){se(e,i,o)},fail:function(e){ae(e,o)},url:n})):F("Missing Subscribe Key"):F("Missing gw destination Channel (channel)"):F("Missing GW Operation (op: add or remove)"):F("Missing GW Type (gw_type: gcm or apns)"):F("Missing Device ID (device_id)")},audit:function(e,t){t=e.callback||t;var n=e.error||function(){},i=e.channel,r=e.channel_group,o=e.auth_key,s=V();if(!t)return F("Missing Callback");if(!k)return F("Missing Subscribe Key");if(!g)return F("Missing Publish Key");if(!m)return F("Missing Secret Key");var a=Math.floor((new Date).getTime()/1e3),c=k+"\n"+g+"\naudit\n",l={timestamp:a};"0"!=s&&(l.callback=s),void 0!==i&&null!=i&&0<i.length&&(l.channel=i),void 0!==r&&null!=r&&0<r.length&&(l["channel-group"]=r),o&&(l.auth=o),l=K(l),o||delete l.auth,c+=Q(l);var u=v(c,m);u=(u=u.replace(/\+/g,"-")).replace(/\//g,"_"),l.signature=u,z({callback:s,data:l,success:function(e){se(e,t,n)},fail:function(e){ae(e,n)},url:[x,"v1","auth","audit","sub-key",k]})},revoke:function(e,t){e.read=!1,e.write=!1,le.grant(e,t)},set_uuid:function(e){q=e,N()},get_uuid:function(){return q},isArray:function(e){return de.isArray(e)},get_subscribed_channels:function(){return we(B,!0)},presence_heartbeat:function(e){var t=e.callback||function(){},n=e.error||function(){},i=V(),r={uuid:q,auth:T};2<JSON.stringify(j).length&&(r.state=JSON.stringify(j)),0<U&&U<320&&(r.heartbeat=U),"0"!=i&&(r.callback=i);var o=de.encode(we(B,!0).join(",")),s=Ce(R,!0).join(",");o||(o=","),s&&(r["channel-group"]=s),W&&(r.instanceid=G),z({callback:i,data:K(r),url:[x,"v2","presence","sub-key",k,"channel",o,"heartbeat"],success:function(e){se(e,t,n)},fail:function(e){ae(e,n)}})},stop_timers:function(){clearTimeout(n),clearTimeout(i),clearTimeout(t)},shutdown:function(){le.stop_timers(),w&&w()},xdr:z,ready:_e,db:H,uuid:de.generateUUID,map:de.map,each:de.each,"each-channel":oe,grep:de.grep,offline:function(){ue(1,{message:"Offline. Please check your network settings."})},supplant:de.supplant,now:de.rnow,unique:ye,updater:de.updater};function ue(e,t){I&&I(e,t),I=null,clearTimeout(n),clearTimeout(i)}function he(i,e){var r=de.rnow();function t(e){if(e){var t=e/1e4,n=(de.rnow()-r)/2;P=de.rnow()-(t+n),i&&i(P)}}e&&t(e)||le.time(t)}return q||(q=le.uuid()),G||(G=le.uuid()),H.set(k+"uuid",q),n=de.timeout(function e(){u()||ue(1,{error:"Offline. Please check your network settings."}),n&&clearTimeout(n),n=de.timeout(e,me)},me),i=de.timeout(function t(){o&&le.time(function(e){he(function(){},e),e||ue(1,{error:"Heartbeat failed to connect to Pubnub Servers.Please check your network settings."}),i&&clearTimeout(i),i=de.timeout(t,r)})},r),t=de.timeout(ne,(s-3)*me),he(),le},unique:ye,PNmessage:function(e){var r=e||{apns:{}};return r.getPubnubMessage=function(){var e={};if(Object.keys(r.apns).length){for(var t in e.pn_apns={aps:{alert:r.apns.alert,badge:r.apns.badge}},r.apns)e.pn_apns[t]=r.apns[t];var n=["badge","alert"];for(var t in n)delete e.pn_apns[n[t]]}for(var t in r.gcm&&(e.pn_gcm={data:r.gcm}),r)e[t]=r[t];var i=["apns","gcm","publish","channel","callback","error"];for(var t in i)delete e[i[t]];return e},r.publish=function(){var e=r.getPubnubMessage();r.pubnub&&r.channel&&r.pubnub.publish({message:e,channel:r.channel,callback:r.callback,error:r.error})},r},DEF_TIMEOUT:15e3,timeout:de.timeout,build_url:de.buildURL,each:de.each,uuid:de.generateUUID,URLBIT:r.URLBIT,grep:de.grep,supplant:de.supplant,now:de.rnow,updater:de.updater,map:de.map}},function(e,t){e.exports={PARAMSBIT:"&",URLBIT:"/"}},function(e,t,n){var r=n(6),i=/{([\w\-]+)}/g;function o(){return+new Date}function s(e){return!!e&&"string"!=typeof e&&(Array.isArray&&Array.isArray(e)||"number"==typeof e.length)}function a(e,t){if(e&&t)if(s(e))for(var n=0,i=e.length;n<i;)t.call(e[n],e[n],n++);else for(var n in e)e.hasOwnProperty&&e.hasOwnProperty(n)&&t.call(e[n],n,e[n])}function c(e){return encodeURIComponent(e)}e.exports={buildURL:function(e,t){var n=e.join(r.URLBIT),i=[];return t?(a(t,function(e,t){var n="object"==typeof t?JSON.stringify(t):t;null!=t&&0<c(n).length&&i.push(e+"="+c(n))}),n+="?"+i.join(r.PARAMSBIT)):n},encode:c,each:a,updater:function(e,t){var n,i=0,r=function(){i+t>o()?(clearTimeout(n),n=setTimeout(r,t)):(i=o(),e())};return r},rnow:o,isArray:s,map:function(e,n){var i=[];return a(e||[],function(e,t){i.push(n(e,t))}),i},pamEncode:function(e){return encodeURIComponent(e).replace(/[!'()*~]/g,function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()})},generateUUID:function(e){var t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)});return e&&e(t),t},timeout:function(e,t){if("undefined"!=typeof setTimeout)return setTimeout(e,t)},supplant:function(e,n){return e.replace(i,function(e,t){return n[t]||e})},grep:function(e,t){var n=[];return a(e||[],function(e){t(e)&&n.push(e)}),n}}},function(e,t){var o=function(e,t){if(!(this instanceof o))return new o(e,t);var n=this,i=(e=n.url=e||"",n.protocol=t||"Sec-WebSocket-Protocol",e.split("/")),r={ssl:"wss:"===i[0],origin:i[2],publish_key:i[3],subscribe_key:i[4],channel:i[5]};if(n.CONNECTING=0,n.OPEN=1,n.CLOSING=2,n.CLOSED=3,n.CLOSE_NORMAL=1e3,n.CLOSE_GOING_AWAY=1001,n.CLOSE_PROTOCOL_ERROR=1002,n.CLOSE_UNSUPPORTED=1003,n.CLOSE_TOO_LARGE=1004,n.CLOSE_NO_STATUS=1005,n.CLOSE_ABNORMAL=1006,n.onclose=n.onerror=n.onmessage=n.onopen=n.onsend=function(){},n.binaryType="",n.extensions="",n.bufferedAmount=0,n.trasnmitting=!1,n.buffer=[],n.readyState=n.CONNECTING,!e)return n.readyState=n.CLOSED,n.onclose({code:n.CLOSE_ABNORMAL,reason:"Missing URL",wasClean:!0}),n;n.pubnub=PUBNUBVisitor.init(r),n.pubnub.setup=r,n.setup=r,n.pubnub.subscribe({restore:!1,channel:r.channel,disconnect:n.onerror,reconnect:n.onopen,error:function(){n.onclose({code:n.CLOSE_ABNORMAL,reason:"Missing URL",wasClean:!1})},callback:function(e){n.onmessage({data:e})},connect:function(){n.readyState=n.OPEN,n.onopen()}})};o.prototype.send=function(e){var t=this;t.pubnub.publish({channel:t.pubnub.setup.channel,message:e,callback:function(e){t.onsend({data:e})}})},o.prototype.close=function(){var e=this;e.pubnub.unsubscribe({channel:e.pubnub.setup.channel}),e.readyState=e.CLOSED,e.onclose({})},e.exports=o}])}),!jsonStringify){var jsonStringify=JSON.stringify;JSON.stringify=function(){var e=Array.prototype.toJSON;delete Array.prototype.toJSON;var t=jsonStringify.apply(this,arguments);return Object.defineProperty(Array.prototype,"toJSON",{enumerable:!1,value:e,configurable:!0}),t}}function AbstractChannel(){this.constructor.apply(this,arguments)}!function(I,M){var D=I.document,L=I.navigator,e=I.location,x=function(){var n,e,t,i,h=function(e,t){return new h.fn.init(e,t,n)},r=I.jQuery,o=I.$,a=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,s=/\S/,c=/^\s+/,l=/\s+$/,u=/^<(\w+)\s*\/?>(?:<\/\1>)?$/,d=/^[\],:{}\s]*$/,p=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,f=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,g=/(?:^|:|,)(?:\s*\[)+/g,m=/(webkit)[ \/]([\w.]+)/,v=/(opera)(?:.*version)?[ \/]([\w.]+)/,y=/(msie) ([\w.]+)/,b=/(mozilla)(?:.*? rv:([\w.]+))?/,w=/-([a-z]|[0-9])/gi,C=/^-ms-/,_=function(e,t){return(t+"").toUpperCase()},k=L.userAgent,T=Object.prototype.toString,S=Object.prototype.hasOwnProperty,x=Array.prototype.push,E=Array.prototype.slice,N=String.prototype.trim,P=Array.prototype.indexOf,A={};function O(){if(!h.isReady){try{D.documentElement.doScroll("left")}catch(e){return void setTimeout(O,1)}h.ready()}}return h.fn=h.prototype={constructor:h,init:function(e,t,n){var i,r,o,s;if(!e)return this;if(e.nodeType)return this.context=this[0]=e,this.length=1,this;if("body"===e&&!t&&D.body)return this.context=D,this[0]=D.body,this.selector=e,this.length=1,this;if("string"!=typeof e)return h.isFunction(e)?n.ready(e):(e.selector!==M&&(this.selector=e.selector,this.context=e.context),h.makeArray(e,this));if(!(i="<"===e.charAt(0)&&">"===e.charAt(e.length-1)&&3<=e.length?[null,e,null]:a.exec(e))||!i[1]&&t)return!t||t.jquery?(t||n).find(e):this.constructor(t).find(e);if(i[1])return s=(t=t instanceof h?t[0]:t)?t.ownerDocument||t:D,(o=u.exec(e))?h.isPlainObject(t)?(e=[D.createElement(o[1])],h.fn.attr.call(e,t,!0)):e=[s.createElement(o[1])]:e=((o=h.buildFragment([i[1]],[s])).cacheable?h.clone(o.fragment):o.fragment).childNodes,h.merge(this,e);if((r=D.getElementById(i[2]))&&r.parentNode){if(r.id!==i[2])return n.find(e);this.length=1,this[0]=r}return this.context=D,this.selector=e,this},selector:"",jquery:"1.7.2",length:0,size:function(){return this.length},toArray:function(){return E.call(this,0)},get:function(e){return null==e?this.toArray():e<0?this[this.length+e]:this[e]},pushStack:function(e,t,n){var i=this.constructor();return h.isArray(e)?x.apply(i,e):h.merge(i,e),i.prevObject=this,i.context=this.context,"find"===t?i.selector=this.selector+(this.selector?" ":"")+n:t&&(i.selector=this.selector+"."+t+"("+n+")"),i},each:function(e,t){return h.each(this,e,t)},ready:function(e){return h.bindReady(),t.add(e),this},eq:function(e){return-1===(e=+e)?this.slice(e):this.slice(e,e+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},slice:function(){return this.pushStack(E.apply(this,arguments),"slice",E.call(arguments).join(","))},map:function(n){return this.pushStack(h.map(this,function(e,t){return n.call(e,t,e)}))},end:function(){return this.prevObject||this.constructor(null)},push:x,sort:[].sort,splice:[].splice},h.fn.init.prototype=h.fn,h.extend=h.fn.extend=function(){var e,t,n,i,r,o,s=arguments[0]||{},a=1,c=arguments.length,l=!1;for("boolean"==typeof s&&(l=s,s=arguments[1]||{},a=2),"object"==typeof s||h.isFunction(s)||(s={}),c===a&&(s=this,--a);a<c;a++)if(null!=(e=arguments[a]))for(t in e)n=s[t],s!==(i=e[t])&&(l&&i&&(h.isPlainObject(i)||(r=h.isArray(i)))?(o=r?(r=!1,n&&h.isArray(n)?n:[]):n&&h.isPlainObject(n)?n:{},s[t]=h.extend(l,o,i)):i!==M&&(s[t]=i));return s},h.extend({noConflict:function(e){return I.$===h&&(I.$=o),e&&I.jQuery===h&&(I.jQuery=r),h},isReady:!1,readyWait:1,holdReady:function(e){e?h.readyWait++:h.ready(!0)},ready:function(e){if(!0===e&&!--h.readyWait||!0!==e&&!h.isReady){if(!D.body)return setTimeout(h.ready,1);if((h.isReady=!0)!==e&&0<--h.readyWait)return;t.fireWith(D,[h]),h.fn.trigger&&h(D).trigger("ready").off("ready")}},bindReady:function(){if(!t){if(t=h.Callbacks("once memory"),"complete"===D.readyState)return setTimeout(h.ready,1);if(D.addEventListener)D.addEventListener("DOMContentLoaded",i,!1),I.addEventListener("load",h.ready,!1);else if(D.attachEvent){D.attachEvent("onreadystatechange",i),I.attachEvent("onload",h.ready);var e=!1;try{e=null==I.frameElement}catch(e){}D.documentElement.doScroll&&e&&O()}}},isFunction:function(e){return"function"===h.type(e)},isArray:Array.isArray||function(e){return"array"===h.type(e)},isWindow:function(e){return null!=e&&e==e.window},isNumeric:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},type:function(e){return null==e?String(e):A[T.call(e)]||"object"},isPlainObject:function(e){if(!e||"object"!==h.type(e)||e.nodeType||h.isWindow(e))return!1;try{if(e.constructor&&!S.call(e,"constructor")&&!S.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(e){return!1}var t;for(t in e);return t===M||S.call(e,t)},isEmptyObject:function(e){for(var t in e)return!1;return!0},error:function(e){throw new Error(e)},parseJSON:function(e){return"string"==typeof e&&e?(e=h.trim(e),I.JSON&&I.JSON.parse?I.JSON.parse(e):d.test(e.replace(p,"@").replace(f,"]").replace(g,""))?new Function("return "+e)():void h.error("Invalid JSON: "+e)):null},parseXML:function(e){if("string"!=typeof e||!e)return null;var t;try{I.DOMParser?t=(new DOMParser).parseFromString(e,"text/xml"):((t=new ActiveXObject("Microsoft.XMLDOM")).async="false",t.loadXML(e))}catch(e){t=M}return t&&t.documentElement&&!t.getElementsByTagName("parsererror").length||h.error("Invalid XML: "+e),t},noop:function(){},globalEval:function(e){e&&s.test(e)&&(I.execScript||function(e){I.eval.call(I,e)})(e)},camelCase:function(e){return e.replace(C,"ms-").replace(w,_)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toUpperCase()===t.toUpperCase()},each:function(e,t,n){var i,r=0,o=e.length,s=o===M||h.isFunction(e);if(n)if(s){for(i in e)if(!1===t.apply(e[i],n))break}else for(;r<o&&!1!==t.apply(e[r++],n););else if(s){for(i in e)if(!1===t.call(e[i],i,e[i]))break}else for(;r<o&&!1!==t.call(e[r],r,e[r++]););return e},trim:N?function(e){return null==e?"":N.call(e)}:function(e){return null==e?"":e.toString().replace(c,"").replace(l,"")},makeArray:function(e,t){var n=t||[];if(null!=e){var i=h.type(e);null==e.length||"string"===i||"function"===i||"regexp"===i||h.isWindow(e)?x.call(n,e):h.merge(n,e)}return n},inArray:function(e,t,n){var i;if(t){if(P)return P.call(t,e,n);for(i=t.length,n=n?n<0?Math.max(0,i+n):n:0;n<i;n++)if(n in t&&t[n]===e)return n}return-1},merge:function(e,t){var n=e.length,i=0;if("number"==typeof t.length)for(var r=t.length;i<r;i++)e[n++]=t[i];else for(;t[i]!==M;)e[n++]=t[i++];return e.length=n,e},grep:function(e,t,n){var i=[];n=!!n;for(var r=0,o=e.length;r<o;r++)n!==!!t(e[r],r)&&i.push(e[r]);return i},map:function(e,t,n){var i,r,o=[],s=0,a=e.length;if(e instanceof h||a!==M&&"number"==typeof a&&(0<a&&e[0]&&e[a-1]||0===a||h.isArray(e)))for(;s<a;s++)null!=(i=t(e[s],s,n))&&(o[o.length]=i);else for(r in e)null!=(i=t(e[r],r,n))&&(o[o.length]=i);return o.concat.apply([],o)},guid:1,proxy:function(e,t){if("string"==typeof t){var n=e[t];t=e,e=n}if(!h.isFunction(e))return M;var i=E.call(arguments,2),r=function(){return e.apply(t,i.concat(E.call(arguments)))};return r.guid=e.guid=e.guid||r.guid||h.guid++,r},access:function(e,t,n,i,r,o,s){var a,c=null==n,l=0,u=e.length;if(n&&"object"==typeof n){for(l in n)h.access(e,t,l,n[l],1,o,i);r=1}else if(i!==M){if(a=s===M&&h.isFunction(i),c&&(t=a?(a=t,function(e,t,n){return a.call(h(e),n)}):(t.call(e,i),null)),t)for(;l<u;l++)t(e[l],n,a?i.call(e[l],l,t(e[l],n)):i,s);r=1}return r?e:c?t.call(e):u?t(e[0],n):o},now:function(){return(new Date).getTime()},uaMatch:function(e){e=e.toLowerCase();var t=m.exec(e)||v.exec(e)||y.exec(e)||e.indexOf("compatible")<0&&b.exec(e)||[];return{browser:t[1]||"",version:t[2]||"0"}},sub:function(){function n(e,t){return new n.fn.init(e,t)}h.extend(!0,n,this),n.superclass=this,((n.fn=n.prototype=this()).constructor=n).sub=this.sub,n.fn.init=function(e,t){return t&&t instanceof h&&!(t instanceof n)&&(t=n(t)),h.fn.init.call(this,e,t,i)},n.fn.init.prototype=n.fn;var i=n(D);return n},browser:{}}),h.each("Boolean Number String Function Array Date RegExp Object".split(" "),function(e,t){A["[object "+t+"]"]=t.toLowerCase()}),(e=h.uaMatch(k)).browser&&(h.browser[e.browser]=!0,h.browser.version=e.version),h.browser.webkit&&(h.browser.safari=!0),s.test(" ")&&(c=/^[\s\xA0]+/,l=/[\s\xA0]+$/),n=h(D),D.addEventListener?i=function(){D.removeEventListener("DOMContentLoaded",i,!1),h.ready()}:D.attachEvent&&(i=function(){"complete"===D.readyState&&(D.detachEvent("onreadystatechange",i),h.ready())}),h}(),f={};x.Callbacks=function(o){o=o?f[o]||function(e){var t,n,i=f[e]={};for(t=0,n=(e=e.split(/\s+/)).length;t<n;t++)i[e[t]]=!0;return i}(o):{};var n,i,r,s,a,c,l=[],u=[],h=function(e){var t,n,i,r;for(t=0,n=e.length;t<n;t++)i=e[t],"array"===(r=x.type(i))?h(i):"function"===r&&(o.unique&&p.has(i)||l.push(i))},d=function(e,t){for(t=t||[],n=!o.memory||[e,t],r=i=!0,c=s||0,s=0,a=l.length;l&&c<a;c++)if(!1===l[c].apply(e,t)&&o.stopOnFalse){n=!0;break}r=!1,l&&(o.once?!0===n?p.disable():l=[]:u&&u.length&&(n=u.shift(),p.fireWith(n[0],n[1])))},p={add:function(){if(l){var e=l.length;h(arguments),r?a=l.length:n&&!0!==n&&(s=e,d(n[0],n[1]))}return this},remove:function(){if(l)for(var e=arguments,t=0,n=e.length;t<n;t++)for(var i=0;i<l.length&&(e[t]!==l[i]||(r&&i<=a&&(a--,i<=c&&c--),l.splice(i--,1),!o.unique));i++);return this},has:function(e){if(l)for(var t=0,n=l.length;t<n;t++)if(e===l[t])return!0;return!1},empty:function(){return l=[],this},disable:function(){return l=u=n=M,this},disabled:function(){return!l},lock:function(){return u=M,n&&!0!==n||p.disable(),this},locked:function(){return!u},fireWith:function(e,t){return u&&(r?o.once||u.push([e,t]):o.once&&n||d(e,t)),this},fire:function(){return p.fireWith(this,arguments),this},fired:function(){return!!i}};return p};var u=[].slice;x.extend({Deferred:function(e){var t,n=x.Callbacks("once memory"),i=x.Callbacks("once memory"),r=x.Callbacks("memory"),o="pending",s={resolve:n,reject:i,notify:r},a={done:n.add,fail:i.add,progress:r.add,state:function(){return o},isResolved:n.fired,isRejected:i.fired,then:function(e,t,n){return c.done(e).fail(t).progress(n),this},always:function(){return c.done.apply(c,arguments).fail.apply(c,arguments),this},pipe:function(e,t,n){return x.Deferred(function(o){x.each({done:[e,"resolve"],fail:[t,"reject"],progress:[n,"notify"]},function(e,t){var n,i=t[0],r=t[1];x.isFunction(i)?c[e](function(){(n=i.apply(this,arguments))&&x.isFunction(n.promise)?n.promise().then(o.resolve,o.reject,o.notify):o[r+"With"](this===c?o:this,[n])}):c[e](o[r])})}).promise()},promise:function(e){if(null==e)e=a;else for(var t in a)e[t]=a[t];return e}},c=a.promise({});for(t in s)c[t]=s[t].fire,c[t+"With"]=s[t].fireWith;return c.done(function(){o="resolved"},i.disable,r.lock).fail(function(){o="rejected"},n.disable,r.lock),e&&e.call(c,c),c},when:function(e){var n=u.call(arguments,0),t=0,i=n.length,r=new Array(i),o=i,s=i<=1&&e&&x.isFunction(e.promise)?e:x.Deferred(),a=s.promise();function c(t){return function(e){n[t]=1<arguments.length?u.call(arguments,0):e,--o||s.resolveWith(s,n)}}function l(t){return function(e){r[t]=1<arguments.length?u.call(arguments,0):e,s.notifyWith(a,r)}}if(1<i){for(;t<i;t++)n[t]&&n[t].promise&&x.isFunction(n[t].promise)?n[t].promise().then(c(t),s.reject,l(t)):--o;o||s.resolveWith(s,n)}else s!==e&&s.resolveWith(s,i?[e]:[]);return a}}),x.support=function(){var h,e,t,n,i,r,o,d,s,a,p,f=D.createElement("div");D.documentElement;if(f.setAttribute("className","t"),f.innerHTML="   <link/><table></table><a href='/a' style='top:1px;float:left;opacity:.55;'>a</a><input type='checkbox'/>",e=f.getElementsByTagName("*"),t=f.getElementsByTagName("a")[0],!e||!e.length||!t)return{};i=(n=D.createElement("select")).appendChild(D.createElement("option")),r=f.getElementsByTagName("input")[0],h={leadingWhitespace:3===f.firstChild.nodeType,tbody:!f.getElementsByTagName("tbody").length,htmlSerialize:!!f.getElementsByTagName("link").length,style:/top/.test(t.getAttribute("style")),hrefNormalized:"/a"===t.getAttribute("href"),opacity:/^0.55/.test(t.style.opacity),cssFloat:!!t.style.cssFloat,checkOn:"on"===r.value,optSelected:i.selected,getSetAttribute:"t"!==f.className,enctype:!!D.createElement("form").enctype,html5Clone:"<:nav></:nav>"!==D.createElement("nav").cloneNode(!0).outerHTML,submitBubbles:!0,changeBubbles:!0,focusinBubbles:!1,deleteExpando:!0,noCloneEvent:!0,inlineBlockNeedsLayout:!1,shrinkWrapBlocks:!1,reliableMarginRight:!0,pixelMargin:!0},x.boxModel=h.boxModel="CSS1Compat"===D.compatMode,r.checked=!0,h.noCloneChecked=r.cloneNode(!0).checked,n.disabled=!0,h.optDisabled=!i.disabled;try{delete f.test}catch(e){h.deleteExpando=!1}if(!f.addEventListener&&f.attachEvent&&f.fireEvent&&(f.attachEvent("onclick",function(){h.noCloneEvent=!1}),f.cloneNode(!0).fireEvent("onclick")),(r=D.createElement("input")).value="t",r.setAttribute("type","radio"),h.radioValue="t"===r.value,r.setAttribute("checked","checked"),r.setAttribute("name","t"),f.appendChild(r),(o=D.createDocumentFragment()).appendChild(f.lastChild),h.checkClone=o.cloneNode(!0).cloneNode(!0).lastChild.checked,h.appendChecked=r.checked,o.removeChild(r),o.appendChild(f),f.attachEvent)for(a in{submit:1,change:1,focusin:1})(p=(s="on"+a)in f)||(f.setAttribute(s,"return;"),p="function"==typeof f[s]),h[a+"Bubbles"]=p;return o.removeChild(f),o=n=i=f=r=null,x(function(){var e,t,n,i,r,o,s,a,c,l,u=D.getElementsByTagName("body")[0];u&&(c=(l="padding:0;margin:0;border:")+"0;visibility:hidden;",s="style='"+(a="position:absolute;top:0;left:0;width:1px;height:1px;")+l+"5px solid #000;",(e=D.createElement("div")).style.cssText=c+"width:0;height:0;position:static;top:0;margin-top:1px",u.insertBefore(e,u.firstChild),f=D.createElement("div"),e.appendChild(f),f.innerHTML="<table><tr><td style='"+l+"0;display:none'></td><td>t</td></tr></table>",d=f.getElementsByTagName("td"),p=0===d[0].offsetHeight,d[0].style.display="",d[1].style.display="none",h.reliableHiddenOffsets=p&&0===d[0].offsetHeight,I.getComputedStyle&&(f.innerHTML="",(o=D.createElement("div")).style.width="0",o.style.marginRight="0",f.style.width="2px",f.appendChild(o),h.reliableMarginRight=0===(parseInt((I.getComputedStyle(o,null)||{marginRight:0}).marginRight,10)||0)),void 0!==f.style.zoom&&(f.innerHTML="",f.style.width=f.style.padding="1px",f.style.border=0,f.style.overflow="hidden",f.style.display="inline",f.style.zoom=1,h.inlineBlockNeedsLayout=3===f.offsetWidth,f.style.display="block",f.style.overflow="visible",f.innerHTML="<div style='width:5px;'></div>",h.shrinkWrapBlocks=3!==f.offsetWidth),f.style.cssText=a+c,f.innerHTML="<div style='position:absolute;top:0;left:0;width:1px;height:1px;padding:0;margin:0;border:5px solid #000;display:block;'><div style='padding:0;margin:0;border:0;display:block;overflow:hidden;'></div></div><table style='position:absolute;top:0;left:0;width:1px;height:1px;padding:0;margin:0;border:5px solid #000;' cellpadding='0' cellspacing='0'><tr><td></td></tr></table>",n=(t=f.firstChild).firstChild,i=t.nextSibling.firstChild.firstChild,r={doesNotAddBorder:5!==n.offsetTop,doesAddBorderForTableAndCells:5===i.offsetTop},n.style.position="fixed",n.style.top="20px",r.fixedPosition=20===n.offsetTop||15===n.offsetTop,n.style.position=n.style.top="",t.style.overflow="hidden",t.style.position="relative",r.subtractsBorderForOverflowNotVisible=-5===n.offsetTop,r.doesNotIncludeMarginInBodyOffset=1!==u.offsetTop,I.getComputedStyle&&(f.style.marginTop="1%",h.pixelMargin="1%"!==(I.getComputedStyle(f,null)||{marginTop:0}).marginTop),void 0!==e.style.zoom&&(e.style.zoom=1),u.removeChild(e),o=f=e=null,x.extend(h,r))}),h}();var r=/^(?:\{.*\}|\[.*\])$/,o=/([A-Z])/g;function h(e,t,n){if(n===M&&1===e.nodeType){var i="data-"+t.replace(o,"-$1").toLowerCase();if("string"==typeof(n=e.getAttribute(i))){try{n="true"===n||"false"!==n&&("null"===n?null:x.isNumeric(n)?+n:r.test(n)?x.parseJSON(n):n)}catch(e){}x.data(e,t,n)}else n=M}return n}function d(e){for(var t in e)if(("data"!==t||!x.isEmptyObject(e[t]))&&"toJSON"!==t)return!1;return!0}function s(e,t,n){var i=t+"defer",r=t+"queue",o=t+"mark",s=x._data(e,i);!s||"queue"!==n&&x._data(e,r)||"mark"!==n&&x._data(e,o)||setTimeout(function(){x._data(e,r)||x._data(e,o)||(x.removeData(e,i,!0),s.fire())},0)}x.extend({cache:{},uuid:0,expando:"jQuery"+(x.fn.jquery+Math.random()).replace(/\D/g,""),noData:{embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},hasData:function(e){return!!(e=e.nodeType?x.cache[e[x.expando]]:e[x.expando])&&!d(e)},data:function(e,t,n,i){if(x.acceptData(e)){var r,o,s,a=x.expando,c="string"==typeof t,l=e.nodeType,u=l?x.cache:e,h=l?e[a]:e[a]&&a,d="events"===t;if(h&&u[h]&&(d||i||u[h].data)||!c||n!==M)return h||(l?e[a]=h=++x.uuid:h=a),u[h]||(u[h]={},l||(u[h].toJSON=x.noop)),"object"!=typeof t&&"function"!=typeof t||(i?u[h]=x.extend(u[h],t):u[h].data=x.extend(u[h].data,t)),r=o=u[h],i||(o.data||(o.data={}),o=o.data),n!==M&&(o[x.camelCase(t)]=n),d&&!o[t]?r.events:(c?null==(s=o[t])&&(s=o[x.camelCase(t)]):s=o,s)}},removeData:function(e,t,n){if(x.acceptData(e)){var i,r,o,s=x.expando,a=e.nodeType,c=a?x.cache:e,l=a?e[s]:s;if(c[l]){if(t&&(i=n?c[l]:c[l].data)){x.isArray(t)||(t=t in i?[t]:(t=x.camelCase(t))in i?[t]:t.split(" "));for(r=0,o=t.length;r<o;r++)delete i[t[r]];if(!(n?d:x.isEmptyObject)(i))return}(n||(delete c[l].data,d(c[l])))&&(x.support.deleteExpando||!c.setInterval?delete c[l]:c[l]=null,a&&(x.support.deleteExpando?delete e[s]:e.removeAttribute?e.removeAttribute(s):e[s]=null))}}},_data:function(e,t,n){return x.data(e,t,n,!0)},acceptData:function(e){if(e.nodeName){var t=x.noData[e.nodeName.toLowerCase()];if(t)return!(!0===t||e.getAttribute("classid")!==t)}return!0}}),x.fn.extend({data:function(n,e){var i,r,t,o,s,a=this[0],c=0,l=null;if(n!==M)return"object"==typeof n?this.each(function(){x.data(this,n)}):((i=n.split(".",2))[1]=i[1]?"."+i[1]:"",r=i[1]+"!",x.access(this,function(t){if(t===M)return(l=this.triggerHandler("getData"+r,[i[0]]))===M&&a&&(l=x.data(a,n),l=h(a,n,l)),l===M&&i[1]?this.data(i[0]):l;i[1]=t,this.each(function(){var e=x(this);e.triggerHandler("setData"+r,i),x.data(this,n,t),e.triggerHandler("changeData"+r,i)})},null,e,1<arguments.length,null,!1));if(this.length&&(l=x.data(a),1===a.nodeType&&!x._data(a,"parsedAttrs"))){for(s=(t=a.attributes).length;c<s;c++)0===(o=t[c].name).indexOf("data-")&&(o=x.camelCase(o.substring(5)),h(a,o,l[o]));x._data(a,"parsedAttrs",!0)}return l},removeData:function(e){return this.each(function(){x.removeData(this,e)})}}),x.extend({_mark:function(e,t){e&&(t=(t||"fx")+"mark",x._data(e,t,(x._data(e,t)||0)+1))},_unmark:function(e,t,n){if(!0!==e&&(n=t,t=e,e=!1),t){var i=(n=n||"fx")+"mark",r=e?0:(x._data(t,i)||1)-1;r?x._data(t,i,r):(x.removeData(t,i,!0),s(t,n,"mark"))}},queue:function(e,t,n){var i;if(e)return t=(t||"fx")+"queue",i=x._data(e,t),n&&(!i||x.isArray(n)?i=x._data(e,t,x.makeArray(n)):i.push(n)),i||[]},dequeue:function(e,t){t=t||"fx";var n=x.queue(e,t),i=n.shift(),r={};"inprogress"===i&&(i=n.shift()),i&&("fx"===t&&n.unshift("inprogress"),x._data(e,t+".run",r),i.call(e,function(){x.dequeue(e,t)},r)),n.length||(x.removeData(e,t+"queue "+t+".run",!0),s(e,t,"queue"))}}),x.fn.extend({queue:function(t,n){var e=2;return"string"!=typeof t&&(n=t,t="fx",e--),arguments.length<e?x.queue(this[0],t):n===M?this:this.each(function(){var e=x.queue(this,t,n);"fx"===t&&"inprogress"!==e[0]&&x.dequeue(this,t)})},dequeue:function(e){return this.each(function(){x.dequeue(this,e)})},delay:function(i,e){return i=x.fx&&x.fx.speeds[i]||i,e=e||"fx",this.queue(e,function(e,t){var n=setTimeout(e,i);t.stop=function(){clearTimeout(n)}})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){"string"!=typeof e&&(t=e,e=M),e=e||"fx";var n,i=x.Deferred(),r=this,o=r.length,s=1,a=e+"defer",c=e+"queue",l=e+"mark";function u(){--s||i.resolveWith(r,[r])}for(;o--;)(n=x.data(r[o],a,M,!0)||(x.data(r[o],c,M,!0)||x.data(r[o],l,M,!0))&&x.data(r[o],a,x.Callbacks("once memory"),!0))&&(s++,n.add(u));return u(),i.promise(t)}});var c,l,i,p=/[\n\t\r]/g,g=/\s+/,n=/\r/g,a=/^(?:button|input)$/i,m=/^(?:button|input|object|select|textarea)$/i,v=/^a(?:rea)?$/i,y=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,b=x.support.getSetAttribute;x.fn.extend({attr:function(e,t){return x.access(this,x.attr,e,t,1<arguments.length)},removeAttr:function(e){return this.each(function(){x.removeAttr(this,e)})},prop:function(e,t){return x.access(this,x.prop,e,t,1<arguments.length)},removeProp:function(e){return e=x.propFix[e]||e,this.each(function(){try{this[e]=M,delete this[e]}catch(e){}})},addClass:function(t){var e,n,i,r,o,s,a;if(x.isFunction(t))return this.each(function(e){x(this).addClass(t.call(this,e,this.className))});if(t&&"string"==typeof t)for(e=t.split(g),n=0,i=this.length;n<i;n++)if(1===(r=this[n]).nodeType)if(r.className||1!==e.length){for(o=" "+r.className+" ",s=0,a=e.length;s<a;s++)~o.indexOf(" "+e[s]+" ")||(o+=e[s]+" ");r.className=x.trim(o)}else r.className=t;return this},removeClass:function(t){var e,n,i,r,o,s,a;if(x.isFunction(t))return this.each(function(e){x(this).removeClass(t.call(this,e,this.className))});if(t&&"string"==typeof t||t===M)for(e=(t||"").split(g),n=0,i=this.length;n<i;n++)if(1===(r=this[n]).nodeType&&r.className)if(t){for(o=(" "+r.className+" ").replace(p," "),s=0,a=e.length;s<a;s++)o=o.replace(" "+e[s]+" "," ");r.className=x.trim(o)}else r.className="";return this},toggleClass:function(o,s){var a=typeof o,c="boolean"==typeof s;return x.isFunction(o)?this.each(function(e){x(this).toggleClass(o.call(this,e,this.className,s),s)}):this.each(function(){if("string"===a)for(var e,t=0,n=x(this),i=s,r=o.split(g);e=r[t++];)i=c?i:!n.hasClass(e),n[i?"addClass":"removeClass"](e);else"undefined"!==a&&"boolean"!==a||(this.className&&x._data(this,"__className__",this.className),this.className=this.className||!1===o?"":x._data(this,"__className__")||"")})},hasClass:function(e){for(var t=" "+e+" ",n=0,i=this.length;n<i;n++)if(1===this[n].nodeType&&-1<(" "+this[n].className+" ").replace(p," ").indexOf(t))return!0;return!1},val:function(i){var r,e,o,t=this[0];return arguments.length?(o=x.isFunction(i),this.each(function(e){var t,n=x(this);1===this.nodeType&&(null==(t=o?i.call(this,e,n.val()):i)?t="":"number"==typeof t?t+="":x.isArray(t)&&(t=x.map(t,function(e){return null==e?"":e+""})),(r=x.valHooks[this.type]||x.valHooks[this.nodeName.toLowerCase()])&&"set"in r&&r.set(this,t,"value")!==M||(this.value=t))})):t?(r=x.valHooks[t.type]||x.valHooks[t.nodeName.toLowerCase()])&&"get"in r&&(e=r.get(t,"value"))!==M?e:"string"==typeof(e=t.value)?e.replace(n,""):null==e?"":e:void 0}}),x.extend({valHooks:{option:{get:function(e){var t=e.attributes.value;return!t||t.specified?e.value:e.text}},select:{get:function(e){var t,n,i,r,o=e.selectedIndex,s=[],a=e.options,c="select-one"===e.type;if(o<0)return null;for(n=c?o:0,i=c?o+1:a.length;n<i;n++)if((r=a[n]).selected&&(x.support.optDisabled?!r.disabled:null===r.getAttribute("disabled"))&&(!r.parentNode.disabled||!x.nodeName(r.parentNode,"optgroup"))){if(t=x(r).val(),c)return t;s.push(t)}return c&&!s.length&&a.length?x(a[o]).val():s},set:function(e,t){var n=x.makeArray(t);return x(e).find("option").each(function(){this.selected=0<=x.inArray(x(this).val(),n)}),n.length||(e.selectedIndex=-1),n}}},attrFn:{val:!0,css:!0,html:!0,text:!0,data:!0,width:!0,height:!0,offset:!0},attr:function(e,t,n,i){var r,o,s,a=e.nodeType;if(e&&3!==a&&8!==a&&2!==a)return i&&t in x.attrFn?x(e)[t](n):void 0===e.getAttribute?x.prop(e,t,n):((s=1!==a||!x.isXMLDoc(e))&&(t=t.toLowerCase(),o=x.attrHooks[t]||(y.test(t)?l:c)),n!==M?null===n?void x.removeAttr(e,t):o&&"set"in o&&s&&(r=o.set(e,n,t))!==M?r:(e.setAttribute(t,""+n),n):o&&"get"in o&&s&&null!==(r=o.get(e,t))?r:null===(r=e.getAttribute(t))?M:r)},removeAttr:function(e,t){var n,i,r,o,s,a=0;if(t&&1===e.nodeType)for(o=(i=t.toLowerCase().split(g)).length;a<o;a++)(r=i[a])&&(n=x.propFix[r]||r,(s=y.test(r))||x.attr(e,r,""),e.removeAttribute(b?r:n),s&&n in e&&(e[n]=!1))},attrHooks:{type:{set:function(e,t){if(a.test(e.nodeName)&&e.parentNode)x.error("type property can't be changed");else if(!x.support.radioValue&&"radio"===t&&x.nodeName(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}},value:{get:function(e,t){return c&&x.nodeName(e,"button")?c.get(e,t):t in e?e.value:null},set:function(e,t,n){if(c&&x.nodeName(e,"button"))return c.set(e,t,n);e.value=t}}},propFix:{tabindex:"tabIndex",readonly:"readOnly",for:"htmlFor",class:"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(e,t,n){var i,r,o=e.nodeType;if(e&&3!==o&&8!==o&&2!==o)return(1!==o||!x.isXMLDoc(e))&&(t=x.propFix[t]||t,r=x.propHooks[t]),n!==M?r&&"set"in r&&(i=r.set(e,n,t))!==M?i:e[t]=n:r&&"get"in r&&null!==(i=r.get(e,t))?i:e[t]},propHooks:{tabIndex:{get:function(e){var t=e.getAttributeNode("tabindex");return t&&t.specified?parseInt(t.value,10):m.test(e.nodeName)||v.test(e.nodeName)&&e.href?0:M}}}}),x.attrHooks.tabindex=x.propHooks.tabIndex,l={get:function(e,t){var n,i=x.prop(e,t);return!0===i||"boolean"!=typeof i&&(n=e.getAttributeNode(t))&&!1!==n.nodeValue?t.toLowerCase():M},set:function(e,t,n){var i;return!1===t?x.removeAttr(e,n):((i=x.propFix[n]||n)in e&&(e[i]=!0),e.setAttribute(n,n.toLowerCase())),n}},b||(i={name:!0,id:!0,coords:!0},c=x.valHooks.button={get:function(e,t){var n;return(n=e.getAttributeNode(t))&&(i[t]?""!==n.nodeValue:n.specified)?n.nodeValue:M},set:function(e,t,n){var i=e.getAttributeNode(n);return i||(i=D.createAttribute(n),e.setAttributeNode(i)),i.nodeValue=t+""}},x.attrHooks.tabindex.set=c.set,x.each(["width","height"],function(e,n){x.attrHooks[n]=x.extend(x.attrHooks[n],{set:function(e,t){if(""===t)return e.setAttribute(n,"auto"),t}})}),x.attrHooks.contenteditable={get:c.get,set:function(e,t,n){""===t&&(t="false"),c.set(e,t,n)}}),x.support.hrefNormalized||x.each(["href","src","width","height"],function(e,n){x.attrHooks[n]=x.extend(x.attrHooks[n],{get:function(e){var t=e.getAttribute(n,2);return null===t?M:t}})}),x.support.style||(x.attrHooks.style={get:function(e){return e.style.cssText.toLowerCase()||M},set:function(e,t){return e.style.cssText=""+t}}),x.support.optSelected||(x.propHooks.selected=x.extend(x.propHooks.selected,{get:function(e){var t=e.parentNode;return t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex),null}})),x.support.enctype||(x.propFix.enctype="encoding"),x.support.checkOn||x.each(["radio","checkbox"],function(){x.valHooks[this]={get:function(e){return null===e.getAttribute("value")?"on":e.value}}}),x.each(["radio","checkbox"],function(){x.valHooks[this]=x.extend(x.valHooks[this],{set:function(e,t){if(x.isArray(t))return e.checked=0<=x.inArray(x(e).val(),t)}})});var w=/^(?:textarea|input|select)$/i,C=/^([^\.]*)?(?:\.(.+))?$/,t=/(?:^|\s)hover(\.\S+)?\b/,_=/^key/,k=/^(?:mouse|contextmenu)|click/,T=/^(?:focusinfocus|focusoutblur)$/,S=/^(\w*)(?:#([\w\-]+))?(?:\.([\w\-]+))?$/,E=function(e){return x.event.special.hover?e:e.replace(t,"mouseenter$1 mouseleave$1")};function N(){return!1}function P(){return!0}x.event={add:function(e,t,n,i,r){var o,s,a,c,l,u,h,d,p,f,g;if(3!==e.nodeType&&8!==e.nodeType&&t&&n&&(o=x._data(e))){for(n.handler&&(n=(p=n).handler,r=p.selector),n.guid||(n.guid=x.guid++),(a=o.events)||(o.events=a={}),(s=o.handle)||(o.handle=s=function(e){return void 0===x||e&&x.event.triggered===e.type?M:x.event.dispatch.apply(s.elem,arguments)},s.elem=e),t=x.trim(E(t)).split(" "),c=0;c<t.length;c++)u=(l=C.exec(t[c])||[])[1],h=(l[2]||"").split(".").sort(),g=x.event.special[u]||{},u=(r?g.delegateType:g.bindType)||u,g=x.event.special[u]||{},d=x.extend({type:u,origType:l[1],data:i,handler:n,guid:n.guid,selector:r,quick:r&&(m=r,v=void 0,v=S.exec(m),v&&(v[1]=(v[1]||"").toLowerCase(),v[3]=v[3]&&new RegExp("(?:^|\\s)"+v[3]+"(?:\\s|$)")),v),namespace:h.join(".")},p),(f=a[u])||((f=a[u]=[]).delegateCount=0,g.setup&&!1!==g.setup.call(e,i,h,s)||(e.addEventListener?e.addEventListener(u,s,!1):e.attachEvent&&e.attachEvent("on"+u,s))),g.add&&(g.add.call(e,d),d.handler.guid||(d.handler.guid=n.guid)),r?f.splice(f.delegateCount++,0,d):f.push(d),x.event.global[u]=!0;var m,v;e=null}},global:{},remove:function(e,t,n,i,r){var o,s,a,c,l,u,h,d,p,f,g,m,v=x.hasData(e)&&x._data(e);if(v&&(d=v.events)){for(t=x.trim(E(t||"")).split(" "),o=0;o<t.length;o++)if(a=c=(s=C.exec(t[o])||[])[1],l=s[2],a){for(p=x.event.special[a]||{},u=(g=d[a=(i?p.delegateType:p.bindType)||a]||[]).length,l=l?new RegExp("(^|\\.)"+l.split(".").sort().join("\\.(?:.*\\.)?")+"(\\.|$)"):null,h=0;h<g.length;h++)m=g[h],!r&&c!==m.origType||n&&n.guid!==m.guid||l&&!l.test(m.namespace)||i&&i!==m.selector&&("**"!==i||!m.selector)||(g.splice(h--,1),m.selector&&g.delegateCount--,p.remove&&p.remove.call(e,m));0===g.length&&u!==g.length&&(p.teardown&&!1!==p.teardown.call(e,l)||x.removeEvent(e,a,v.handle),delete d[a])}else for(a in d)x.event.remove(e,a+t[o],n,i,!0);x.isEmptyObject(d)&&((f=v.handle)&&(f.elem=null),x.removeData(e,["events","handle"],!0))}},customEvent:{getData:!0,setData:!0,changeData:!0},trigger:function(e,t,n,i){if(!n||3!==n.nodeType&&8!==n.nodeType){var r,o,s,a,c,l,u,h,d,p,f=e.type||e,g=[];if(!T.test(f+x.event.triggered)&&(0<=f.indexOf("!")&&(f=f.slice(0,-1),o=!0),0<=f.indexOf(".")&&(f=(g=f.split(".")).shift(),g.sort()),n&&!x.event.customEvent[f]||x.event.global[f]))if((e="object"==typeof e?e[x.expando]?e:new x.Event(f,e):new x.Event(f)).type=f,e.isTrigger=!0,e.exclusive=o,e.namespace=g.join("."),e.namespace_re=e.namespace?new RegExp("(^|\\.)"+g.join("\\.(?:.*\\.)?")+"(\\.|$)"):null,l=f.indexOf(":")<0?"on"+f:"",n){if(e.result=M,e.target||(e.target=n),(t=null!=t?x.makeArray(t):[]).unshift(e),!(u=x.event.special[f]||{}).trigger||!1!==u.trigger.apply(n,t)){if(d=[[n,u.bindType||f]],!i&&!u.noBubble&&!x.isWindow(n)){for(p=u.delegateType||f,a=T.test(p+f)?n:n.parentNode,c=null;a;a=a.parentNode)d.push([a,p]),c=a;c&&c===n.ownerDocument&&d.push([c.defaultView||c.parentWindow||I,p])}for(s=0;s<d.length&&!e.isPropagationStopped();s++)a=d[s][0],e.type=d[s][1],(h=(x._data(a,"events")||{})[e.type]&&x._data(a,"handle"))&&h.apply(a,t),(h=l&&a[l])&&x.acceptData(a)&&!1===h.apply(a,t)&&e.preventDefault();return e.type=f,i||e.isDefaultPrevented()||u._default&&!1!==u._default.apply(n.ownerDocument,t)||"click"===f&&x.nodeName(n,"a")||!x.acceptData(n)||l&&n[f]&&("focus"!==f&&"blur"!==f||0!==e.target.offsetWidth)&&!x.isWindow(n)&&((c=n[l])&&(n[l]=null),n[x.event.triggered=f](),x.event.triggered=M,c&&(n[l]=c)),e.result}}else for(s in r=x.cache)r[s].events&&r[s].events[f]&&x.event.trigger(e,t,r[s].handle.elem,!0)}},dispatch:function(e){e=x.event.fix(e||I.event);var t,n,i,r,o,s,a,c,l,u,h=(x._data(this,"events")||{})[e.type]||[],d=h.delegateCount,p=[].slice.call(arguments,0),f=!e.exclusive&&!e.namespace,g=x.event.special[e.type]||{},m=[];if((p[0]=e).delegateTarget=this,!g.preDispatch||!1!==g.preDispatch.call(this,e)){if(d&&(!e.button||"click"!==e.type))for((r=x(this)).context=this.ownerDocument||this,i=e.target;i!=this;i=i.parentNode||this)if(!0!==i.disabled){for(s={},c=[],r[0]=i,t=0;t<d;t++)s[u=(l=h[t]).selector]===M&&(s[u]=l.quick?(v=i,y=l.quick,void 0,b=v.attributes||{},(!y[1]||v.nodeName.toLowerCase()===y[1])&&(!y[2]||(b.id||{}).value===y[2])&&(!y[3]||y[3].test((b.class||{}).value))):r.is(u)),s[u]&&c.push(l);c.length&&m.push({elem:i,matches:c})}var v,y,b;for(h.length>d&&m.push({elem:this,matches:h.slice(d)}),t=0;t<m.length&&!e.isPropagationStopped();t++)for(a=m[t],e.currentTarget=a.elem,n=0;n<a.matches.length&&!e.isImmediatePropagationStopped();n++)l=a.matches[n],(f||!e.namespace&&!l.namespace||e.namespace_re&&e.namespace_re.test(l.namespace))&&(e.data=l.data,e.handleObj=l,(o=((x.event.special[l.origType]||{}).handle||l.handler).apply(a.elem,p))!==M&&!1===(e.result=o)&&(e.preventDefault(),e.stopPropagation()));return g.postDispatch&&g.postDispatch.call(this,e),e.result}},props:"attrChange attrName relatedNode srcElement altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,t){var n,i,r,o=t.button,s=t.fromElement;return null==e.pageX&&null!=t.clientX&&(i=(n=e.target.ownerDocument||D).documentElement,r=n.body,e.pageX=t.clientX+(i&&i.scrollLeft||r&&r.scrollLeft||0)-(i&&i.clientLeft||r&&r.clientLeft||0),e.pageY=t.clientY+(i&&i.scrollTop||r&&r.scrollTop||0)-(i&&i.clientTop||r&&r.clientTop||0)),!e.relatedTarget&&s&&(e.relatedTarget=s===e.target?t.toElement:s),e.which||o===M||(e.which=1&o?1:2&o?3:4&o?2:0),e}},fix:function(e){if(e[x.expando])return e;var t,n,i=e,r=x.event.fixHooks[e.type]||{},o=r.props?this.props.concat(r.props):this.props;for(e=x.Event(i),t=o.length;t;)e[n=o[--t]]=i[n];return e.target||(e.target=i.srcElement||D),3===e.target.nodeType&&(e.target=e.target.parentNode),e.metaKey===M&&(e.metaKey=e.ctrlKey),r.filter?r.filter(e,i):e},special:{ready:{setup:x.bindReady},load:{noBubble:!0},focus:{delegateType:"focusin"},blur:{delegateType:"focusout"},beforeunload:{setup:function(e,t,n){x.isWindow(this)&&(this.onbeforeunload=n)},teardown:function(e,t){this.onbeforeunload===t&&(this.onbeforeunload=null)}}},simulate:function(e,t,n,i){var r=x.extend(new x.Event,n,{type:e,isSimulated:!0,originalEvent:{}});i?x.event.trigger(r,null,t):x.event.dispatch.call(t,r),r.isDefaultPrevented()&&n.preventDefault()}},x.event.handle=x.event.dispatch,x.removeEvent=D.removeEventListener?function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n,!1)}:function(e,t,n){e.detachEvent&&e.detachEvent("on"+t,n)},x.Event=function(e,t){if(!(this instanceof x.Event))return new x.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||!1===e.returnValue||e.getPreventDefault&&e.getPreventDefault()?P:N):this.type=e,t&&x.extend(this,t),this.timeStamp=e&&e.timeStamp||x.now(),this[x.expando]=!0},x.Event.prototype={preventDefault:function(){this.isDefaultPrevented=P;var e=this.originalEvent;e&&(e.preventDefault?e.preventDefault():e.returnValue=!1)},stopPropagation:function(){this.isPropagationStopped=P;var e=this.originalEvent;e&&(e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=P,this.stopPropagation()},isDefaultPrevented:N,isPropagationStopped:N,isImmediatePropagationStopped:N},x.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(e,r){x.event.special[e]={delegateType:r,bindType:r,handle:function(e){var t,n=e.relatedTarget,i=e.handleObj;i.selector;return n&&(n===this||x.contains(this,n))||(e.type=i.origType,t=i.handler.apply(this,arguments),e.type=r),t}}}),x.support.submitBubbles||(x.event.special.submit={setup:function(){if(x.nodeName(this,"form"))return!1;x.event.add(this,"click._submit keypress._submit",function(e){var t=e.target,n=x.nodeName(t,"input")||x.nodeName(t,"button")?t.form:M;n&&!n._submit_attached&&(x.event.add(n,"submit._submit",function(e){e._submit_bubble=!0}),n._submit_attached=!0)})},postDispatch:function(e){e._submit_bubble&&(delete e._submit_bubble,this.parentNode&&!e.isTrigger&&x.event.simulate("submit",this.parentNode,e,!0))},teardown:function(){if(x.nodeName(this,"form"))return!1;x.event.remove(this,"._submit")}}),x.support.changeBubbles||(x.event.special.change={setup:function(){if(w.test(this.nodeName))return"checkbox"!==this.type&&"radio"!==this.type||(x.event.add(this,"propertychange._change",function(e){"checked"===e.originalEvent.propertyName&&(this._just_changed=!0)}),x.event.add(this,"click._change",function(e){this._just_changed&&!e.isTrigger&&(this._just_changed=!1,x.event.simulate("change",this,e,!0))})),!1;x.event.add(this,"beforeactivate._change",function(e){var t=e.target;w.test(t.nodeName)&&!t._change_attached&&(x.event.add(t,"change._change",function(e){!this.parentNode||e.isSimulated||e.isTrigger||x.event.simulate("change",this.parentNode,e,!0)}),t._change_attached=!0)})},handle:function(e){var t=e.target;if(this!==t||e.isSimulated||e.isTrigger||"radio"!==t.type&&"checkbox"!==t.type)return e.handleObj.handler.apply(this,arguments)},teardown:function(){return x.event.remove(this,"._change"),w.test(this.nodeName)}}),x.support.focusinBubbles||x.each({focus:"focusin",blur:"focusout"},function(e,t){var n=0,i=function(e){x.event.simulate(t,e.target,x.event.fix(e),!0)};x.event.special[t]={setup:function(){0==n++&&D.addEventListener(e,i,!0)},teardown:function(){0==--n&&D.removeEventListener(e,i,!0)}}}),x.fn.extend({on:function(e,t,n,i,r){var o,s;if("object"==typeof e){for(s in"string"!=typeof t&&(n=n||t,t=M),e)this.on(s,t,n,e[s],r);return this}if(null==n&&null==i?(i=t,n=t=M):null==i&&("string"==typeof t?(i=n,n=M):(i=n,n=t,t=M)),!1===i)i=N;else if(!i)return this;return 1===r&&(o=i,(i=function(e){return x().off(e),o.apply(this,arguments)}).guid=o.guid||(o.guid=x.guid++)),this.each(function(){x.event.add(this,e,i,n,t)})},one:function(e,t,n,i){return this.on(e,t,n,i,1)},off:function(e,t,n){if(e&&e.preventDefault&&e.handleObj){var i=e.handleObj;return x(e.delegateTarget).off(i.namespace?i.origType+"."+i.namespace:i.origType,i.selector,i.handler),this}if("object"!=typeof e)return!1!==t&&"function"!=typeof t||(n=t,t=M),!1===n&&(n=N),this.each(function(){x.event.remove(this,e,n,t)});for(var r in e)this.off(r,t,e[r]);return this},bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},live:function(e,t,n){return x(this.context).on(e,this.selector,t,n),this},die:function(e,t){return x(this.context).off(e,this.selector||"**",t),this},delegate:function(e,t,n,i){return this.on(t,e,n,i)},undelegate:function(e,t,n){return 1==arguments.length?this.off(e,"**"):this.off(t,e,n)},trigger:function(e,t){return this.each(function(){x.event.trigger(e,t,this)})},triggerHandler:function(e,t){if(this[0])return x.event.trigger(e,t,this[0],!0)},toggle:function(n){var i=arguments,e=n.guid||x.guid++,r=0,t=function(e){var t=(x._data(this,"lastToggle"+n.guid)||0)%r;return x._data(this,"lastToggle"+n.guid,t+1),e.preventDefault(),i[t].apply(this,arguments)||!1};for(t.guid=e;r<i.length;)i[r++].guid=e;return this.click(t)},hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)}}),x.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,n){x.fn[n]=function(e,t){return null==t&&(t=e,e=null),0<arguments.length?this.on(n,null,e,t):this.trigger(n)},x.attrFn&&(x.attrFn[n]=!0),_.test(n)&&(x.event.fixHooks[n]=x.event.keyHooks),k.test(n)&&(x.event.fixHooks[n]=x.event.mouseHooks)}),function(){var v=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g,u="sizcache"+(Math.random()+"").replace(".",""),s=0,y=Object.prototype.toString,h=!1,n=!0,l=/\\/g,o=/\r\n/g,c=/\W/;[0,0].sort(function(){return n=!1,0});var b=function(e,t,n,i){n=n||[];var r=t=t||D;if(1!==t.nodeType&&9!==t.nodeType)return[];if(!e||"string"!=typeof e)return n;var o,s,a,c,l,u,h,d,p=!0,f=b.isXML(t),g=[],m=e;do{if(v.exec(""),(o=v.exec(m))&&(m=o[3],g.push(o[1]),o[2])){c=o[3];break}}while(o);if(1<g.length&&C.exec(e))if(2===g.length&&w.relative[g[0]])s=S(g[0]+g[1],t,i);else for(s=w.relative[g[0]]?[t]:b(g.shift(),t);g.length;)e=g.shift(),w.relative[e]&&(e+=g.shift()),s=S(e,s,i);else if(!i&&1<g.length&&9===t.nodeType&&!f&&w.match.ID.test(g[0])&&!w.match.ID.test(g[g.length-1])&&(t=(l=b.find(g.shift(),t,f)).expr?b.filter(l.expr,l.set)[0]:l.set[0]),t)for(s=(l=i?{expr:g.pop(),set:_(i)}:b.find(g.pop(),1!==g.length||"~"!==g[0]&&"+"!==g[0]||!t.parentNode?t:t.parentNode,f)).expr?b.filter(l.expr,l.set):l.set,0<g.length?a=_(s):p=!1;g.length;)h=u=g.pop(),w.relative[u]?h=g.pop():u="",null==h&&(h=t),w.relative[u](a,h,f);else a=g=[];if(a||(a=s),a||b.error(u||e),"[object Array]"===y.call(a))if(p)if(t&&1===t.nodeType)for(d=0;null!=a[d];d++)a[d]&&(!0===a[d]||1===a[d].nodeType&&b.contains(t,a[d]))&&n.push(s[d]);else for(d=0;null!=a[d];d++)a[d]&&1===a[d].nodeType&&n.push(s[d]);else n.push.apply(n,a);else _(a,n);return c&&(b(c,r,n,i),b.uniqueSort(n)),n};b.uniqueSort=function(e){if(i&&(h=n,e.sort(i),h))for(var t=1;t<e.length;t++)e[t]===e[t-1]&&e.splice(t--,1);return e},b.matches=function(e,t){return b(e,null,null,t)},b.matchesSelector=function(e,t){return 0<b(t,null,null,[e]).length},b.find=function(e,t,n){var i,r,o,s,a,c;if(!e)return[];for(r=0,o=w.order.length;r<o;r++)if(a=w.order[r],(s=w.leftMatch[a].exec(e))&&(c=s[1],s.splice(1,1),"\\"!==c.substr(c.length-1)&&(s[1]=(s[1]||"").replace(l,""),null!=(i=w.find[a](s,t,n))))){e=e.replace(w.match[a],"");break}return i||(i=void 0!==t.getElementsByTagName?t.getElementsByTagName("*"):[]),{set:i,expr:e}},b.filter=function(e,t,n,i){for(var r,o,s,a,c,l,u,h,d,p=e,f=[],g=t,m=t&&t[0]&&b.isXML(t[0]);e&&t.length;){for(s in w.filter)if(null!=(r=w.leftMatch[s].exec(e))&&r[2]){if(l=w.filter[s],u=r[1],o=!1,r.splice(1,1),"\\"===u.substr(u.length-1))continue;if(g===f&&(f=[]),w.preFilter[s])if(r=w.preFilter[s](r,g,n,f,i,m)){if(!0===r)continue}else o=a=!0;if(r)for(h=0;null!=(c=g[h]);h++)c&&(d=i^(a=l(c,r,h,g)),n&&null!=a?d?o=!0:g[h]=!1:d&&(f.push(c),o=!0));if(a!==M){if(n||(g=f),e=e.replace(w.match[s],""),!o)return[];break}}if(e===p){if(null!=o)break;b.error(e)}p=e}return g},b.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)};var d=b.getText=function(e){var t,n,i=e.nodeType,r="";if(i){if(1===i||9===i||11===i){if("string"==typeof e.textContent)return e.textContent;if("string"==typeof e.innerText)return e.innerText.replace(o,"");for(e=e.firstChild;e;e=e.nextSibling)r+=d(e)}else if(3===i||4===i)return e.nodeValue}else for(t=0;n=e[t];t++)8!==n.nodeType&&(r+=d(n));return r},w=b.selectors={order:["ID","NAME","TAG"],match:{ID:/#((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,CLASS:/\.((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,NAME:/\[name=['"]*((?:[\w\u00c0-\uFFFF\-]|\\.)+)['"]*\]/,ATTR:/\[\s*((?:[\w\u00c0-\uFFFF\-]|\\.)+)\s*(?:(\S?=)\s*(?:(['"])(.*?)\3|(#?(?:[\w\u00c0-\uFFFF\-]|\\.)*)|)|)\s*\]/,TAG:/^((?:[\w\u00c0-\uFFFF\*\-]|\\.)+)/,CHILD:/:(only|nth|last|first)-child(?:\(\s*(even|odd|(?:[+\-]?\d+|(?:[+\-]?\d*)?n\s*(?:[+\-]\s*\d+)?))\s*\))?/,POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^\-]|$)/,PSEUDO:/:((?:[\w\u00c0-\uFFFF\-]|\\.)+)(?:\((['"]?)((?:\([^\)]+\)|[^\(\)]*)+)\2\))?/},leftMatch:{},attrMap:{class:"className",for:"htmlFor"},attrHandle:{href:function(e){return e.getAttribute("href")},type:function(e){return e.getAttribute("type")}},relative:{"+":function(e,t){var n="string"==typeof t,i=n&&!c.test(t),r=n&&!i;i&&(t=t.toLowerCase());for(var o,s=0,a=e.length;s<a;s++)if(o=e[s]){for(;(o=o.previousSibling)&&1!==o.nodeType;);e[s]=r||o&&o.nodeName.toLowerCase()===t?o||!1:o===t}r&&b.filter(t,e,!0)},">":function(e,t){var n,i="string"==typeof t,r=0,o=e.length;if(i&&!c.test(t)){for(t=t.toLowerCase();r<o;r++)if(n=e[r]){var s=n.parentNode;e[r]=s.nodeName.toLowerCase()===t&&s}}else{for(;r<o;r++)(n=e[r])&&(e[r]=i?n.parentNode:n.parentNode===t);i&&b.filter(t,e,!0)}},"":function(e,t,n){var i,r=s++,o=T;"string"!=typeof t||c.test(t)||(i=t=t.toLowerCase(),o=k),o("parentNode",t,r,e,i,n)},"~":function(e,t,n){var i,r=s++,o=T;"string"!=typeof t||c.test(t)||(i=t=t.toLowerCase(),o=k),o("previousSibling",t,r,e,i,n)}},find:{ID:function(e,t,n){if(void 0!==t.getElementById&&!n){var i=t.getElementById(e[1]);return i&&i.parentNode?[i]:[]}},NAME:function(e,t){if(void 0!==t.getElementsByName){for(var n=[],i=t.getElementsByName(e[1]),r=0,o=i.length;r<o;r++)i[r].getAttribute("name")===e[1]&&n.push(i[r]);return 0===n.length?null:n}},TAG:function(e,t){if(void 0!==t.getElementsByTagName)return t.getElementsByTagName(e[1])}},preFilter:{CLASS:function(e,t,n,i,r,o){if(e=" "+e[1].replace(l,"")+" ",o)return e;for(var s,a=0;null!=(s=t[a]);a++)s&&(r^(s.className&&0<=(" "+s.className+" ").replace(/[\t\n\r]/g," ").indexOf(e))?n||i.push(s):n&&(t[a]=!1));return!1},ID:function(e){return e[1].replace(l,"")},TAG:function(e,t){return e[1].replace(l,"").toLowerCase()},CHILD:function(e){if("nth"===e[1]){e[2]||b.error(e[0]),e[2]=e[2].replace(/^\+|\s*/g,"");var t=/(-?)(\d*)(?:n([+\-]?\d*))?/.exec(("even"===e[2]?"2n":"odd"===e[2]&&"2n+1")||!/\D/.test(e[2])&&"0n+"+e[2]||e[2]);e[2]=t[1]+(t[2]||1)-0,e[3]=t[3]-0}else e[2]&&b.error(e[0]);return e[0]=s++,e},ATTR:function(e,t,n,i,r,o){var s=e[1]=e[1].replace(l,"");return!o&&w.attrMap[s]&&(e[1]=w.attrMap[s]),e[4]=(e[4]||e[5]||"").replace(l,""),"~="===e[2]&&(e[4]=" "+e[4]+" "),e},PSEUDO:function(e,t,n,i,r){if("not"===e[1]){if(!(1<(v.exec(e[3])||"").length||/^\w/.test(e[3]))){var o=b.filter(e[3],t,n,!0^r);return n||i.push.apply(i,o),!1}e[3]=b(e[3],null,null,t)}else if(w.match.POS.test(e[0])||w.match.CHILD.test(e[0]))return!0;return e},POS:function(e){return e.unshift(!0),e}},filters:{enabled:function(e){return!1===e.disabled&&"hidden"!==e.type},disabled:function(e){return!0===e.disabled},checked:function(e){return!0===e.checked},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,!0===e.selected},parent:function(e){return!!e.firstChild},empty:function(e){return!e.firstChild},has:function(e,t,n){return!!b(n[3],e).length},header:function(e){return/h\d/i.test(e.nodeName)},text:function(e){var t=e.getAttribute("type"),n=e.type;return"input"===e.nodeName.toLowerCase()&&"text"===n&&(t===n||null===t)},radio:function(e){return"input"===e.nodeName.toLowerCase()&&"radio"===e.type},checkbox:function(e){return"input"===e.nodeName.toLowerCase()&&"checkbox"===e.type},file:function(e){return"input"===e.nodeName.toLowerCase()&&"file"===e.type},password:function(e){return"input"===e.nodeName.toLowerCase()&&"password"===e.type},submit:function(e){var t=e.nodeName.toLowerCase();return("input"===t||"button"===t)&&"submit"===e.type},image:function(e){return"input"===e.nodeName.toLowerCase()&&"image"===e.type},reset:function(e){var t=e.nodeName.toLowerCase();return("input"===t||"button"===t)&&"reset"===e.type},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},input:function(e){return/input|select|textarea|button/i.test(e.nodeName)},focus:function(e){return e===e.ownerDocument.activeElement}},setFilters:{first:function(e,t){return 0===t},last:function(e,t,n,i){return t===i.length-1},even:function(e,t){return t%2==0},odd:function(e,t){return t%2==1},lt:function(e,t,n){return t<n[3]-0},gt:function(e,t,n){return t>n[3]-0},nth:function(e,t,n){return n[3]-0===t},eq:function(e,t,n){return n[3]-0===t}},filter:{PSEUDO:function(e,t,n,i){var r=t[1],o=w.filters[r];if(o)return o(e,n,t,i);if("contains"===r)return 0<=(e.textContent||e.innerText||d([e])||"").indexOf(t[3]);if("not"===r){for(var s=t[3],a=0,c=s.length;a<c;a++)if(s[a]===e)return!1;return!0}b.error(r)},CHILD:function(e,t){var n,i,r,o,s,a,c=t[1],l=e;switch(c){case"only":case"first":for(;l=l.previousSibling;)if(1===l.nodeType)return!1;if("first"===c)return!0;l=e;case"last":for(;l=l.nextSibling;)if(1===l.nodeType)return!1;return!0;case"nth":if(n=t[2],i=t[3],1===n&&0===i)return!0;if(r=t[0],(o=e.parentNode)&&(o[u]!==r||!e.nodeIndex)){for(s=0,l=o.firstChild;l;l=l.nextSibling)1===l.nodeType&&(l.nodeIndex=++s);o[u]=r}return a=e.nodeIndex-i,0===n?0===a:a%n==0&&0<=a/n}},ID:function(e,t){return 1===e.nodeType&&e.getAttribute("id")===t},TAG:function(e,t){return"*"===t&&1===e.nodeType||!!e.nodeName&&e.nodeName.toLowerCase()===t},CLASS:function(e,t){return-1<(" "+(e.className||e.getAttribute("class"))+" ").indexOf(t)},ATTR:function(e,t){var n=t[1],i=b.attr?b.attr(e,n):w.attrHandle[n]?w.attrHandle[n](e):null!=e[n]?e[n]:e.getAttribute(n),r=i+"",o=t[2],s=t[4];return null==i?"!="===o:!o&&b.attr?null!=i:"="===o?r===s:"*="===o?0<=r.indexOf(s):"~="===o?0<=(" "+r+" ").indexOf(s):s?"!="===o?r!==s:"^="===o?0===r.indexOf(s):"$="===o?r.substr(r.length-s.length)===s:"|="===o&&(r===s||r.substr(0,s.length+1)===s+"-"):r&&!1!==i},POS:function(e,t,n,i){var r=t[2],o=w.setFilters[r];if(o)return o(e,n,t,i)}}},C=w.match.POS,e=function(e,t){return"\\"+(t-0+1)};for(var t in w.match)w.match[t]=new RegExp(w.match[t].source+/(?![^\[]*\])(?![^\(]*\))/.source),w.leftMatch[t]=new RegExp(/(^(?:.|\r|\n)*?)/.source+w.match[t].source.replace(/\\(\d+)/g,e));w.match.globalPOS=C;var i,p,r,a,f,g,m,_=function(e,t){return e=Array.prototype.slice.call(e,0),t?(t.push.apply(t,e),t):e};try{Array.prototype.slice.call(D.documentElement.childNodes,0)[0].nodeType}catch(e){_=function(e,t){var n=0,i=t||[];if("[object Array]"===y.call(e))Array.prototype.push.apply(i,e);else if("number"==typeof e.length)for(var r=e.length;n<r;n++)i.push(e[n]);else for(;e[n];n++)i.push(e[n]);return i}}function k(e,t,n,i,r,o){for(var s=0,a=i.length;s<a;s++){var c=i[s];if(c){var l=!1;for(c=c[e];c;){if(c[u]===n){l=i[c.sizset];break}if(1!==c.nodeType||o||(c[u]=n,c.sizset=s),c.nodeName.toLowerCase()===t){l=c;break}c=c[e]}i[s]=l}}}function T(e,t,n,i,r,o){for(var s=0,a=i.length;s<a;s++){var c=i[s];if(c){var l=!1;for(c=c[e];c;){if(c[u]===n){l=i[c.sizset];break}if(1===c.nodeType)if(o||(c[u]=n,c.sizset=s),"string"!=typeof t){if(c===t){l=!0;break}}else if(0<b.filter(t,[c]).length){l=c;break}c=c[e]}i[s]=l}}}D.documentElement.compareDocumentPosition?i=function(e,t){return e===t?(h=!0,0):e.compareDocumentPosition&&t.compareDocumentPosition?4&e.compareDocumentPosition(t)?-1:1:e.compareDocumentPosition?-1:1}:(i=function(e,t){if(e===t)return h=!0,0;if(e.sourceIndex&&t.sourceIndex)return e.sourceIndex-t.sourceIndex;var n,i,r=[],o=[],s=e.parentNode,a=t.parentNode,c=s;if(s===a)return p(e,t);if(!s)return-1;if(!a)return 1;for(;c;)r.unshift(c),c=c.parentNode;for(c=a;c;)o.unshift(c),c=c.parentNode;n=r.length,i=o.length;for(var l=0;l<n&&l<i;l++)if(r[l]!==o[l])return p(r[l],o[l]);return l===n?p(e,o[l],-1):p(r[l],t,1)},p=function(e,t,n){if(e===t)return n;for(var i=e.nextSibling;i;){if(i===t)return-1;i=i.nextSibling}return 1}),r=D.createElement("div"),a="script"+(new Date).getTime(),f=D.documentElement,r.innerHTML="<a name='"+a+"'/>",f.insertBefore(r,f.firstChild),D.getElementById(a)&&(w.find.ID=function(e,t,n){if(void 0!==t.getElementById&&!n){var i=t.getElementById(e[1]);return i?i.id===e[1]||void 0!==i.getAttributeNode&&i.getAttributeNode("id").nodeValue===e[1]?[i]:M:[]}},w.filter.ID=function(e,t){var n=void 0!==e.getAttributeNode&&e.getAttributeNode("id");return 1===e.nodeType&&n&&n.nodeValue===t}),f.removeChild(r),f=r=null,(g=D.createElement("div")).appendChild(D.createComment("")),0<g.getElementsByTagName("*").length&&(w.find.TAG=function(e,t){var n=t.getElementsByTagName(e[1]);if("*"===e[1]){for(var i=[],r=0;n[r];r++)1===n[r].nodeType&&i.push(n[r]);n=i}return n}),g.innerHTML="<a href='#'></a>",g.firstChild&&void 0!==g.firstChild.getAttribute&&"#"!==g.firstChild.getAttribute("href")&&(w.attrHandle.href=function(e){return e.getAttribute("href",2)}),g=null,D.querySelectorAll&&function(){var h=b,e=D.createElement("div");if(e.innerHTML="<p class='TEST'></p>",!e.querySelectorAll||0!==e.querySelectorAll(".TEST").length){for(var t in b=function(e,t,n,i){if(t=t||D,!i&&!b.isXML(t)){var r=/^(\w+$)|^\.([\w\-]+$)|^#([\w\-]+$)/.exec(e);if(r&&(1===t.nodeType||9===t.nodeType)){if(r[1])return _(t.getElementsByTagName(e),n);if(r[2]&&w.find.CLASS&&t.getElementsByClassName)return _(t.getElementsByClassName(r[2]),n)}if(9===t.nodeType){if("body"===e&&t.body)return _([t.body],n);if(r&&r[3]){var o=t.getElementById(r[3]);if(!o||!o.parentNode)return _([],n);if(o.id===r[3])return _([o],n)}try{return _(t.querySelectorAll(e),n)}catch(e){}}else if(1===t.nodeType&&"object"!==t.nodeName.toLowerCase()){var s=t,a=t.getAttribute("id"),c=a||"__sizzle__",l=t.parentNode,u=/^\s*[+~]/.test(e);a?c=c.replace(/'/g,"\\$&"):t.setAttribute("id",c),u&&l&&(t=t.parentNode);try{if(!u||l)return _(t.querySelectorAll("[id='"+c+"'] "+e),n)}catch(e){}finally{a||s.removeAttribute("id")}}}return h(e,t,n,i)},h)b[t]=h[t];e=null}}(),function(){var e=D.documentElement,i=e.matchesSelector||e.mozMatchesSelector||e.webkitMatchesSelector||e.msMatchesSelector;if(i){var r=!i.call(D.createElement("div"),"div"),o=!1;try{i.call(D.documentElement,"[test!='']:sizzle")}catch(e){o=!0}b.matchesSelector=function(e,t){if(t=t.replace(/\=\s*([^'"\]]*)\s*\]/g,"='$1']"),!b.isXML(e))try{if(o||!w.match.PSEUDO.test(t)&&!/!=/.test(t)){var n=i.call(e,t);if(n||!r||e.document&&11!==e.document.nodeType)return n}}catch(e){}return 0<b(t,null,null,[e]).length}}}(),(m=D.createElement("div")).innerHTML="<div class='test e'></div><div class='test'></div>",m.getElementsByClassName&&0!==m.getElementsByClassName("e").length&&(m.lastChild.className="e",1!==m.getElementsByClassName("e").length&&(w.order.splice(1,0,"CLASS"),w.find.CLASS=function(e,t,n){if(void 0!==t.getElementsByClassName&&!n)return t.getElementsByClassName(e[1])},m=null)),D.documentElement.contains?b.contains=function(e,t){return e!==t&&(!e.contains||e.contains(t))}:D.documentElement.compareDocumentPosition?b.contains=function(e,t){return!!(16&e.compareDocumentPosition(t))}:b.contains=function(){return!1},b.isXML=function(e){var t=(e?e.ownerDocument||e:0).documentElement;return!!t&&"HTML"!==t.nodeName};var S=function(e,t,n){for(var i,r=[],o="",s=t.nodeType?[t]:t;i=w.match.PSEUDO.exec(e);)o+=i[0],e=e.replace(w.match.PSEUDO,"");e=w.relative[e]?e+"*":e;for(var a=0,c=s.length;a<c;a++)b(e,s[a],r,n);return b.filter(o,r)};b.attr=x.attr,b.selectors.attrMap={},x.find=b,x.expr=b.selectors,x.expr[":"]=x.expr.filters,x.unique=b.uniqueSort,x.text=b.getText,x.isXMLDoc=b.isXML,x.contains=b.contains}();var A=/Until$/,O=/^(?:parents|prevUntil|prevAll)/,B=/,/,R=/^.[^:#\[\.,]*$/,j=Array.prototype.slice,U=x.expr.match.globalPOS,z={children:!0,contents:!0,next:!0,prev:!0};function F(e){return!e||!e.parentNode||11===e.parentNode.nodeType}function V(e,n,i){if(n=n||0,x.isFunction(n))return x.grep(e,function(e,t){return!!n.call(e,t,e)===i});if(n.nodeType)return x.grep(e,function(e,t){return e===n===i});if("string"==typeof n){var t=x.grep(e,function(e){return 1===e.nodeType});if(R.test(n))return x.filter(n,t,!i);n=x.filter(n,t)}return x.grep(e,function(e,t){return 0<=x.inArray(e,n)===i})}function H(e){var t=q.split("|"),n=e.createDocumentFragment();if(n.createElement)for(;t.length;)n.createElement(t.pop());return n}x.fn.extend({find:function(e){var t,n,i=this;if("string"!=typeof e)return x(e).filter(function(){for(t=0,n=i.length;t<n;t++)if(x.contains(i[t],this))return!0});var r,o,s,a=this.pushStack("","find",e);for(t=0,n=this.length;t<n;t++)if(r=a.length,x.find(e,this[t],a),0<t)for(o=r;o<a.length;o++)for(s=0;s<r;s++)if(a[s]===a[o]){a.splice(o--,1);break}return a},has:function(e){var n=x(e);return this.filter(function(){for(var e=0,t=n.length;e<t;e++)if(x.contains(this,n[e]))return!0})},not:function(e){return this.pushStack(V(this,e,!1),"not",e)},filter:function(e){return this.pushStack(V(this,e,!0),"filter",e)},is:function(e){return!!e&&("string"==typeof e?U.test(e)?0<=x(e,this.context).index(this[0]):0<x.filter(e,this).length:0<this.filter(e).length)},closest:function(e,t){var n,i,r=[],o=this[0];if(x.isArray(e)){for(var s=1;o&&o.ownerDocument&&o!==t;){for(n=0;n<e.length;n++)x(o).is(e[n])&&r.push({selector:e[n],elem:o,level:s});o=o.parentNode,s++}return r}var a=U.test(e)||"string"!=typeof e?x(e,t||this.context):0;for(n=0,i=this.length;n<i;n++)for(o=this[n];o;){if(a?-1<a.index(o):x.find.matchesSelector(o,e)){r.push(o);break}if(!(o=o.parentNode)||!o.ownerDocument||o===t||11===o.nodeType)break}return r=1<r.length?x.unique(r):r,this.pushStack(r,"closest",e)},index:function(e){return e?"string"==typeof e?x.inArray(this[0],x(e)):x.inArray(e.jquery?e[0]:e,this):this[0]&&this[0].parentNode?this.prevAll().length:-1},add:function(e,t){var n="string"==typeof e?x(e,t):x.makeArray(e&&e.nodeType?[e]:e),i=x.merge(this.get(),n);return this.pushStack(F(n[0])||F(i[0])?i:x.unique(i))},andSelf:function(){return this.add(this.prevObject)}}),x.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return x.dir(e,"parentNode")},parentsUntil:function(e,t,n){return x.dir(e,"parentNode",n)},next:function(e){return x.nth(e,2,"nextSibling")},prev:function(e){return x.nth(e,2,"previousSibling")},nextAll:function(e){return x.dir(e,"nextSibling")},prevAll:function(e){return x.dir(e,"previousSibling")},nextUntil:function(e,t,n){return x.dir(e,"nextSibling",n)},prevUntil:function(e,t,n){return x.dir(e,"previousSibling",n)},siblings:function(e){return x.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return x.sibling(e.firstChild)},contents:function(e){return x.nodeName(e,"iframe")?e.contentDocument||e.contentWindow.document:x.makeArray(e.childNodes)}},function(i,r){x.fn[i]=function(e,t){var n=x.map(this,r,e);return A.test(i)||(t=e),t&&"string"==typeof t&&(n=x.filter(t,n)),n=1<this.length&&!z[i]?x.unique(n):n,(1<this.length||B.test(t))&&O.test(i)&&(n=n.reverse()),this.pushStack(n,i,j.call(arguments).join(","))}}),x.extend({filter:function(e,t,n){return n&&(e=":not("+e+")"),1===t.length?x.find.matchesSelector(t[0],e)?[t[0]]:[]:x.find.matches(e,t)},dir:function(e,t,n){for(var i=[],r=e[t];r&&9!==r.nodeType&&(n===M||1!==r.nodeType||!x(r).is(n));)1===r.nodeType&&i.push(r),r=r[t];return i},nth:function(e,t,n,i){t=t||1;for(var r=0;e&&(1!==e.nodeType||++r!==t);e=e[n]);return e},sibling:function(e,t){for(var n=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n}});var q="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",W=/ jQuery\d+="(?:\d+|null)"/g,G=/^\s+/,J=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,X=/<([\w:]+)/,K=/<tbody/i,$=/<|&#?\w+;/,Q=/<(?:script|style)/i,Y=/<(?:script|object|embed|option|style)/i,Z=new RegExp("<(?:"+q+")[\\s/>]","i"),ee=/checked\s*(?:[^=]|=\s*.checked.)/i,te=/\/(java|ecma)script/i,ne=/^\s*<!(?:\[CDATA\[|\-\-)/,ie={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],area:[1,"<map>","</map>"],_default:[0,"",""]},re=H(D);function oe(e,t){if(1===t.nodeType&&x.hasData(e)){var n,i,r,o=x._data(e),s=x._data(t,o),a=o.events;if(a)for(n in delete s.handle,s.events={},a)for(i=0,r=a[n].length;i<r;i++)x.event.add(t,n,a[n][i]);s.data&&(s.data=x.extend({},s.data))}}function se(e,t){var n;1===t.nodeType&&(t.clearAttributes&&t.clearAttributes(),t.mergeAttributes&&t.mergeAttributes(e),"object"===(n=t.nodeName.toLowerCase())?t.outerHTML=e.outerHTML:"input"!==n||"checkbox"!==e.type&&"radio"!==e.type?"option"===n?t.selected=e.defaultSelected:"input"===n||"textarea"===n?t.defaultValue=e.defaultValue:"script"===n&&t.text!==e.text&&(t.text=e.text):(e.checked&&(t.defaultChecked=t.checked=e.checked),t.value!==e.value&&(t.value=e.value)),t.removeAttribute(x.expando),t.removeAttribute("_submit_attached"),t.removeAttribute("_change_attached"))}function ae(e){return void 0!==e.getElementsByTagName?e.getElementsByTagName("*"):void 0!==e.querySelectorAll?e.querySelectorAll("*"):[]}function ce(e){"checkbox"!==e.type&&"radio"!==e.type||(e.defaultChecked=e.checked)}function le(e){var t=(e.nodeName||"").toLowerCase();"input"===t?ce(e):"script"!==t&&void 0!==e.getElementsByTagName&&x.grep(e.getElementsByTagName("input"),ce)}ie.optgroup=ie.option,ie.tbody=ie.tfoot=ie.colgroup=ie.caption=ie.thead,ie.th=ie.td,x.support.htmlSerialize||(ie._default=[1,"div<div>","</div>"]),x.fn.extend({text:function(e){return x.access(this,function(e){return e===M?x.text(this):this.empty().append((this[0]&&this[0].ownerDocument||D).createTextNode(e))},null,e,arguments.length)},wrapAll:function(t){if(x.isFunction(t))return this.each(function(e){x(this).wrapAll(t.call(this,e))});if(this[0]){var e=x(t,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&e.insertBefore(this[0]),e.map(function(){for(var e=this;e.firstChild&&1===e.firstChild.nodeType;)e=e.firstChild;return e}).append(this)}return this},wrapInner:function(n){return x.isFunction(n)?this.each(function(e){x(this).wrapInner(n.call(this,e))}):this.each(function(){var e=x(this),t=e.contents();t.length?t.wrapAll(n):e.append(n)})},wrap:function(t){var n=x.isFunction(t);return this.each(function(e){x(this).wrapAll(n?t.call(this,e):t)})},unwrap:function(){return this.parent().each(function(){x.nodeName(this,"body")||x(this).replaceWith(this.childNodes)}).end()},append:function(){return this.domManip(arguments,!0,function(e){1===this.nodeType&&this.appendChild(e)})},prepend:function(){return this.domManip(arguments,!0,function(e){1===this.nodeType&&this.insertBefore(e,this.firstChild)})},before:function(){if(this[0]&&this[0].parentNode)return this.domManip(arguments,!1,function(e){this.parentNode.insertBefore(e,this)});if(arguments.length){var e=x.clean(arguments);return e.push.apply(e,this.toArray()),this.pushStack(e,"before",arguments)}},after:function(){if(this[0]&&this[0].parentNode)return this.domManip(arguments,!1,function(e){this.parentNode.insertBefore(e,this.nextSibling)});if(arguments.length){var e=this.pushStack(this,"after",arguments);return e.push.apply(e,x.clean(arguments)),e}},remove:function(e,t){for(var n,i=0;null!=(n=this[i]);i++)e&&!x.filter(e,[n]).length||(t||1!==n.nodeType||(x.cleanData(n.getElementsByTagName("*")),x.cleanData([n])),n.parentNode&&n.parentNode.removeChild(n));return this},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)for(1===e.nodeType&&x.cleanData(e.getElementsByTagName("*"));e.firstChild;)e.removeChild(e.firstChild);return this},clone:function(e,t){return e=null!=e&&e,t=null==t?e:t,this.map(function(){return x.clone(this,e,t)})},html:function(e){return x.access(this,function(e){var t=this[0]||{},n=0,i=this.length;if(e===M)return 1===t.nodeType?t.innerHTML.replace(W,""):null;if("string"==typeof e&&!Q.test(e)&&(x.support.leadingWhitespace||!G.test(e))&&!ie[(X.exec(e)||["",""])[1].toLowerCase()]){e=e.replace(J,"<$1></$2>");try{for(;n<i;n++)1===(t=this[n]||{}).nodeType&&(x.cleanData(t.getElementsByTagName("*")),t.innerHTML=e);t=0}catch(e){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(i){return this[0]&&this[0].parentNode?x.isFunction(i)?this.each(function(e){var t=x(this),n=t.html();t.replaceWith(i.call(this,e,n))}):("string"!=typeof i&&(i=x(i).detach()),this.each(function(){var e=this.nextSibling,t=this.parentNode;x(this).remove(),e?x(e).before(i):x(t).append(i)})):this.length?this.pushStack(x(x.isFunction(i)?i():i),"replaceWith",i):this},detach:function(e){return this.remove(e,!0)},domManip:function(n,i,r){var e,t,o,s,a,c=n[0],l=[];if(!x.support.checkClone&&3===arguments.length&&"string"==typeof c&&ee.test(c))return this.each(function(){x(this).domManip(n,i,r,!0)});if(x.isFunction(c))return this.each(function(e){var t=x(this);n[0]=c.call(this,e,i?t.html():M),t.domManip(n,i,r)});if(this[0]){if(s=c&&c.parentNode,t=1===(o=(e=x.support.parentNode&&s&&11===s.nodeType&&s.childNodes.length===this.length?{fragment:s}:x.buildFragment(n,this,l)).fragment).childNodes.length?o=o.firstChild:o.firstChild){i=i&&x.nodeName(t,"tr");for(var u=0,h=this.length,d=h-1;u<h;u++)r.call(i?(a=this[u],t,x.nodeName(a,"table")?a.getElementsByTagName("tbody")[0]||a.appendChild(a.ownerDocument.createElement("tbody")):a):this[u],e.cacheable||1<h&&u<d?x.clone(o,!0,!0):o)}l.length&&x.each(l,function(e,t){t.src?x.ajax({type:"GET",global:!1,url:t.src,async:!1,dataType:"script"}):x.globalEval((t.text||t.textContent||t.innerHTML||"").replace(ne,"/*$0*/")),t.parentNode&&t.parentNode.removeChild(t)})}return this}}),x.buildFragment=function(e,t,n){var i,r,o,s,a=e[0];return t&&t[0]&&(s=t[0].ownerDocument||t[0]),s.createDocumentFragment||(s=D),!(1===e.length&&"string"==typeof a&&a.length<512&&s===D&&"<"===a.charAt(0))||Y.test(a)||!x.support.checkClone&&ee.test(a)||!x.support.html5Clone&&Z.test(a)||(r=!0,(o=x.fragments[a])&&1!==o&&(i=o)),i||(i=s.createDocumentFragment(),x.clean(e,s,i,n)),r&&(x.fragments[a]=o?i:1),{fragment:i,cacheable:r}},x.fragments={},x.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(a,c){x.fn[a]=function(e){var t=[],n=x(e),i=1===this.length&&this[0].parentNode;if(i&&11===i.nodeType&&1===i.childNodes.length&&1===n.length)return n[c](this[0]),this;for(var r=0,o=n.length;r<o;r++){var s=(0<r?this.clone(!0):this).get();x(n[r])[c](s),t=t.concat(s)}return this.pushStack(t,a,n.selector)}}),x.extend({clone:function(e,t,n){var i,r,o,s,a,c=x.support.html5Clone||x.isXMLDoc(e)||!Z.test("<"+e.nodeName+">")?e.cloneNode(!0):(s=e,a=D.createElement("div"),re.appendChild(a),a.innerHTML=s.outerHTML,a.firstChild);if(!(x.support.noCloneEvent&&x.support.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||x.isXMLDoc(e)))for(se(e,c),i=ae(e),r=ae(c),o=0;i[o];++o)r[o]&&se(i[o],r[o]);if(t&&(oe(e,c),n))for(i=ae(e),r=ae(c),o=0;i[o];++o)oe(i[o],r[o]);return i=r=null,c},clean:function(e,t,n,i){var r,o,s,a=[];void 0===(t=t||D).createElement&&(t=t.ownerDocument||t[0]&&t[0].ownerDocument||D);for(var c,l=0;null!=(c=e[l]);l++)if("number"==typeof c&&(c+=""),c){if("string"==typeof c)if($.test(c)){c=c.replace(J,"<$1></$2>");var u,h=(X.exec(c)||["",""])[1].toLowerCase(),d=ie[h]||ie._default,p=d[0],f=t.createElement("div"),g=re.childNodes;for(t===D?re.appendChild(f):H(t).appendChild(f),f.innerHTML=d[1]+c+d[2];p--;)f=f.lastChild;if(!x.support.tbody){var m=K.test(c),v="table"!==h||m?"<table>"!==d[1]||m?[]:f.childNodes:f.firstChild&&f.firstChild.childNodes;for(s=v.length-1;0<=s;--s)x.nodeName(v[s],"tbody")&&!v[s].childNodes.length&&v[s].parentNode.removeChild(v[s])}!x.support.leadingWhitespace&&G.test(c)&&f.insertBefore(t.createTextNode(G.exec(c)[0]),f.firstChild),c=f.childNodes,f&&(f.parentNode.removeChild(f),0<g.length&&(u=g[g.length-1])&&u.parentNode&&u.parentNode.removeChild(u))}else c=t.createTextNode(c);var y;if(!x.support.appendChecked)if(c[0]&&"number"==typeof(y=c.length))for(s=0;s<y;s++)le(c[s]);else le(c);c.nodeType?a.push(c):a=x.merge(a,c)}if(n)for(r=function(e){return!e.type||te.test(e.type)},l=0;a[l];l++)if(o=a[l],i&&x.nodeName(o,"script")&&(!o.type||te.test(o.type)))i.push(o.parentNode?o.parentNode.removeChild(o):o);else{if(1===o.nodeType){var b=x.grep(o.getElementsByTagName("script"),r);a.splice.apply(a,[l+1,0].concat(b))}n.appendChild(o)}return a},cleanData:function(e){for(var t,n,i,r=x.cache,o=x.event.special,s=x.support.deleteExpando,a=0;null!=(i=e[a]);a++)if((!i.nodeName||!x.noData[i.nodeName.toLowerCase()])&&(n=i[x.expando])){if((t=r[n])&&t.events){for(var c in t.events)o[c]?x.event.remove(i,c):x.removeEvent(i,c,t.handle);t.handle&&(t.handle.elem=null)}s?delete i[x.expando]:i.removeAttribute&&i.removeAttribute(x.expando),delete r[n]}}});var ue,he,de,pe=/alpha\([^)]*\)/i,fe=/opacity=([^)]*)/,ge=/([A-Z]|^ms)/g,me=/^[\-+]?(?:\d*\.)?\d+$/i,ve=/^-?(?:\d*\.)?\d+(?!px)[^\d\s]+$/i,ye=/^([\-+])=([\-+.\de]+)/,be=/^margin/,we={position:"absolute",visibility:"hidden",display:"block"},Ce=["Top","Right","Bottom","Left"];function _e(e,t,n){var i="width"===t?e.offsetWidth:e.offsetHeight,r="width"===t?1:0;if(0<i){if("border"!==n)for(;r<4;r+=2)n||(i-=parseFloat(x.css(e,"padding"+Ce[r]))||0),"margin"===n?i+=parseFloat(x.css(e,n+Ce[r]))||0:i-=parseFloat(x.css(e,"border"+Ce[r]+"Width"))||0;return i+"px"}if(((i=ue(e,t))<0||null==i)&&(i=e.style[t]),ve.test(i))return i;if(i=parseFloat(i)||0,n)for(;r<4;r+=2)i+=parseFloat(x.css(e,"padding"+Ce[r]))||0,"padding"!==n&&(i+=parseFloat(x.css(e,"border"+Ce[r]+"Width"))||0),"margin"===n&&(i+=parseFloat(x.css(e,n+Ce[r]))||0);return i+"px"}x.fn.css=function(e,t){return x.access(this,function(e,t,n){return n!==M?x.style(e,t,n):x.css(e,t)},e,t,1<arguments.length)},x.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=ue(e,"opacity");return""===n?"1":n}return e.style.opacity}}},cssNumber:{fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{float:x.support.cssFloat?"cssFloat":"styleFloat"},style:function(e,t,n,i){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var r,o,s=x.camelCase(t),a=e.style,c=x.cssHooks[s];if(t=x.cssProps[s]||s,n===M)return c&&"get"in c&&(r=c.get(e,!1,i))!==M?r:a[t];if(!("string"===(o=typeof n)&&(r=ye.exec(n))&&(n=+(r[1]+1)*+r[2]+parseFloat(x.css(e,t)),o="number"),null==n||"number"===o&&isNaN(n)||("number"!==o||x.cssNumber[s]||(n+="px"),c&&"set"in c&&(n=c.set(e,n))===M)))try{a[t]=n}catch(e){}}},css:function(e,t,n){var i,r;return t=x.camelCase(t),r=x.cssHooks[t],"cssFloat"===(t=x.cssProps[t]||t)&&(t="float"),r&&"get"in r&&(i=r.get(e,!0,n))!==M?i:ue?ue(e,t):void 0},swap:function(e,t,n){var i,r,o={};for(r in t)o[r]=e.style[r],e.style[r]=t[r];for(r in i=n.call(e),t)e.style[r]=o[r];return i}}),x.curCSS=x.css,D.defaultView&&D.defaultView.getComputedStyle&&(he=function(e,t){var n,i,r,o,s=e.style;return t=t.replace(ge,"-$1").toLowerCase(),(i=e.ownerDocument.defaultView)&&(r=i.getComputedStyle(e,null))&&(""!==(n=r.getPropertyValue(t))||x.contains(e.ownerDocument.documentElement,e)||(n=x.style(e,t))),!x.support.pixelMargin&&r&&be.test(t)&&ve.test(n)&&(o=s.width,s.width=n,n=r.width,s.width=o),n}),D.documentElement.currentStyle&&(de=function(e,t){var n,i,r,o=e.currentStyle&&e.currentStyle[t],s=e.style;return null==o&&s&&(r=s[t])&&(o=r),ve.test(o)&&(n=s.left,(i=e.runtimeStyle&&e.runtimeStyle.left)&&(e.runtimeStyle.left=e.currentStyle.left),s.left="fontSize"===t?"1em":o,o=s.pixelLeft+"px",s.left=n,i&&(e.runtimeStyle.left=i)),""===o?"auto":o}),ue=he||de,x.each(["height","width"],function(e,i){x.cssHooks[i]={get:function(e,t,n){if(t)return 0!==e.offsetWidth?_e(e,i,n):x.swap(e,we,function(){return _e(e,i,n)})},set:function(e,t){return me.test(t)?t+"px":t}}}),x.support.opacity||(x.cssHooks.opacity={get:function(e,t){return fe.test((t&&e.currentStyle?e.currentStyle.filter:e.style.filter)||"")?parseFloat(RegExp.$1)/100+"":t?"1":""},set:function(e,t){var n=e.style,i=e.currentStyle,r=x.isNumeric(t)?"alpha(opacity="+100*t+")":"",o=i&&i.filter||n.filter||"";(n.zoom=1)<=t&&""===x.trim(o.replace(pe,""))&&(n.removeAttribute("filter"),i&&!i.filter)||(n.filter=pe.test(o)?o.replace(pe,r):o+" "+r)}}),x(function(){x.support.reliableMarginRight||(x.cssHooks.marginRight={get:function(e,t){return x.swap(e,{display:"inline-block"},function(){return t?ue(e,"margin-right"):e.style.marginRight})}})}),x.expr&&x.expr.filters&&(x.expr.filters.hidden=function(e){var t=e.offsetWidth,n=e.offsetHeight;return 0===t&&0===n||!x.support.reliableHiddenOffsets&&"none"===(e.style&&e.style.display||x.css(e,"display"))},x.expr.filters.visible=function(e){return!x.expr.filters.hidden(e)}),x.each({margin:"",padding:"",border:"Width"},function(r,o){x.cssHooks[r+o]={expand:function(e){var t,n="string"==typeof e?e.split(" "):[e],i={};for(t=0;t<4;t++)i[r+Ce[t]+o]=n[t]||n[t-2]||n[0];return i}}});var ke,Te,Se=/%20/g,xe=/\[\]$/,Ee=/\r?\n/g,Ne=/#.*$/,Pe=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,Ae=/^(?:color|date|datetime|datetime-local|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i,Oe=/^(?:GET|HEAD)$/,Ie=/^\/\//,Me=/\?/,De=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,Le=/^(?:select|textarea)/i,Be=/\s+/,Re=/([?&])_=[^&]*/,je=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+))?)?/,Ue=x.fn.load,ze={},Fe={},Ve=["*/"]+["*"];try{ke=e.href}catch(e){(ke=D.createElement("a")).href="",ke=ke.href}function He(a){return function(e,t){if("string"!=typeof e&&(t=e,e="*"),x.isFunction(t))for(var n,i,r=e.toLowerCase().split(Be),o=0,s=r.length;o<s;o++)n=r[o],(i=/^\+/.test(n))&&(n=n.substr(1)||"*"),(a[n]=a[n]||[])[i?"unshift":"push"](t)}}function qe(e,t,n,i,r,o){(o=o||{})[r=r||t.dataTypes[0]]=!0;for(var s,a=e[r],c=0,l=a?a.length:0,u=e===ze;c<l&&(u||!s);c++)"string"==typeof(s=a[c](t,n,i))&&(s=!u||o[s]?M:(t.dataTypes.unshift(s),qe(e,t,n,i,s,o)));return!u&&s||o["*"]||(s=qe(e,t,n,i,"*",o)),s}function We(e,t){var n,i,r=x.ajaxSettings.flatOptions||{};for(n in t)t[n]!==M&&((r[n]?e:i||(i={}))[n]=t[n]);i&&x.extend(!0,e,i)}function Ge(n,e,i,r){if(x.isArray(e))x.each(e,function(e,t){i||xe.test(n)?r(n,t):Ge(n+"["+("object"==typeof t?e:"")+"]",t,i,r)});else if(i||"object"!==x.type(e))r(n,e);else for(var t in e)Ge(n+"["+t+"]",e[t],i,r)}Te=je.exec(ke.toLowerCase())||[],x.fn.extend({load:function(e,t,i){if("string"!=typeof e&&Ue)return Ue.apply(this,arguments);if(!this.length)return this;var n=e.indexOf(" ");if(0<=n){var r=e.slice(n,e.length);e=e.slice(0,n)}var o="GET";t&&(x.isFunction(t)?(i=t,t=M):"object"==typeof t&&(t=x.param(t,x.ajaxSettings.traditional),o="POST"));var s=this;return x.ajax({url:e,type:o,dataType:"html",data:t,complete:function(e,t,n){n=e.responseText,e.isResolved()&&(e.done(function(e){n=e}),s.html(r?x("<div>").append(n.replace(De,"")).find(r):n)),i&&s.each(i,[n,t,e])}}),this},serialize:function(){return x.param(this.serializeArray())},serializeArray:function(){return this.map(function(){return this.elements?x.makeArray(this.elements):this}).filter(function(){return this.name&&!this.disabled&&(this.checked||Le.test(this.nodeName)||Ae.test(this.type))}).map(function(e,n){var t=x(this).val();return null==t?null:x.isArray(t)?x.map(t,function(e,t){return{name:n.name,value:e.replace(Ee,"\r\n")}}):{name:n.name,value:t.replace(Ee,"\r\n")}}).get()}}),x.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(e,t){x.fn[t]=function(e){return this.on(t,e)}}),x.each(["get","post"],function(e,r){x[r]=function(e,t,n,i){return x.isFunction(t)&&(i=i||n,n=t,t=M),x.ajax({type:r,url:e,data:t,success:n,dataType:i})}}),x.extend({getScript:function(e,t){return x.get(e,M,t,"script")},getJSON:function(e,t,n){return x.get(e,t,n,"json")},ajaxSetup:function(e,t){return t?We(e,x.ajaxSettings):(t=e,e=x.ajaxSettings),We(e,t),e},ajaxSettings:{url:ke,isLocal:/^(?:about|app|app\-storage|.+\-extension|file|res|widget):$/.test(Te[1]),global:!0,type:"GET",contentType:"application/x-www-form-urlencoded; charset=UTF-8",processData:!0,async:!0,accepts:{xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":Ve},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":I.String,"text html":!0,"text json":x.parseJSON,"text xml":x.parseXML},flatOptions:{context:!0,url:!0}},ajaxPrefilter:He(ze),ajaxTransport:He(Fe),ajax:function(e,t){"object"==typeof e&&(t=e,e=M),t=t||{};var h,d,n,p,f,i,g,r,m=x.ajaxSetup({},t),v=m.context||m,y=v!==m&&(v.nodeType||v instanceof x)?x(v):x.event,b=x.Deferred(),w=x.Callbacks("once memory"),C=m.statusCode||{},o={},s={},_=0,k={readyState:0,setRequestHeader:function(e,t){if(!_){var n=e.toLowerCase();e=s[n]=s[n]||e,o[e]=t}return this},getAllResponseHeaders:function(){return 2===_?d:null},getResponseHeader:function(e){var t;if(2===_){if(!n)for(n={};t=Pe.exec(d);)n[t[1].toLowerCase()]=t[2];t=n[e.toLowerCase()]}return t===M?null:t},overrideMimeType:function(e){return _||(m.mimeType=e),this},abort:function(e){return e=e||"abort",p&&p.abort(e),a(0,e),this}};function a(e,t,n,i){if(2!==_){_=2,f&&clearTimeout(f),p=M,d=i||"",k.readyState=0<e?4:0;var r,o,s,a,c,l=t,u=n?function(e,t,n){var i,r,o,s,a=e.contents,c=e.dataTypes,l=e.responseFields;for(r in l)r in n&&(t[l[r]]=n[r]);for(;"*"===c[0];)c.shift(),i===M&&(i=e.mimeType||t.getResponseHeader("content-type"));if(i)for(r in a)if(a[r]&&a[r].test(i)){c.unshift(r);break}if(c[0]in n)o=c[0];else{for(r in n){if(!c[0]||e.converters[r+" "+c[0]]){o=r;break}s||(s=r)}o=o||s}if(o)return o!==c[0]&&c.unshift(o),n[o]}(m,k,n):M;if(200<=e&&e<300||304===e)if(m.ifModified&&((a=k.getResponseHeader("Last-Modified"))&&(x.lastModified[h]=a),(c=k.getResponseHeader("Etag"))&&(x.etag[h]=c)),304===e)l="notmodified",r=!0;else try{o=function(e,t){e.dataFilter&&(t=e.dataFilter(t,e.dataType));var n,i,r,o,s,a,c,l,u=e.dataTypes,h={},d=u.length,p=u[0];for(n=1;n<d;n++){if(1===n)for(i in e.converters)"string"==typeof i&&(h[i.toLowerCase()]=e.converters[i]);if(o=p,"*"===(p=u[n]))p=o;else if("*"!==o&&o!==p){if(!(a=h[s=o+" "+p]||h["* "+p]))for(c in l=M,h)if(((r=c.split(" "))[0]===o||"*"===r[0])&&(l=h[r[1]+" "+p])){!0===(c=h[c])?a=l:!0===l&&(a=c);break}a||l||x.error("No conversion from "+s.replace(" "," to ")),!0!==a&&(t=a?a(t):l(c(t)))}}return t}(m,u),l="success",r=!0}catch(e){l="parsererror",s=e}else(s=l)&&!e||(l="error",e<0&&(e=0));k.status=e,k.statusText=""+(t||l),r?b.resolveWith(v,[o,l,k]):b.rejectWith(v,[k,l,s]),k.statusCode(C),C=M,g&&y.trigger("ajax"+(r?"Success":"Error"),[k,m,r?o:s]),w.fireWith(v,[k,l]),g&&(y.trigger("ajaxComplete",[k,m]),--x.active||x.event.trigger("ajaxStop"))}}if(b.promise(k),k.success=k.done,k.error=k.fail,k.complete=w.add,k.statusCode=function(e){var t;if(e)if(_<2)for(t in e)C[t]=[C[t],e[t]];else t=e[k.status],k.then(t,t);return this},m.url=((e||m.url)+"").replace(Ne,"").replace(Ie,Te[1]+"//"),m.dataTypes=x.trim(m.dataType||"*").toLowerCase().split(Be),null==m.crossDomain&&(i=je.exec(m.url.toLowerCase()),m.crossDomain=!(!i||i[1]==Te[1]&&i[2]==Te[2]&&(i[3]||("http:"===i[1]?80:443))==(Te[3]||("http:"===Te[1]?80:443)))),m.data&&m.processData&&"string"!=typeof m.data&&(m.data=x.param(m.data,m.traditional)),qe(ze,m,t,k),2===_)return!1;if(g=m.global,m.type=m.type.toUpperCase(),m.hasContent=!Oe.test(m.type),g&&0==x.active++&&x.event.trigger("ajaxStart"),!m.hasContent&&(m.data&&(m.url+=(Me.test(m.url)?"&":"?")+m.data,delete m.data),h=m.url,!1===m.cache)){var c=x.now(),l=m.url.replace(Re,"$1_="+c);m.url=l+(l===m.url?(Me.test(m.url)?"&":"?")+"_="+c:"")}for(r in(m.data&&m.hasContent&&!1!==m.contentType||t.contentType)&&k.setRequestHeader("Content-Type",m.contentType),m.ifModified&&(h=h||m.url,x.lastModified[h]&&k.setRequestHeader("If-Modified-Since",x.lastModified[h]),x.etag[h]&&k.setRequestHeader("If-None-Match",x.etag[h])),k.setRequestHeader("Accept",m.dataTypes[0]&&m.accepts[m.dataTypes[0]]?m.accepts[m.dataTypes[0]]+("*"!==m.dataTypes[0]?", "+Ve+"; q=0.01":""):m.accepts["*"]),m.headers)k.setRequestHeader(r,m.headers[r]);if(m.beforeSend&&(!1===m.beforeSend.call(v,k,m)||2===_))return k.abort(),!1;for(r in{success:1,error:1,complete:1})k[r](m[r]);if(p=qe(Fe,m,t,k)){k.readyState=1,g&&y.trigger("ajaxSend",[k,m]),m.async&&0<m.timeout&&(f=setTimeout(function(){k.abort("timeout")},m.timeout));try{_=1,p.send(o,a)}catch(e){if(!(_<2))throw e;a(-1,e)}}else a(-1,"No Transport");return k},param:function(e,t){var n=[],i=function(e,t){t=x.isFunction(t)?t():t,n[n.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};if(t===M&&(t=x.ajaxSettings.traditional),x.isArray(e)||e.jquery&&!x.isPlainObject(e))x.each(e,function(){i(this.name,this.value)});else for(var r in e)Ge(r,e[r],t,i);return n.join("&").replace(Se,"+")}}),x.extend({active:0,lastModified:{},etag:{}});var Je=x.now(),Xe=/(\=)\?(&|$)|\?\?/i;x.ajaxSetup({jsonp:"callback",jsonpCallback:function(){return x.expando+"_"+Je++}}),x.ajaxPrefilter("json jsonp",function(e,t,n){var i="string"==typeof e.data&&/^application\/x\-www\-form\-urlencoded/.test(e.contentType);if("jsonp"===e.dataTypes[0]||!1!==e.jsonp&&(Xe.test(e.url)||i&&Xe.test(e.data))){var r,o=e.jsonpCallback=x.isFunction(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,s=I[o],a=e.url,c=e.data,l="$1"+o+"$2";return!1!==e.jsonp&&(a=a.replace(Xe,l),e.url===a&&(i&&(c=c.replace(Xe,l)),e.data===c&&(a+=(/\?/.test(a)?"&":"?")+e.jsonp+"="+o))),e.url=a,e.data=c,I[o]=function(e){r=[e]},n.always(function(){I[o]=s,r&&x.isFunction(s)&&I[o](r[0])}),e.converters["script json"]=function(){return r||x.error(o+" was not called"),r[0]},e.dataTypes[0]="json","script"}}),x.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/javascript|ecmascript/},converters:{"text script":function(e){return x.globalEval(e),e}}}),x.ajaxPrefilter("script",function(e){e.cache===M&&(e.cache=!1),e.crossDomain&&(e.type="GET",e.global=!1)}),x.ajaxTransport("script",function(t){if(t.crossDomain){var i,r=D.head||D.getElementsByTagName("head")[0]||D.documentElement;return{send:function(e,n){(i=D.createElement("script")).async="async",t.scriptCharset&&(i.charset=t.scriptCharset),i.src=t.url,i.onload=i.onreadystatechange=function(e,t){(t||!i.readyState||/loaded|complete/.test(i.readyState))&&(i.onload=i.onreadystatechange=null,r&&i.parentNode&&r.removeChild(i),i=M,t||n(200,"success"))},r.insertBefore(i,r.firstChild)},abort:function(){i&&i.onload(0,1)}}}});var Ke,$e,Qe=!!I.ActiveXObject&&function(){for(var e in Ke)Ke[e](0,1)},Ye=0;function Ze(){try{return new I.XMLHttpRequest}catch(e){}}x.ajaxSettings.xhr=I.ActiveXObject?function(){return!this.isLocal&&Ze()||function(){try{return new I.ActiveXObject("Microsoft.XMLHTTP")}catch(e){}}()}:Ze,$e=x.ajaxSettings.xhr(),x.extend(x.support,{ajax:!!$e,cors:!!$e&&"withCredentials"in $e}),x.support.ajax&&x.ajaxTransport(function(u){var h;if(!u.crossDomain||x.support.cors)return{send:function(e,a){var c,t,l=u.xhr();if(u.username?l.open(u.type,u.url,u.async,u.username,u.password):l.open(u.type,u.url,u.async),u.xhrFields)for(t in u.xhrFields)l[t]=u.xhrFields[t];u.mimeType&&l.overrideMimeType&&l.overrideMimeType(u.mimeType),u.crossDomain||e["X-Requested-With"]||(e["X-Requested-With"]="XMLHttpRequest");try{for(t in e)l.setRequestHeader(t,e[t])}catch(e){}l.send(u.hasContent&&u.data||null),h=function(e,t){var n,i,r,o,s;try{if(h&&(t||4===l.readyState))if(h=M,c&&(l.onreadystatechange=x.noop,Qe&&delete Ke[c]),t)4!==l.readyState&&l.abort();else{n=l.status,r=l.getAllResponseHeaders(),o={},(s=l.responseXML)&&s.documentElement&&(o.xml=s);try{o.text=l.responseText}catch(e){}try{i=l.statusText}catch(e){i=""}n||!u.isLocal||u.crossDomain?1223===n&&(n=204):n=o.text?200:404}}catch(e){t||a(-1,e)}o&&a(n,i,o,r)},u.async&&4!==l.readyState?(c=++Ye,Qe&&(Ke||(Ke={},x(I).unload(Qe)),Ke[c]=h),l.onreadystatechange=h):h()},abort:function(){h&&h(0,1)}}});var et,tt,nt,it,rt={},ot=/^(?:toggle|show|hide)$/,st=/^([+\-]=)?([\d+.\-]+)([a-z%]*)$/i,at=[["height","marginTop","marginBottom","paddingTop","paddingBottom"],["width","marginLeft","marginRight","paddingLeft","paddingRight"],["opacity"]];function ct(){return setTimeout(lt,0),it=x.now()}function lt(){it=M}function ut(e,t){var n={};return x.each(at.concat.apply([],at.slice(0,t)),function(){n[this]=e}),n}function ht(e){if(!rt[e]){var t=D.body,n=x("<"+e+">").appendTo(t),i=n.css("display");n.remove(),"none"!==i&&""!==i||(et||((et=D.createElement("iframe")).frameBorder=et.width=et.height=0),t.appendChild(et),tt&&et.createElement||((tt=(et.contentWindow||et.contentDocument).document).write((x.support.boxModel?"<!doctype html>":"")+"<html><body>"),tt.close()),n=tt.createElement(e),tt.body.appendChild(n),i=x.css(n,"display"),t.removeChild(et)),rt[e]=i}return rt[e]}x.fn.extend({show:function(e,t,n){var i,r;if(e||0===e)return this.animate(ut("show",3),e,t,n);for(var o=0,s=this.length;o<s;o++)(i=this[o]).style&&(r=i.style.display,x._data(i,"olddisplay")||"none"!==r||(r=i.style.display=""),(""===r&&"none"===x.css(i,"display")||!x.contains(i.ownerDocument.documentElement,i))&&x._data(i,"olddisplay",ht(i.nodeName)));for(o=0;o<s;o++)(i=this[o]).style&&(""!==(r=i.style.display)&&"none"!==r||(i.style.display=x._data(i,"olddisplay")||""));return this},hide:function(e,t,n){if(e||0===e)return this.animate(ut("hide",3),e,t,n);for(var i,r,o=0,s=this.length;o<s;o++)(i=this[o]).style&&("none"===(r=x.css(i,"display"))||x._data(i,"olddisplay")||x._data(i,"olddisplay",r));for(o=0;o<s;o++)this[o].style&&(this[o].style.display="none");return this},_toggle:x.fn.toggle,toggle:function(t,e,n){var i="boolean"==typeof t;return x.isFunction(t)&&x.isFunction(e)?this._toggle.apply(this,arguments):null==t||i?this.each(function(){var e=i?t:x(this).is(":hidden");x(this)[e?"show":"hide"]()}):this.animate(ut("toggle",3),t,e,n),this},fadeTo:function(e,t,n,i){return this.filter(":hidden").css("opacity",0).show().end().animate({opacity:t},e,n,i)},animate:function(f,e,t,n){var g=x.speed(e,t,n);if(x.isEmptyObject(f))return this.each(g.complete,[!1]);function i(){!1===g.queue&&x._mark(this);var e,t,n,i,r,o,s,a,c,l,u,h=x.extend({},g),d=1===this.nodeType,p=d&&x(this).is(":hidden");for(n in h.animatedProperties={},f)if(n!==(e=x.camelCase(n))&&(f[e]=f[n],delete f[n]),(r=x.cssHooks[e])&&"expand"in r)for(n in o=r.expand(f[e]),delete f[e],o)n in f||(f[n]=o[n]);for(e in f){if(t=f[e],x.isArray(t)?(h.animatedProperties[e]=t[1],t=f[e]=t[0]):h.animatedProperties[e]=h.specialEasing&&h.specialEasing[e]||h.easing||"swing","hide"===t&&p||"show"===t&&!p)return h.complete.call(this);!d||"height"!==e&&"width"!==e||(h.overflow=[this.style.overflow,this.style.overflowX,this.style.overflowY],"inline"===x.css(this,"display")&&"none"===x.css(this,"float")&&(x.support.inlineBlockNeedsLayout&&"inline"!==ht(this.nodeName)?this.style.zoom=1:this.style.display="inline-block"))}for(n in null!=h.overflow&&(this.style.overflow="hidden"),f)i=new x.fx(this,h,n),t=f[n],ot.test(t)?(u=x._data(this,"toggle"+n)||("toggle"===t?p?"show":"hide":0))?(x._data(this,"toggle"+n,"show"===u?"hide":"show"),i[u]()):i[t]():(s=st.exec(t),a=i.cur(),s?(c=parseFloat(s[2]),"px"!==(l=s[3]||(x.cssNumber[n]?"":"px"))&&(x.style(this,n,(c||1)+l),a=(c||1)/i.cur()*a,x.style(this,n,a+l)),s[1]&&(c=("-="===s[1]?-1:1)*c+a),i.custom(a,c,l)):i.custom(a,t,""));return!0}return f=x.extend({},f),!1===g.queue?this.each(i):this.queue(g.queue,i)},stop:function(o,e,s){return"string"!=typeof o&&(s=e,e=o,o=M),e&&!1!==o&&this.queue(o||"fx",[]),this.each(function(){var e,t=!1,n=x.timers,i=x._data(this);function r(e,t,n){var i=t[n];x.removeData(e,n,!0),i.stop(s)}if(s||x._unmark(!0,this),null==o)for(e in i)i[e]&&i[e].stop&&e.indexOf(".run")===e.length-4&&r(this,i,e);else i[e=o+".run"]&&i[e].stop&&r(this,i,e);for(e=n.length;e--;)n[e].elem!==this||null!=o&&n[e].queue!==o||(s?n[e](!0):n[e].saveState(),t=!0,n.splice(e,1));s&&t||x.dequeue(this,o)})}}),x.each({slideDown:ut("show",1),slideUp:ut("hide",1),slideToggle:ut("toggle",1),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,i){x.fn[e]=function(e,t,n){return this.animate(i,e,t,n)}}),x.extend({speed:function(e,t,n){var i=e&&"object"==typeof e?x.extend({},e):{complete:n||!n&&t||x.isFunction(e)&&e,duration:e,easing:n&&t||t&&!x.isFunction(t)&&t};return i.duration=x.fx.off?0:"number"==typeof i.duration?i.duration:i.duration in x.fx.speeds?x.fx.speeds[i.duration]:x.fx.speeds._default,null!=i.queue&&!0!==i.queue||(i.queue="fx"),i.old=i.complete,i.complete=function(e){x.isFunction(i.old)&&i.old.call(this),i.queue?x.dequeue(this,i.queue):!1!==e&&x._unmark(this)},i},easing:{linear:function(e){return e},swing:function(e){return-Math.cos(e*Math.PI)/2+.5}},timers:[],fx:function(e,t,n){this.options=t,this.elem=e,this.prop=n,t.orig=t.orig||{}}}),x.fx.prototype={update:function(){this.options.step&&this.options.step.call(this.elem,this.now,this),(x.fx.step[this.prop]||x.fx.step._default)(this)},cur:function(){if(null!=this.elem[this.prop]&&(!this.elem.style||null==this.elem.style[this.prop]))return this.elem[this.prop];var e,t=x.css(this.elem,this.prop);return isNaN(e=parseFloat(t))?t&&"auto"!==t?t:0:e},custom:function(e,t,n){var i=this,r=x.fx;function o(e){return i.step(e)}this.startTime=it||ct(),this.end=t,this.now=this.start=e,this.pos=this.state=0,this.unit=n||this.unit||(x.cssNumber[this.prop]?"":"px"),o.queue=this.options.queue,o.elem=this.elem,o.saveState=function(){x._data(i.elem,"fxshow"+i.prop)===M&&(i.options.hide?x._data(i.elem,"fxshow"+i.prop,i.start):i.options.show&&x._data(i.elem,"fxshow"+i.prop,i.end))},o()&&x.timers.push(o)&&!nt&&(nt=setInterval(r.tick,r.interval))},show:function(){var e=x._data(this.elem,"fxshow"+this.prop);this.options.orig[this.prop]=e||x.style(this.elem,this.prop),this.options.show=!0,e!==M?this.custom(this.cur(),e):this.custom("width"===this.prop||"height"===this.prop?1:0,this.cur()),x(this.elem).show()},hide:function(){this.options.orig[this.prop]=x._data(this.elem,"fxshow"+this.prop)||x.style(this.elem,this.prop),this.options.hide=!0,this.custom(this.cur(),0)},step:function(e){var t,n,i,r=it||ct(),o=!0,s=this.elem,a=this.options;if(e||r>=a.duration+this.startTime){for(t in this.now=this.end,this.pos=this.state=1,this.update(),a.animatedProperties[this.prop]=!0,a.animatedProperties)!0!==a.animatedProperties[t]&&(o=!1);if(o){if(null==a.overflow||x.support.shrinkWrapBlocks||x.each(["","X","Y"],function(e,t){s.style["overflow"+t]=a.overflow[e]}),a.hide&&x(s).hide(),a.hide||a.show)for(t in a.animatedProperties)x.style(s,t,a.orig[t]),x.removeData(s,"fxshow"+t,!0),x.removeData(s,"toggle"+t,!0);(i=a.complete)&&(a.complete=!1,i.call(s))}return!1}return a.duration==1/0?this.now=r:(n=r-this.startTime,this.state=n/a.duration,this.pos=x.easing[a.animatedProperties[this.prop]](this.state,n,0,1,a.duration),this.now=this.start+(this.end-this.start)*this.pos),this.update(),!0}},x.extend(x.fx,{tick:function(){for(var e,t=x.timers,n=0;n<t.length;n++)(e=t[n])()||t[n]!==e||t.splice(n--,1);t.length||x.fx.stop()},interval:13,stop:function(){clearInterval(nt),nt=null},speeds:{slow:600,fast:200,_default:400},step:{opacity:function(e){x.style(e.elem,"opacity",e.now)},_default:function(e){e.elem.style&&null!=e.elem.style[e.prop]?e.elem.style[e.prop]=e.now+e.unit:e.elem[e.prop]=e.now}}}),x.each(at.concat.apply([],at),function(e,t){t.indexOf("margin")&&(x.fx.step[t]=function(e){x.style(e.elem,t,Math.max(0,e.now)+e.unit)})}),x.expr&&x.expr.filters&&(x.expr.filters.animated=function(t){return x.grep(x.timers,function(e){return t===e.elem}).length});var dt,pt=/^t(?:able|d|h)$/i,ft=/^(?:body|html)$/i;function gt(e){return x.isWindow(e)?e:9===e.nodeType&&(e.defaultView||e.parentWindow)}dt="getBoundingClientRect"in D.documentElement?function(e,t,n,i){try{i=e.getBoundingClientRect()}catch(e){}if(!i||!x.contains(n,e))return i?{top:i.top,left:i.left}:{top:0,left:0};var r=t.body,o=gt(t),s=n.clientTop||r.clientTop||0,a=n.clientLeft||r.clientLeft||0,c=o.pageYOffset||x.support.boxModel&&n.scrollTop||r.scrollTop,l=o.pageXOffset||x.support.boxModel&&n.scrollLeft||r.scrollLeft;return{top:i.top+c-s,left:i.left+l-a}}:function(e,t,n){for(var i,r=e.offsetParent,o=t.body,s=t.defaultView,a=s?s.getComputedStyle(e,null):e.currentStyle,c=e.offsetTop,l=e.offsetLeft;(e=e.parentNode)&&e!==o&&e!==n&&(!x.support.fixedPosition||"fixed"!==a.position);)i=s?s.getComputedStyle(e,null):e.currentStyle,c-=e.scrollTop,l-=e.scrollLeft,e===r&&(c+=e.offsetTop,l+=e.offsetLeft,!x.support.doesNotAddBorder||x.support.doesAddBorderForTableAndCells&&pt.test(e.nodeName)||(c+=parseFloat(i.borderTopWidth)||0,l+=parseFloat(i.borderLeftWidth)||0),r,r=e.offsetParent),x.support.subtractsBorderForOverflowNotVisible&&"visible"!==i.overflow&&(c+=parseFloat(i.borderTopWidth)||0,l+=parseFloat(i.borderLeftWidth)||0),a=i;return"relative"!==a.position&&"static"!==a.position||(c+=o.offsetTop,l+=o.offsetLeft),x.support.fixedPosition&&"fixed"===a.position&&(c+=Math.max(n.scrollTop,o.scrollTop),l+=Math.max(n.scrollLeft,o.scrollLeft)),{top:c,left:l}},x.fn.offset=function(t){if(arguments.length)return t===M?this:this.each(function(e){x.offset.setOffset(this,t,e)});var e=this[0],n=e&&e.ownerDocument;return n?e===n.body?x.offset.bodyOffset(e):dt(e,n,n.documentElement):null},x.offset={bodyOffset:function(e){var t=e.offsetTop,n=e.offsetLeft;return x.support.doesNotIncludeMarginInBodyOffset&&(t+=parseFloat(x.css(e,"marginTop"))||0,n+=parseFloat(x.css(e,"marginLeft"))||0),{top:t,left:n}},setOffset:function(e,t,n){var i=x.css(e,"position");"static"===i&&(e.style.position="relative");var r,o,s=x(e),a=s.offset(),c=x.css(e,"top"),l=x.css(e,"left"),u={},h={};o=("absolute"===i||"fixed"===i)&&-1<x.inArray("auto",[c,l])?(r=(h=s.position()).top,h.left):(r=parseFloat(c)||0,parseFloat(l)||0),x.isFunction(t)&&(t=t.call(e,n,a)),null!=t.top&&(u.top=t.top-a.top+r),null!=t.left&&(u.left=t.left-a.left+o),"using"in t?t.using.call(e,u):s.css(u)}},x.fn.extend({position:function(){if(!this[0])return null;var e=this[0],t=this.offsetParent(),n=this.offset(),i=ft.test(t[0].nodeName)?{top:0,left:0}:t.offset();return n.top-=parseFloat(x.css(e,"marginTop"))||0,n.left-=parseFloat(x.css(e,"marginLeft"))||0,i.top+=parseFloat(x.css(t[0],"borderTopWidth"))||0,i.left+=parseFloat(x.css(t[0],"borderLeftWidth"))||0,{top:n.top-i.top,left:n.left-i.left}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent||D.body;e&&!ft.test(e.nodeName)&&"static"===x.css(e,"position");)e=e.offsetParent;return e})}}),x.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,r){var o=/Y/.test(r);x.fn[t]=function(e){return x.access(this,function(e,t,n){var i=gt(e);if(n===M)return i?r in i?i[r]:x.support.boxModel&&i.document.documentElement[t]||i.document.body[t]:e[t];i?i.scrollTo(o?x(i).scrollLeft():n,o?n:x(i).scrollTop()):e[t]=n},t,e,arguments.length,null)}}),x.each({Height:"height",Width:"width"},function(e,n){var a="client"+e,c="scroll"+e,l="offset"+e;x.fn["inner"+e]=function(){var e=this[0];return e?e.style?parseFloat(x.css(e,n,"padding")):this[n]():null},x.fn["outer"+e]=function(e){var t=this[0];return t?t.style?parseFloat(x.css(t,n,e?"margin":"border")):this[n]():null},x.fn[n]=function(e){return x.access(this,function(e,t,n){var i,r,o,s;return x.isWindow(e)?(r=(i=e.document).documentElement[a],x.support.boxModel&&r||i.body&&i.body[a]||r):9===e.nodeType?(i=e.documentElement)[a]>=i[c]?i[a]:Math.max(e.body[c],i[c],e.body[l],i[l]):n===M?(o=x.css(e,t),s=parseFloat(o),x.isNumeric(s)?s:o):void x(e).css(t,n)},n,e,arguments.length,null)}}),I.jQuery=I.$=x}(window),$&&$.noConflict&&$.noConflict(),jQuery&&jQuery.noConflict&&(window.livechat=window.livechat||{},window.livechat.jQuery=jQuery.noConflict(!0)),function(){var e=this,t=e._,s={},r=Array.prototype,n=Object.prototype,i=Function.prototype,o=r.push,a=r.slice,c=r.concat,h=n.toString,l=n.hasOwnProperty,u=r.forEach,d=r.map,p=r.reduce,f=r.reduceRight,g=r.filter,m=r.every,v=r.some,y=r.indexOf,b=r.lastIndexOf,w=Array.isArray,C=Object.keys,_=i.bind,k=function(e){return e instanceof k?e:this instanceof k?void(this._wrapped=e):new k(e)};e._=k,(window._=k).VERSION="1.4.3";var T=k.each=k.forEach=function(e,t,n){if(null!=e)if(u&&e.forEach===u)e.forEach(t,n);else if(e.length===+e.length){for(var i=0,r=e.length;i<r;i++)if(t.call(n,e[i],i,e)===s)return}else for(var o in e)if(k.has(e,o)&&t.call(n,e[o],o,e)===s)return};k.map=k.collect=function(e,i,r){var o=[];return null==e?o:d&&e.map===d?e.map(i,r):(T(e,function(e,t,n){o[o.length]=i.call(r,e,t,n)}),o)};var S="Reduce of empty array with no initial value";k.reduce=k.foldl=k.inject=function(e,i,r,o){var s=2<arguments.length;if(null==e&&(e=[]),p&&e.reduce===p)return o&&(i=k.bind(i,o)),s?e.reduce(i,r):e.reduce(i);if(T(e,function(e,t,n){s?r=i.call(o,r,e,t,n):(r=e,s=!0)}),!s)throw new TypeError(S);return r},k.reduceRight=k.foldr=function(i,r,o,s){var a=2<arguments.length;if(null==i&&(i=[]),f&&i.reduceRight===f)return s&&(r=k.bind(r,s)),a?i.reduceRight(r,o):i.reduceRight(r);var c=i.length;if(c!==+c){var l=k.keys(i);c=l.length}if(T(i,function(e,t,n){t=l?l[--c]:--c,a?o=r.call(s,o,i[t],t,n):(o=i[t],a=!0)}),!a)throw new TypeError(S);return o},k.find=k.detect=function(e,i,r){var o;return x(e,function(e,t,n){if(i.call(r,e,t,n))return o=e,!0}),o},k.filter=k.select=function(e,i,r){var o=[];return null==e?o:g&&e.filter===g?e.filter(i,r):(T(e,function(e,t,n){i.call(r,e,t,n)&&(o[o.length]=e)}),o)},k.reject=function(e,i,r){return k.filter(e,function(e,t,n){return!i.call(r,e,t,n)},r)},k.every=k.all=function(e,i,r){i||(i=k.identity);var o=!0;return null==e?o:m&&e.every===m?e.every(i,r):(T(e,function(e,t,n){if(!(o=o&&i.call(r,e,t,n)))return s}),!!o)};var x=k.some=k.any=function(e,i,r){i||(i=k.identity);var o=!1;return null==e?o:v&&e.some===v?e.some(i,r):(T(e,function(e,t,n){if(o||(o=i.call(r,e,t,n)))return s}),!!o)};k.contains=k.include=function(e,t){return null!=e&&(y&&e.indexOf===y?-1!=e.indexOf(t):x(e,function(e){return e===t}))},k.invoke=function(e,t){var n=a.call(arguments,2);return k.map(e,function(e){return(k.isFunction(t)?t:e[t]).apply(e,n)})},k.pluck=function(e,t){return k.map(e,function(e){return e[t]})},k.where=function(e,n){return k.isEmpty(n)?[]:k.filter(e,function(e){for(var t in n)if(n[t]!==e[t])return!1;return!0})},k.max=function(e,r,o){if(!r&&k.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.max.apply(Math,e);if(!r&&k.isEmpty(e))return-1/0;var s={computed:-1/0,value:-1/0};return T(e,function(e,t,n){var i=r?r.call(o,e,t,n):e;i>=s.computed&&(s={value:e,computed:i})}),s.value},k.min=function(e,r,o){if(!r&&k.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.min.apply(Math,e);if(!r&&k.isEmpty(e))return 1/0;var s={computed:1/0,value:1/0};return T(e,function(e,t,n){var i=r?r.call(o,e,t,n):e;i<s.computed&&(s={value:e,computed:i})}),s.value},k.shuffle=function(e){var t,n=0,i=[];return T(e,function(e){t=k.random(n++),i[n-1]=i[t],i[t]=e}),i};var E=function(t){return k.isFunction(t)?t:function(e){return e[t]}};k.sortBy=function(e,t,i){var r=E(t);return k.pluck(k.map(e,function(e,t,n){return{value:e,index:t,criteria:r.call(i,e,t,n)}}).sort(function(e,t){var n=e.criteria,i=t.criteria;if(n!==i){if(i<n||void 0===n)return 1;if(n<i||void 0===i)return-1}return e.index<t.index?-1:1}),"value")};var N=function(i,e,r,o){var s={},a=E(e||k.identity);return T(i,function(e,t){var n=a.call(r,e,t,i);o(s,n,e)}),s};k.groupBy=function(e,t,n){return N(e,t,n,function(e,t,n){(k.has(e,t)?e[t]:e[t]=[]).push(n)})},k.countBy=function(e,t,n){return N(e,t,n,function(e,t){k.has(e,t)||(e[t]=0),e[t]++})},k.sortedIndex=function(e,t,n,i){for(var r=(n=null==n?k.identity:E(n)).call(i,t),o=0,s=e.length;o<s;){var a=o+s>>>1;n.call(i,e[a])<r?o=a+1:s=a}return o},k.toArray=function(e){return e?k.isArray(e)?a.call(e):e.length===+e.length?k.map(e,k.identity):k.values(e):[]},k.size=function(e){return null==e?0:e.length===+e.length?e.length:k.keys(e).length},k.first=k.head=k.take=function(e,t,n){if(null!=e)return null==t||n?e[0]:a.call(e,0,t)},k.initial=function(e,t,n){return a.call(e,0,e.length-(null==t||n?1:t))},k.last=function(e,t,n){if(null!=e)return null==t||n?e[e.length-1]:a.call(e,Math.max(e.length-t,0))},k.rest=k.tail=k.drop=function(e,t,n){return a.call(e,null==t||n?1:t)},k.compact=function(e){return k.filter(e,k.identity)};var P=function(e,t,n){return T(e,function(e){k.isArray(e)?t?o.apply(n,e):P(e,t,n):n.push(e)}),n};k.flatten=function(e,t){return P(e,t,[])},k.without=function(e){return k.difference(e,a.call(arguments,1))},k.uniq=k.unique=function(n,i,e,t){k.isFunction(i)&&(t=e,e=i,i=!1);var r=e?k.map(n,e,t):n,o=[],s=[];return T(r,function(e,t){(i?t&&s[s.length-1]===e:k.contains(s,e))||(s.push(e),o.push(n[t]))}),o},k.union=function(){return k.uniq(c.apply(r,arguments))},k.intersection=function(e){var n=a.call(arguments,1);return k.filter(k.uniq(e),function(t){return k.every(n,function(e){return 0<=k.indexOf(e,t)})})},k.difference=function(e){var t=c.apply(r,a.call(arguments,1));return k.filter(e,function(e){return!k.contains(t,e)})},k.zip=function(){for(var e=a.call(arguments),t=k.max(k.pluck(e,"length")),n=new Array(t),i=0;i<t;i++)n[i]=k.pluck(e,""+i);return n},k.object=function(e,t){if(null==e)return{};for(var n={},i=0,r=e.length;i<r;i++)t?n[e[i]]=t[i]:n[e[i][0]]=e[i][1];return n},k.indexOf=function(e,t,n){if(null==e)return-1;var i=0,r=e.length;if(n){if("number"!=typeof n)return e[i=k.sortedIndex(e,t)]===t?i:-1;i=n<0?Math.max(0,r+n):n}if(y&&e.indexOf===y)return e.indexOf(t,n);for(;i<r;i++)if(e[i]===t)return i;return-1},k.lastIndexOf=function(e,t,n){if(null==e)return-1;var i=null!=n;if(b&&e.lastIndexOf===b)return i?e.lastIndexOf(t,n):e.lastIndexOf(t);for(var r=i?n:e.length;r--;)if(e[r]===t)return r;return-1},k.range=function(e,t,n){arguments.length<=1&&(t=e||0,e=0),n=n||1;for(var i=Math.max(Math.ceil((t-e)/n),0),r=0,o=new Array(i);r<i;)o[r++]=e,e+=n;return o};var A=function(){};k.bind=function(n,i){var r,o;if(n.bind===_&&_)return _.apply(n,a.call(arguments,1));if(!k.isFunction(n))throw new TypeError;return r=a.call(arguments,2),o=function(){if(!(this instanceof o))return n.apply(i,r.concat(a.call(arguments)));A.prototype=n.prototype;var e=new A;A.prototype=null;var t=n.apply(e,r.concat(a.call(arguments)));return Object(t)===t?t:e}},k.bindAll=function(t){var e=a.call(arguments,1);return 0==e.length&&(e=k.functions(t)),T(e,function(e){t[e]=k.bind(t[e],t)}),t},k.memoize=function(t,n){var i={};return n||(n=k.identity),function(){var e=n.apply(this,arguments);return k.has(i,e)?i[e]:i[e]=t.apply(this,arguments)}},k.delay=function(e,t){var n=a.call(arguments,2);return setTimeout(function(){return e.apply(null,n)},t)},k.defer=function(e){return k.delay.apply(k,[e,1].concat(a.call(arguments,1)))},k.throttle=function(n,i){var r,o,s,a,c=0,l=function(){c=new Date,s=null,a=n.apply(r,o)};return function(){var e=new Date,t=i-(e-c);return r=this,o=arguments,t<=0?(clearTimeout(s),s=null,c=e,a=n.apply(r,o)):s||(s=setTimeout(l,t)),a}},k.debounce=function(i,r,o){var s,a;return function(){var e=this,t=arguments,n=o&&!s;return clearTimeout(s),s=setTimeout(function(){s=null,o||(a=i.apply(e,t))},r),n&&(a=i.apply(e,t)),a}},k.once=function(e){var t,n=!1;return function(){return n||(n=!0,t=e.apply(this,arguments),e=null),t}},k.wrap=function(t,n){return function(){var e=[t];return o.apply(e,arguments),n.apply(this,e)}},k.compose=function(){var n=arguments;return function(){for(var e=arguments,t=n.length-1;0<=t;t--)e=[n[t].apply(this,e)];return e[0]}},k.after=function(e,t){return e<=0?t():function(){if(--e<1)return t.apply(this,arguments)}},k.keys=C||function(e){if(e!==Object(e))throw new TypeError("Invalid object");var t=[];for(var n in e)k.has(e,n)&&(t[t.length]=n);return t},k.values=function(e){var t=[];for(var n in e)k.has(e,n)&&t.push(e[n]);return t},k.pairs=function(e){var t=[];for(var n in e)k.has(e,n)&&t.push([n,e[n]]);return t},k.invert=function(e){var t={};for(var n in e)k.has(e,n)&&(t[e[n]]=n);return t},k.functions=k.methods=function(e){var t=[];for(var n in e)k.isFunction(e[n])&&t.push(n);return t.sort()},k.extend=function(n){return T(a.call(arguments,1),function(e){if(e)for(var t in e)n[t]=e[t]}),n},k.pick=function(t){var n={},e=c.apply(r,a.call(arguments,1));return T(e,function(e){e in t&&(n[e]=t[e])}),n},k.omit=function(e){var t={},n=c.apply(r,a.call(arguments,1));for(var i in e)k.contains(n,i)||(t[i]=e[i]);return t},k.defaults=function(n){return T(a.call(arguments,1),function(e){if(e)for(var t in e)null==n[t]&&(n[t]=e[t])}),n},k.clone=function(e){return k.isObject(e)?k.isArray(e)?e.slice():k.extend({},e):e},k.tap=function(e,t){return t(e),e};var O=function(e,t,n,i){if(e===t)return 0!==e||1/e==1/t;if(null==e||null==t)return e===t;e instanceof k&&(e=e._wrapped),t instanceof k&&(t=t._wrapped);var r=h.call(e);if(r!=h.call(t))return!1;switch(r){case"[object String]":return e==String(t);case"[object Number]":return e!=+e?t!=+t:0==e?1/e==1/t:e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object RegExp]":return e.source==t.source&&e.global==t.global&&e.multiline==t.multiline&&e.ignoreCase==t.ignoreCase}if("object"!=typeof e||"object"!=typeof t)return!1;for(var o=n.length;o--;)if(n[o]==e)return i[o]==t;n.push(e),i.push(t);var s=0,a=!0;if("[object Array]"==r){if(a=(s=e.length)==t.length)for(;s--&&(a=O(e[s],t[s],n,i)););}else{var c=e.constructor,l=t.constructor;if(c!==l&&!(k.isFunction(c)&&c instanceof c&&k.isFunction(l)&&l instanceof l))return!1;for(var u in e)if(k.has(e,u)&&(s++,!(a=k.has(t,u)&&O(e[u],t[u],n,i))))break;if(a){for(u in t)if(k.has(t,u)&&!s--)break;a=!s}}return n.pop(),i.pop(),a};k.isEqual=function(e,t){return O(e,t,[],[])},k.isEmpty=function(e){if(null==e)return!0;if(k.isArray(e)||k.isString(e))return 0===e.length;for(var t in e)if(k.has(e,t))return!1;return!0},k.isElement=function(e){return!(!e||1!==e.nodeType)},k.isArray=w||function(e){return"[object Array]"==h.call(e)},k.isObject=function(e){return e===Object(e)},T(["Arguments","Function","String","Number","Date","RegExp"],function(t){k["is"+t]=function(e){return h.call(e)=="[object "+t+"]"}}),k.isArguments(arguments)||(k.isArguments=function(e){return!(!e||!k.has(e,"callee"))}),"function"!=typeof/./&&(k.isFunction=function(e){return"function"==typeof e}),k.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))},k.isNaN=function(e){return k.isNumber(e)&&e!=+e},k.isBoolean=function(e){return!0===e||!1===e||"[object Boolean]"==h.call(e)},k.isNull=function(e){return null===e},k.isUndefined=function(e){return void 0===e},k.has=function(e,t){return l.call(e,t)},k.noConflict=function(){return e._=t,this},k.identity=function(e){return e},k.times=function(e,t,n){for(var i=Array(e),r=0;r<e;r++)i[r]=t.call(n,r);return i},k.random=function(e,t){return null==t&&(t=e,e=0),e+(0|Math.random()*(t-e+1))};var I={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};I.unescape=k.invert(I.escape);var M={escape:new RegExp("["+k.keys(I.escape).join("")+"]","g"),unescape:new RegExp("("+k.keys(I.unescape).join("|")+")","g")};k.each(["escape","unescape"],function(t){k[t]=function(e){return null==e?"":(""+e).replace(M[t],function(e){return I[t][e]})}}),k.result=function(e,t){if(null==e)return null;var n=e[t];return k.isFunction(n)?n.call(e):n},k.mixin=function(n){T(k.functions(n),function(e){var t=k[e]=n[e];k.prototype[e]=function(){var e=[this._wrapped];return o.apply(e,arguments),j.call(this,t.apply(k,e))}})};var D=0;k.uniqueId=function(e){var t=""+ ++D;return e?e+t:t},k.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var L=/(.)^/,B={"'":"'","\\":"\\","\r":"r","\n":"n","\t":"t","\u2028":"u2028","\u2029":"u2029"},R=/\\|'|\r|\n|\t|\u2028|\u2029/g;k.template=function(o,e,t){t=k.defaults({},t,k.templateSettings);var n=new RegExp([(t.escape||L).source,(t.interpolate||L).source,(t.evaluate||L).source].join("|")+"|$","g"),s=0,a="__p+='";o.replace(n,function(e,t,n,i,r){return a+=o.slice(s,r).replace(R,function(e){return"\\"+B[e]}),t&&(a+="'+\n((__t=("+t+"))==null?'':_.escape(__t))+\n'"),n&&(a+="'+\n((__t=("+n+"))==null?'':__t)+\n'"),i&&(a+="';\n"+i+"\n__p+='"),s=r+e.length,e}),a+="';\n",t.variable||(a="with(obj||{}){\n"+a+"}\n"),a="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+a+"return __p;\n";try{var i=new Function(t.variable||"obj","_",a)}catch(e){throw e.source=a,e}if(e)return i(e,k);var r=function(e){return i.call(this,e,k)};return r.source="function("+(t.variable||"obj")+"){\n"+a+"}",r},k.chain=function(e){return k(e).chain()};var j=function(e){return this._chain?k(e).chain():e};k.mixin(k),T(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var n=r[t];k.prototype[t]=function(){var e=this._wrapped;return n.apply(e,arguments),"shift"!=t&&"splice"!=t||0!==e.length||delete e[0],j.call(this,e)}}),T(["concat","join","slice"],function(e){var t=r[e];k.prototype[e]=function(){return j.call(this,t.apply(this._wrapped,arguments))}}),k.extend(k.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}.call(this),"undefined"!=typeof _&&_.noConflict&&(window.livechat._=_.noConflict()),function(e){var t=function(){return{TIME:{AGENT_LEFT:6e4,CHAT_EXPIRE:3e5,CHECK_CHAT:9e5,AUTO_CONNECT:18e4,FORCE_DISCONNECT:12e5,CHAT_INACTIVE:12e5,TYPING:1e4,WAIT_MESSAGE:6e4,NON_AVAILABILITY:12e4,MISSED_CHAT_FORM:18e4,REFRESH:3e4,PING_STORAGE_TIMEOUT:3e5,PING_STORAGE_GRACE_TIME:6e4,CURRENT_VISITOR_TIME_OUT:3e5,CHANGE_VISITOR_TIME_OUT:5e3,AGENT_NETWORK_DISCONNECT:6e4,CB_REQ_TIMEOUT:12e4}}};window.livechat.Constants=new t,t=null}(),function(u){var e=function(){this._keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="};e.prototype.encode=function(e){var t,n,i,r,o,s,a,c="",l=0;for(e=u.Base64._utf8_encode(e);l<e.length;)r=(t=e.charCodeAt(l++))>>2,o=(3&t)<<4|(n=e.charCodeAt(l++))>>4,s=(15&n)<<2|(i=e.charCodeAt(l++))>>6,a=63&i,isNaN(n)?s=a=64:isNaN(i)&&(a=64),c=c+this._keyStr.charAt(r)+this._keyStr.charAt(o)+this._keyStr.charAt(s)+this._keyStr.charAt(a);return c},e.prototype.decode=function(e){var t,n,i,r,o,s,a="",c=0;for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");c<e.length;)t=this._keyStr.indexOf(e.charAt(c++))<<2|(r=this._keyStr.indexOf(e.charAt(c++)))>>4,n=(15&r)<<4|(o=this._keyStr.indexOf(e.charAt(c++)))>>2,i=(3&o)<<6|(s=this._keyStr.indexOf(e.charAt(c++))),a+=String.fromCharCode(t),64!=o&&(a+=String.fromCharCode(n)),64!=s&&(a+=String.fromCharCode(i));return a=u.Base64._utf8_decode(a)},e.prototype._utf8_encode=function(e){e=e.replace(/\r\n/g,"\n");for(var t="",n=0;n<e.length;n++){var i=e.charCodeAt(n);i<128?t+=String.fromCharCode(i):(127<i&&i<2048?t+=String.fromCharCode(i>>6|192):(t+=String.fromCharCode(i>>12|224),t+=String.fromCharCode(i>>6&63|128)),t+=String.fromCharCode(63&i|128))}return t},e.prototype._utf8_decode=function(e){var t,n,i,r="",o=0;for(t=n=i=0;o<e.length;)(t=e.charCodeAt(o))<128?(r+=String.fromCharCode(t),o++):191<t&&t<224?(n=e.charCodeAt(o+1),r+=String.fromCharCode((31&t)<<6|63&n),o+=2):(n=e.charCodeAt(o+1),i=e.charCodeAt(o+2),r+=String.fromCharCode((15&t)<<12|(63&n)<<6|63&i),o+=3);return r},u.Base64=new e}(window.livechat),function(e,t){var n,i,r;window.livechat.Autolinker=((n=function(e){for(var t in e=e||{})e.hasOwnProperty(t)&&(this[t]=e[t])}).prototype={constructor:n,newWindow:!0,stripPrefix:!1,twitter:!1,email:!1,urls:!0,className:"",matcherRegex:(i=/[A-Za-z0-9\.\-]*[A-Za-z0-9\-]/,r=/\.(?:international|construction|contractors|enterprises|photography|productions|foundation|immobilien|industries|management|properties|technology|christmas|community|directory|education|equipment|institute|marketing|solutions|vacations|bargains|boutique|builders|catering|cleaning|clothing|computer|democrat|diamonds|graphics|holdings|lighting|partners|plumbing|supplies|training|ventures|academy|careers|company|cruises|domains|exposed|flights|florist|gallery|guitars|holiday|kitchen|neustar|okinawa|recipes|rentals|reviews|shiksha|singles|support|systems|agency|berlin|camera|center|coffee|condos|dating|estate|events|expert|futbol|kaufen|luxury|maison|monash|museum|nagoya|photos|repair|report|social|supply|tattoo|tienda|travel|viajes|villas|vision|voting|voyage|actor|build|cards|cheap|codes|dance|email|glass|house|mango|ninja|parts|photo|shoes|solar|today|tokyo|tools|watch|works|aero|arpa|asia|best|bike|blue|buzz|camp|club|cool|coop|farm|fish|gift|guru|info|jobs|kiwi|kred|land|limo|link|menu|mobi|moda|name|pics|pink|post|qpon|rich|ruhr|sexy|tips|vote|voto|wang|wien|wiki|zone|bar|bid|biz|cab|cat|ceo|com|edu|gov|int|kim|mil|net|onl|org|pro|pub|red|tel|uno|wed|xxx|xyz|ac|ad|ae|af|ag|ai|al|am|an|ao|aq|ar|as|at|au|aw|ax|az|ba|bb|bd|be|bf|bg|bh|bi|bj|bm|bn|bo|br|bs|bt|bv|bw|by|bz|ca|cc|cd|cf|cg|ch|ci|ck|cl|cm|cn|co|cr|cu|cv|cw|cx|cy|cz|de|dj|dk|dm|do|dz|ec|ee|eg|er|es|et|eu|fi|fj|fk|fm|fo|fr|ga|gb|gd|ge|gf|gg|gh|gi|gl|gm|gn|gp|gq|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|in|io|iq|ir|is|it|je|jm|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|me|mg|mh|mk|ml|mm|mn|mo|mp|mq|mr|ms|mt|mu|mv|mw|mx|my|mz|na|nc|ne|nf|ng|ni|nl|no|np|nr|nu|nz|om|pa|pe|pf|pg|ph|pk|pl|pm|pn|pr|ps|pt|pw|py|qa|re|ro|rs|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sj|sk|sl|sm|sn|so|sr|st|su|sv|sx|sy|sz|tc|td|tf|tg|th|tj|tk|tl|tm|tn|to|tp|tr|tt|tv|tw|tz|ua|ug|uk|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|ye|yt|za|zm|zw)\b/,new RegExp(["(",/(^|[^\w])@(\w{1,15})/.source,")","|","(",/(?:[\-;:&=\+\$,\w\.]+@)/.source,i.source,r.source,")","|","(","(?:","(?:",/(?:[A-Za-z]{3,9}:(?:\/\/)?)/.source,i.source,")","|","(?:","(.?//)?",/(?:www\.)/.source,i.source,")","|","(?:","(.?//)?",i.source,r.source,")",")",/(?:[\-A-Za-z0-9+&@#\/%?=~_()|!:,.;]*[\-A-Za-z0-9+&@#\/%=~_()|])?/.source,")"].join(""),"gi")),protocolRelativeRegex:/(.)?\/\//,htmlRegex:new RegExp(["<(/)?","("+/[0-9a-zA-Z:]+/.source+")","(?:","\\s+",/[^\s\0"'>\/=\x01-\x1F\x7F]+/.source,"(?:\\s*=\\s*"+/(?:".*?"|'.*?'|[^'"=<>`\s]+)/.source+")?",")*","\\s*/?",">"].join(""),"g"),urlPrefixRegex:/^(https?:\/\/)?(www\.)?/i,link:function(e){return this.processHtml(e)},processHtml:function(e){for(var t,n,i=this.htmlRegex,r=0,o=0,s=[];null!==(t=i.exec(e));){var a=t[0],c=t[2],l=!!t[1];n=e.substring(r,t.index),r=t.index+a.length,"a"===c?l?0===(o=Math.max(o-1,0))&&s.push(n):(o++,s.push(this.processTextNode(n))):0===o?s.push(this.processTextNode(n)):s.push(n),s.push(a)}if(r<e.length){var u=this.processTextNode(e.substring(r));s.push(u)}return s.join("")},processTextNode:function(e){var _=this,t=this.matcherRegex,k=this.twitter,T=this.email,S=this.urls;return e.replace(t,function(e,t,n,i,r,o,s,a){var c=t,l=n,u=i,h=r,d=o,p=s||a,f="",g="";if(c&&!k||h&&!T||d&&!S||d&&-1===d.indexOf(".")||d&&/^[A-Za-z]{3,9}:/.test(d)&&!/:.*?[A-Za-z]/.test(d)||p&&/^[\w]\/\//.test(p))return e;if(")"===e.charAt(e.length-1)){var m=e.match(/\(/g),v=e.match(/\)/g);(m&&m.length||0)<(v&&v.length||0)&&(e=e.substr(0,e.length-1),g=")")}var y,b=e,w=e;if(c)y="twitter",f=l,b="https://twitter.com/"+u,w="@"+u;else if(h)y="email",b="mailto:"+h,w=h;else if(y="url",p){var C=new RegExp("^"+_.protocolRelativeRegex.source);f=(p.match(C)[1]||"")+f,b=b.replace(C,"//"),w=w.replace(C,"")}else/^[A-Za-z]{3,9}:/i.test(b)||(b="http://"+b);return f+_.createAnchorTag(y,b,w)+g})},createAnchorTag:function(e,t,n){return"<a "+this.createAnchorAttrsStr(e,t)+">"+(n=this.processAnchorText(n))+"</a>"},createAnchorAttrsStr:function(e,t){var n=['href="'+t+'"',' rel="noopener noreferrer" '],i=this.createCssClass(e);return i&&n.push('class="'+i+'"'),this.newWindow&&n.push('target="_blank"'),n.join(" ")},createCssClass:function(e){var t=this.className;return t?t+" "+t+"-"+e:""},processAnchorText:function(e){return this.stripPrefix&&(e=this.stripUrlPrefix(e)),e=this.removeTrailingSlash(e),e=this.doTruncate(e)},stripUrlPrefix:function(e){return e.replace(this.urlPrefixRegex,"")},removeTrailingSlash:function(e){return"/"===e.charAt(e.length-1)&&(e=e.slice(0,-1)),e},doTruncate:function(e){var t=this.truncate;return t&&e.length>t&&(e=e.substring(0,t-2)+".."),e}},n.link=function(e,t){return new n(t).link(e)},n)}(),function(){var j={function:!0,object:!0},U=j[typeof window]&&window||this,e=void 0;function z(e,c){e||(e=U.Object()),c||(c=U.Object());var l=e.Number||U.Number,u=e.String||U.String,t=e.Object||U.Object,h=e.Date||U.Date,n=e.SyntaxError||U.SyntaxError,k=e.TypeError||U.TypeError,i=e.Math||U.Math,r=e.JSON||U.JSON;"object"==typeof r&&r&&(c.stringify=r.stringify,c.parse=r.parse);var T,S,x,o=t.prototype,E=o.toString,d=new h(-0xc782b5b800cec);try{d=-109252==d.getUTCFullYear()&&0===d.getUTCMonth()&&1===d.getUTCDate()&&10==d.getUTCHours()&&37==d.getUTCMinutes()&&6==d.getUTCSeconds()&&708==d.getUTCMilliseconds()}catch(e){}function p(e){if(p[e]!==x)return p[e];var t;if("bug-string-char-index"==e)t="a"!="a"[0];else if("json"==e)t=p("json-stringify")&&p("json-parse");else{var n,i='{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}';if("json-stringify"==e){var r=c.stringify,o="function"==typeof r&&d;if(o){(n=function(){return 1}).toJSON=n;try{o="0"===r(0)&&"0"===r(new l)&&'""'==r(new u)&&r(E)===x&&r(x)===x&&r()===x&&"1"===r(n)&&"[1]"==r([n])&&"[null]"==r([x])&&"null"==r(null)&&"[null,null,null]"==r([x,E,null])&&r({a:[n,!0,!1,null,"\0\b\n\f\r\t"]})==i&&"1"===r(null,n)&&"[\n 1,\n 2\n]"==r([1,2],null,1)&&'"-271821-04-20T00:00:00.000Z"'==r(new h(-864e13))&&'"+275760-09-13T00:00:00.000Z"'==r(new h(864e13))&&'"-000001-01-01T00:00:00.000Z"'==r(new h(-621987552e5))&&'"1969-12-31T23:59:59.999Z"'==r(new h(-1))}catch(e){o=!1}}t=o}if("json-parse"==e){var s=c.parse;if("function"==typeof s)try{if(0===s("0")&&!s(!1)){var a=5==(n=s(i)).a.length&&1===n.a[0];if(a){try{a=!s('"\t"')}catch(e){}if(a)try{a=1!==s("01")}catch(e){}if(a)try{a=1!==s("1.")}catch(e){}}}}catch(e){a=!1}t=a}}return p[e]=!!t}if(!p("json")){var f="[object Function]",N="[object Number]",P="[object String]",A="[object Array]",a=p("bug-string-char-index");if(!d)var O=i.floor,s=[0,31,59,90,120,151,181,212,243,273,304,334],I=function(e,t){return s[t]+365*(e-1970)+O((e-1969+(t=+(1<t)))/4)-O((e-1901+t)/100)+O((e-1601+t)/400)};if((T=o.hasOwnProperty)||(T=function(e){var n,t={};return T=(t.__proto__=null,t.__proto__={toString:1},t).toString!=E?function(e){var t=this.__proto__,n=e in(this.__proto__=null,this);return this.__proto__=t,n}:(n=t.constructor,function(e){var t=(this.constructor||n).prototype;return e in this&&!(e in t&&this[e]===t[e])}),t=null,T.call(this,e)}),S=function(e,t){var n,s,i,r=0;for(i in(n=function(){this.valueOf=0}).prototype.valueOf=0,s=new n)T.call(s,i)&&r++;return n=s=null,(S=r?2==r?function(e,t){var n,i={},r=E.call(e)==f;for(n in e)r&&"prototype"==n||T.call(i,n)||!(i[n]=1)||!T.call(e,n)||t(n)}:function(e,t){var n,i,r=E.call(e)==f;for(n in e)r&&"prototype"==n||!T.call(e,n)||(i="constructor"===n)||t(n);(i||T.call(e,n="constructor"))&&t(n)}:(s=["valueOf","toString","toLocaleString","propertyIsEnumerable","isPrototypeOf","hasOwnProperty","constructor"],function(e,t){var n,i,r=E.call(e)==f,o=!r&&"function"!=typeof e.constructor&&j[typeof e.hasOwnProperty]&&e.hasOwnProperty||T;for(n in e)r&&"prototype"==n||!o.call(e,n)||t(n);for(i=s.length;n=s[--i];o.call(e,n)&&t(n));}))(e,t)},!p("json-stringify")){var g={92:"\\\\",34:'\\"',8:"\\b",12:"\\f",10:"\\n",13:"\\r",9:"\\t"},M=function(e,t){return("000000"+(t||0)).slice(-e)},D=function(e){for(var t='"',n=0,i=e.length,r=!a||10<i,o=r&&(a?e.split(""):e);n<i;n++){var s=e.charCodeAt(n);switch(s){case 8:case 9:case 10:case 12:case 13:case 34:case 92:t+=g[s];break;default:if(s<32){t+="\\u00"+M(2,s.toString(16));break}t+=r?o[n]:e.charAt(n)}}return t+'"'},L=function(e,t,n,i,r,o,s){var a,c,l,u,h,d,p,f,g,m,v,y,b,w,C,_;try{a=t[e]}catch(e){}if("object"==typeof a&&a)if("[object Date]"!=(c=E.call(a))||T.call(a,"toJSON"))"function"==typeof a.toJSON&&(c!=N&&c!=P&&c!=A||T.call(a,"toJSON"))&&(a=a.toJSON(e));else if(-1/0<a&&a<1/0){if(I){for(h=O(a/864e5),l=O(h/365.2425)+1970-1;I(l+1,0)<=h;l++);for(u=O((h-I(l,0))/30.42);I(l,u+1)<=h;u++);h=1+h-I(l,u),p=O((d=(a%864e5+864e5)%864e5)/36e5)%24,f=O(d/6e4)%60,g=O(d/1e3)%60,m=d%1e3}else l=a.getUTCFullYear(),u=a.getUTCMonth(),h=a.getUTCDate(),p=a.getUTCHours(),f=a.getUTCMinutes(),g=a.getUTCSeconds(),m=a.getUTCMilliseconds();a=(l<=0||1e4<=l?(l<0?"-":"+")+M(6,l<0?-l:l):M(4,l))+"-"+M(2,u+1)+"-"+M(2,h)+"T"+M(2,p)+":"+M(2,f)+":"+M(2,g)+"."+M(3,m)+"Z"}else a=null;if(n&&(a=n.call(t,e,a)),null===a)return"null";if("[object Boolean]"==(c=E.call(a)))return""+a;if(c==N)return-1/0<a&&a<1/0?""+a:"null";if(c==P)return D(""+a);if("object"==typeof a){for(w=s.length;w--;)if(s[w]===a)throw k();if(s.push(a),v=[],C=o,o+=r,c==A){for(b=0,w=a.length;b<w;b++)y=L(b,a,n,i,r,o,s),v.push(y===x?"null":y);_=v.length?r?"[\n"+o+v.join(",\n"+o)+"\n"+C+"]":"["+v.join(",")+"]":"[]"}else S(i||a,function(e){var t=L(e,a,n,i,r,o,s);t!==x&&v.push(D(e)+":"+(r?" ":"")+t)}),_=v.length?r?"{\n"+o+v.join(",\n"+o)+"\n"+C+"}":"{"+v.join(",")+"}":"{}";return s.pop(),_}};c.stringify=function(e,t,n){var i,r,o,s;if(j[typeof t]&&t)if((s=E.call(t))==f)r=t;else if(s==A){o={};for(var a,c=0,l=t.length;c<l;a=t[c++],((s=E.call(a))==P||s==N)&&(o[a]=1));}if(n)if((s=E.call(n))==N){if(0<(n-=n%1))for(i="",10<n&&(n=10);i.length<n;i+=" ");}else s==P&&(i=n.length<=10?n:n.slice(0,10));return L("",((a={})[""]=e,a),r,o,i,"",[])}}if(!p("json-parse")){var m,v,y=u.fromCharCode,b={92:"\\",34:'"',47:"/",98:"\b",116:"\t",110:"\n",102:"\f",114:"\r"},w=function(){throw m=v=null,n()},C=function(){for(var e,t,n,i,r,o=v,s=o.length;m<s;)switch(r=o.charCodeAt(m)){case 9:case 10:case 13:case 32:m++;break;case 123:case 125:case 91:case 93:case 58:case 44:return e=a?o.charAt(m):o[m],m++,e;case 34:for(e="@",m++;m<s;)if((r=o.charCodeAt(m))<32)w();else if(92==r)switch(r=o.charCodeAt(++m)){case 92:case 34:case 47:case 98:case 116:case 110:case 102:case 114:e+=b[r],m++;break;case 117:for(t=++m,n=m+4;m<n;m++)48<=(r=o.charCodeAt(m))&&r<=57||97<=r&&r<=102||65<=r&&r<=70||w();e+=y("0x"+o.slice(t,m));break;default:w()}else{if(34==r)break;for(r=o.charCodeAt(m),t=m;32<=r&&92!=r&&34!=r;)r=o.charCodeAt(++m);e+=o.slice(t,m)}if(34==o.charCodeAt(m))return m++,e;w();default:if(t=m,45==r&&(i=!0,r=o.charCodeAt(++m)),48<=r&&r<=57){for(48==r&&(48<=(r=o.charCodeAt(m+1))&&r<=57)&&w(),i=!1;m<s&&(48<=(r=o.charCodeAt(m))&&r<=57);m++);if(46==o.charCodeAt(m)){for(n=++m;n<s&&(48<=(r=o.charCodeAt(n))&&r<=57);n++);n==m&&w(),m=n}if(101==(r=o.charCodeAt(m))||69==r){for(43!=(r=o.charCodeAt(++m))&&45!=r||m++,n=m;n<s&&(48<=(r=o.charCodeAt(n))&&r<=57);n++);n==m&&w(),m=n}return+o.slice(t,m)}if(i&&w(),"true"==o.slice(m,m+4))return m+=4,!0;if("false"==o.slice(m,m+5))return m+=5,!1;if("null"==o.slice(m,m+4))return m+=4,null;w()}return"$"},_=function(e){var t,n;if("$"==e&&w(),"string"==typeof e){if("@"==(a?e.charAt(0):e[0]))return e.slice(1);if("["==e){for(t=[];"]"!=(e=C());n||(n=!0))n&&(","==e?"]"==(e=C())&&w():w()),","==e&&w(),t.push(_(e));return t}if("{"==e){for(t={};"}"!=(e=C());n||(n=!0))n&&(","==e?"}"==(e=C())&&w():w()),","!=e&&"string"==typeof e&&"@"==(a?e.charAt(0):e[0])&&":"==C()||w(),t[e.slice(1)]=_(C());return t}w()}return e},B=function(e,t,n){var i=R(e,t,n);i===x?delete e[t]:e[t]=i},R=function(e,t,n){var i,r=e[t];if("object"==typeof r&&r)if(E.call(r)==A)for(i=r.length;i--;)B(r,i,n);else S(r,function(e){B(r,e,n)});return n.call(e,t,r)};c.parse=function(e,t){var n,i;return m=0,v=""+e,n=_(C()),"$"!=C()&&w(),m=v=null,t&&E.call(t)==f?R(((i={})[""]=n,i),"",t):n}}}return c.runInContext=z,c}var t=U.JSON,n=U.JSON3,i=!1,r=z(U,U.JSON3={noConflict:function(){return i||(i=!0,U.JSON=t,U.JSON3=n,t=n=null),r}});U.JSON={parse:r.parse,stringify:r.stringify}}.call(this),function(t){var e=function(){};e.prototype.setItem=function(e,t){localStorage.setItem(e,this.encode(t))},e.prototype.getItem=function(e){return this.decode(localStorage.getItem(e))},e.prototype.removeItem=function(e){localStorage.removeItem(e)},e.prototype.encode=function(e){return e?t.Base64.encode(e):e},e.prototype.decode=function(e){return e?t.Base64.decode(e):e},t.Cache=new e,e=null}(window.livechat),function(e){var t=function(){};t.prototype.getCookie=function(e){return e&&decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"))||null},t.prototype.setCookie=function(e,t,n,i,r,o){if(!e||/^(?:expires|max\-age|path|domain|secure)$/i.test(e))return!1;var s="";if(n)switch(n.constructor){case Number:if(n===1/0)s="; expires=Fri, 31 Dec 9999 23:59:59 GMT";else{var a=new Date;a.setTime(a.getTime()+n),s="; expires="+a.toUTCString()}break;case String:s="; expires="+n;break;case Date:s="; expires="+n.toUTCString()}return document.cookie=encodeURIComponent(e)+"="+encodeURIComponent(t)+s+(o?"; domain="+o:"")+(i?"; path="+i:"; path=/")+(r?"; secure":""),!0},t.prototype.removeCookie=function(e,t,n){return!!this.hasCookie(e)&&(document.cookie=encodeURIComponent(e)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT"+(n?"; domain="+n:"")+(t?"; path="+t:"; path=/"),!0)},t.prototype.hasCookie=function(e){return!!e&&new RegExp("(?:^|;\\s*)"+encodeURIComponent(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=").test(document.cookie)},t.prototype.cookieKeys=function(){for(var e=document.cookie.replace(/((?:^|\s*;)[^\=]+)(?=;|$)|^\s*|\s*(?:\=[^;]*)?(?:\1|$)/g,"").split(/\s*(?:\=[^;]*)?;\s*/),t=e.length,n=0;n<t;n++)e[n]=decodeURIComponent(e[n]);return e},e.Cookies=new t,t=null}(window.livechat),function(e){var t=function(){this.timezone={"International Date Line West":{tz:"-11",dst:"0"},"Midway Island":{tz:"-11",dst:"0"},"American Samoa":{tz:"-11",dst:"0"},Hawaii:{tz:"-10",dst:"0"},Alaska:{tz:"-9",dst:"3"},"America/Los_Angeles":{tz:"-8",dst:"3"},"Pacific Time (US & Canada)":{tz:"-8",dst:"3"},Tijuana:{tz:"-8",dst:"3"},Arizona:{tz:"-7",dst:"0"},Chihuahua:{tz:"-7",dst:"4"},Mazatlan:{tz:"-7",dst:"4"},"Mountain Time (US & Canada)":{tz:"-7",dst:"3"},"America/Chicago":{tz:"-6",dst:"3"},"Central America":{tz:"-6",dst:"3"},"Central Time (US & Canada)":{tz:"-6",dst:"3"},Guadalajara:{tz:"-6",dst:"4"},"Mexico City":{tz:"-6",dst:"4"},Monterrey:{tz:"-6",dst:"4"},Saskatchewan:{tz:"-6",dst:"0"},"America/Bogota":{tz:"-5",dst:"0"},Bogota:{tz:"-5",dst:"0"},"Eastern Time (US & Canada)":{tz:"-5",dst:"3"},"Indiana (East)":{tz:"-5",dst:"3"},Lima:{tz:"-5",dst:"0"},Quito:{tz:"-5",dst:"0"},Caracas:{tz:"-4.5",dst:"0"},"Atlantic Time (Canada)":{tz:"-4",dst:"3"},"La Paz":{tz:"-4",dst:"0"},Santiago:{tz:"-4",dst:"10"},Newfoundland:{tz:"-3.5",dst:"3"},Brasilia:{tz:"-3",dst:"9"},"Buenos Aires":{tz:"-3",dst:"0"},Georgetown:{tz:"-4",dst:"0"},Greenland:{tz:"-3",dst:"12"},"Mid-Atlantic":{tz:"-2",dst:"0"},Azores:{tz:"-1",dst:"11"},"Cape Verde Is.":{tz:"-1",dst:"0"},Casablanca:{tz:"0",dst:"1"},Dublin:{tz:"0",dst:"11"},Edinburgh:{tz:"0",dst:"11"},"Europe/London":{tz:"0",dst:"11"},Lisbon:{tz:"0",dst:"11"},London:{tz:"0",dst:"11"},Monrovia:{tz:"0",dst:"0"},UTC:{tz:"0",dst:"0"},Amsterdam:{tz:"1",dst:"1"},Belgrade:{tz:"1",dst:"1"},Berlin:{tz:"1",dst:"1"},Bern:{tz:"1",dst:"1"},Bratislava:{tz:"1",dst:"1"},Brussels:{tz:"1",dst:"1"},Budapest:{tz:"1",dst:"1"},Copenhagen:{tz:"1",dst:"1"},Ljubljana:{tz:"1",dst:"1"},Madrid:{tz:"1",dst:"1"},Paris:{tz:"1",dst:"1"},Prague:{tz:"1",dst:"1"},Rome:{tz:"1",dst:"1"},Sarajevo:{tz:"1",dst:"1"},Skopje:{tz:"1",dst:"1"},Stockholm:{tz:"1",dst:"1"},Vienna:{tz:"1",dst:"1"},Warsaw:{tz:"1",dst:"1"},"West Central Africa":{tz:"1",dst:"0"},Zagreb:{tz:"1",dst:"1"},Athens:{tz:"2",dst:"2"},Bucharest:{tz:"2",dst:"2"},Cairo:{tz:"2",dst:"0"},Harare:{tz:"2",dst:"0"},Helsinki:{tz:"2",dst:"2"},Istanbul:{tz:"2",dst:"2"},Jerusalem:{tz:"2",dst:"8"},Kyiv:{tz:"2",dst:"2"},Minsk:{tz:"2",dst:"13"},Pretoria:{tz:"2",dst:"0"},Riga:{tz:"2",dst:"2"},Sofia:{tz:"2",dst:"2"},Tallinn:{tz:"2",dst:"2"},Vilnius:{tz:"2",dst:"2"},Baghdad:{tz:"3",dst:"0"},Kuwait:{tz:"3",dst:"0"},Moscow:{tz:"3",dst:"13"},Nairobi:{tz:"3",dst:"0"},Riyadh:{tz:"3",dst:"0"},"St. Petersburg":{tz:"3",dst:"13"},Volgograd:{tz:"3",dst:"13"},Tehran:{tz:"3.5",dst:"7"},"Abu Dhabi":{tz:"4",dst:"0"},Baku:{tz:"4",dst:"1"},Muscat:{tz:"4",dst:"0"},Tbilisi:{tz:"4",dst:"0"},Yerevan:{tz:"4",dst:"0"},Kabul:{tz:"4.5",dst:"0"},Ekaterinburg:{tz:"5",dst:"13"},Islamabad:{tz:"5",dst:"0"},Karachi:{tz:"5",dst:"0"},Tashkent:{tz:"5",dst:"0"},Chennai:{tz:"5.5",dst:"0"},Kolkata:{tz:"5.5",dst:"0"},Mumbai:{tz:"5.5",dst:"0"},"New Delhi":{tz:"5.5",dst:"0"},"Sri Jayawardenepura":{tz:"5.5",dst:"0"},Kathmandu:{tz:"5.75",dst:"0"},Almaty:{tz:"6",dst:"0"},Astana:{tz:"6",dst:"0"},Dhaka:{tz:"6",dst:"0"},Novosibirsk:{tz:"6",dst:"13"},Rangoon:{tz:"6.5",dst:"0"},Bangkok:{tz:"7",dst:"0"},Hanoi:{tz:"7",dst:"0"},Jakarta:{tz:"7",dst:"0"},Krasnoyarsk:{tz:"7",dst:"13"},Beijing:{tz:"8",dst:"0"},Chongqing:{tz:"8",dst:"0"},"Hong Kong":{tz:"8",dst:"0"},Irkutsk:{tz:"8",dst:"13"},"Kuala Lumpur":{tz:"8",dst:"0"},Perth:{tz:"8",dst:"0"},Singapore:{tz:"8",dst:"0"},Taipei:{tz:"8",dst:"0"},"Ulaan Bataar":{tz:"8",dst:"0"},Urumqi:{tz:"8",dst:"0"},Osaka:{tz:"9",dst:"0"},Sapporo:{tz:"9",dst:"0"},Seoul:{tz:"9",dst:"0"},Tokyo:{tz:"9",dst:"0"},Yakutsk:{tz:"9",dst:"13"},"Adelaide (CT)":{tz:"9.5",dst:"5"},Adelaide:{tz:"9.5",dst:"5"},Darwin:{tz:"9.5",dst:"0"},Brisbane:{tz:"10",dst:"0"},Canberra:{tz:"10",dst:"5"},Guam:{tz:"10",dst:"0"},Hobart:{tz:"10",dst:"5"},Melbourne:{tz:"10",dst:"5"},"Port Moresby":{tz:"10",dst:"0"},Sydney:{tz:"10",dst:"5"},Vladivostok:{tz:"10",dst:"13"},Magadan:{tz:"11",dst:"13"},"New Caledonia":{tz:"11",dst:"0"},"Solomon Is.":{tz:"11",dst:"0"},Auckland:{tz:"12",dst:"6"},Fiji:{tz:"12",dst:"0"},Kamchatka:{tz:"12",dst:"0"},"Marshall Is.":{tz:"12",dst:"0"},Wellington:{tz:"12",dst:"6"},"Nuku'alofa":{tz:"13",dst:"0"}},this.dstTypes={1:{startMonth:"2",endMonth:"9",startPeriod:"31",endPeriod:"31",startHour:"2",endHour:"3",startDay:"0",endDay:"0"},2:{startMonth:"2",endMonth:"9",startPeriod:"31",endPeriod:"31",startHour:"3",endHour:"4",startDay:"0",endDay:"0"},3:{startMonth:"2",endMonth:"10",startPeriod:"14",endPeriod:"7",startHour:"2",endHour:"2",startDay:"0",endDay:"0"},4:{startMonth:"3",endMonth:"9",startPeriod:"7",endPeriod:"30",startHour:"2",endHour:"2",startDay:"0",endDay:"0"},5:{startMonth:"3",endMonth:"9",startPeriod:"7",endPeriod:"7",startHour:"3",endHour:"2",startDay:"0",endDay:"0"},6:{startMonth:"3",endMonth:"8",startPeriod:"7",endPeriod:"30",startHour:"3",endHour:"2",startDay:"0",endDay:"0"},7:{startMonth:"2",endMonth:"8",startHour:"0",endHour:"0"},8:{startMonth:"2",endMonth:"9",startPeriod:"31",endPeriod:"31",startHour:"2",endHour:"2",startDay:"5",endDay:"0"},9:{startMonth:"1",endMonth:"9",startPeriod:"29",endPeriod:"31",startHour:"0",endHour:"0",startDay:"0",endDay:"0"},10:{startMonth:"3",endMonth:"8",startPeriod:"30",endPeriod:"7",startHour:"0",endHour:"0",startDay:"0",endDay:"0"},11:{startMonth:"2",endMonth:"9",startPeriod:"31",endPeriod:"31",startHour:"1",endHour:"2",startDay:"0",endDay:"0"},12:{startMonth:"2",endMonth:"9",startPeriod:"31",endPeriod:"31",startHour:"22",endHour:"23",startDay:"6",endDay:"6"}}};t.prototype.getMonthName=function(e){return["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][e]},t.prototype.timeFormat=function(e){var t=Number(e.match(/^(\d+)/)[1]),n=Number(e.match(/:(\d+)/)[1]),i=e.match(/\s(.*)$/)[1];return"pm"==i&&t<12&&(t+=12),"am"==i&&12==t&&(t-=12),60*t+n},t.prototype.setDST=function(e,t,n,i,r,o,s){var a=(new Date).getFullYear();if(t.setFullYear(a),n.setFullYear(a),7==e)t.setDate(i),n.setDate(r);else{t.setDate(i);var c=t.getDay(),l=Number(i)-c,u=l-7+Number(o);c!=o&&(8==e||12==e?o<=i-l?t.setDate(l+Number(o)):t.setDate(u):t.setDate(l-Number(o))),n.setDate(r),u=(l=r-(c=n.getDay()))-7+Number(s),c!=s&&(12==e?s<=r-l?n.setDate(l+Number(s)):n.setDate(u):n.setDate(l-Number(s)))}},t.prototype.dstTime=function(e){var t=!1,n=new Date,i=new Date(n.getUTCFullYear(),n.getUTCMonth(),n.getUTCDate(),n.getUTCHours(),n.getUTCMinutes(),n.getUTCSeconds()).getTime()-n.getTime(),r=new Date,o=Math.floor(60*this.timezone[e].tz*60*1e3),s=this.timezone[e].dst;if(0==s||13==s)13==s&&(t=!0);else{var a=this.dstTypes[s],c=new Date;c.setTime(c.getTime()+i);var l=new Date,u=new Date;new Date;switch(l.setMonth(a.startMonth),l.setHours(1),l.setMinutes(0),l.setSeconds(0),l.setMilliseconds(0),u.setMonth(a.endMonth),u.setHours(1),u.setMinutes(0),u.setSeconds(0),u.setMilliseconds(0),Number(s)){case 1:case 2:case 3:case 4:case 5:case 6:case 8:case 9:case 10:case 11:case 12:"Baku"==e?(l.setHours(4),u.setHours(5)):"Azores"==e?(l.setHours(12),u.setHours(1)):(l.setHours(a.startHour),u.setHours(a.endHour)),this.setDST(s,l,u,a.startPeriod,a.endPeriod,a.startDay,a.endDay);break;case 7:l.setHours(a.startHour),u.setHours(a.endHour);var h=end=22;this.setDST(s,l,u,h,end)}5==s||6==s||9==s||10==s?c.getTime()>l.getTime()&&c.getTime()<u.getTime()||(t=!0):c.getTime()>l.getTime()&&c.getTime()<u.getTime()&&(t=!0)}return r.setTime(r.getTime()+o+i+(t?36e5:0)),r},t.prototype.isBusinessHour=function(e){if("null"==e||!e)return!0;var t=JSON.parse(e),n=this.dstTime(t.time_zone),i=new Date(n),r=i.getDate(),o=this.getMonthName(i.getMonth()),s=t.holiday_data;for(var a in s)if(s.hasOwnProperty(a)&&s[a][0]==o+" "+r)return!1;var c=i.getDay(),l=i.getHours(),u=i.getMinutes(),h=t.business_time_data.working_hours[c];if(!h)return!1;var d=h.beginning_of_workday,p=this.timeFormat(d),f=h.end_of_workday,g=this.timeFormat(f);return!((l=60*l+u)<p||g<=l)},e.BusinessHours=new t}(window.livechat),function(t){t.jQuery;var e=function(){};e.prototype.parseAddress=function(e){var t=e[0].address_components;if(t&&t instanceof Array){for(var n={latitude:window.Geo.lat,longitude:window.Geo.lon,source:"google",ipAddress:window.Geo.IP},i={},r=0;r<t.length;r++){if(t[r].types&&t[r].types instanceof Array)switch(t[r].types[0]){case"locality":i.city=t[r].long_name;break;case"administrative_area_level_1":i.region=t[r].long_name;break;case"country":i.country=t[r].long_name,i.country_code=t[r].short_name}n.address=i}return n}},e.prototype.trimInvalidData=function(e){return t.JSON3.parse(t.JSON3.stringify(e).replace("undefined",""))},e.prototype.fetch=function(e){},t.Location=new e,e=null}(window.livechat),function(e){e.jQuery;var t=function(){this.data={browser:[{string:navigator.userAgent,subString:"Chrome",identity:"Chrome"},{string:navigator.userAgent,subString:"OmniWeb",versionSearch:"OmniWeb/",identity:"OmniWeb"},{string:navigator.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{prop:window.opera,identity:"Opera",versionSearch:"Version"},{string:navigator.vendor,subString:"iCab",identity:"iCab"},{string:navigator.vendor,subString:"KDE",identity:"Konqueror"},{string:navigator.userAgent,subString:"Firefox",identity:"Firefox"},{string:navigator.vendor,subString:"Camino",identity:"Camino"},{string:navigator.userAgent,subString:"Netscape",identity:"Netscape"},{string:navigator.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"},{string:navigator.userAgent,subString:"Gecko",identity:"Mozilla",versionSearch:"rv"},{string:navigator.userAgent,subString:"Mozilla",identity:"Netscape",versionSearch:"Mozilla"}],os:[{string:navigator.platform,subString:"Win",identity:"Windows"},{string:navigator.platform,subString:"Mac",identity:"Mac"},{string:navigator.userAgent,subString:"iPhone",identity:"iPhone/iPod"},{string:navigator.userAgent,subString:"iPad",identitiy:"iPad"},{string:navigator.platform,subString:"Linux",identity:"Linux"},{string:navigator.userAgent,subString:"Android",identity:"Android"}]}};t.prototype.detect=function(e){e({browser:this.search(this.data.browser),version:this.search(navigator.userAgent)||this.search(navigator.appVersion),os:this.search(this.data.os)})},t.prototype.search=function(e){if("object"!=typeof e){var t=e.indexOf(this.version_string);if(-1==t)return;return parseFloat(e.substr(t+this.version_string.length+1))}for(var n=0;n<e.length;n++){var i=e[n].string,r=e[n].prop;if(this.version_string=e[n].versionSearch||e[n].identity,i){if(-1!=i.indexOf(e[n].subString))return e[n].identity}else if(r)return e[n].identity}},e.Browser=new t}(window.livechat),function(e){var t=function(){this.token=/d{1,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|[LloSZ]|"[^"]*"|'[^']*'/g,this.timezone=/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,this.timezoneClip=/[^-+\dA-Z]/g,this.masks={default:"ddd mmm dd yyyy HH:MM:ss",shortDate:"m/d/yy",mediumDate:"mmm d, yyyy",longDate:"mmmm d, yyyy",fullDate:"dddd, mmmm d, yyyy",shortTime:"h:MM TT",mediumTime:"h:MM:ss TT",longTime:"h:MM:ss TT Z",isoDate:"yyyy-mm-dd",isoTime:"HH:MM:ss",isoDateTime:"yyyy-mm-dd'T'HH:MM:ss",isoUtcDateTime:"UTC:yyyy-mm-dd'T'HH:MM:ss'Z'"},this.i18n={dayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec","January","February","March","April","May","June","July","August","September","October","November","December"]}};t.prototype.pad=function(e,t){for(e=String(e),t=t||2;e.length<t;)e="0"+e;return e},t.prototype.format=function(e,t,n){if(1!=arguments.length||"[object String]"!=Object.prototype.toString.call(e)||/\d/.test(e)||(t=e,e=void 0),e=e?new Date(e):new Date,isNaN(e))throw SyntaxError("invalid date");"UTC:"==(t=String(this.masks[t]||t||this.masks.default)).slice(0,4)&&(t=t.slice(4),n=!0);var i=n?"getUTC":"get",r=e[i+"Date"](),o=e[i+"Day"](),s=e[i+"Month"](),a=e[i+"FullYear"](),c=e[i+"Hours"](),l=e[i+"Minutes"](),u=e[i+"Seconds"](),h=e[i+"Milliseconds"](),d=n?0:e.getTimezoneOffset(),p={d:r,dd:this.pad(r),ddd:this.i18n.dayNames[o],dddd:this.i18n.dayNames[o+7],m:s+1,mm:this.pad(s+1),mmm:this.i18n.monthNames[s],mmmm:this.i18n.monthNames[s+12],yy:String(a).slice(2),yyyy:a,h:c%12||12,hh:this.pad(c%12||12),H:c,HH:this.pad(c),M:l,MM:this.pad(l),s:u,ss:this.pad(u),l:this.pad(h,3),L:this.pad(99<h?Math.round(h/10):h),t:c<12?"a":"p",tt:c<12?"am":"pm",T:c<12?"A":"P",TT:c<12?"AM":"PM",Z:n?"UTC":(String(e).match(this.timezone)||[""]).pop().replace(this.timezoneClip,""),o:(0<d?"-":"+")+this.pad(100*Math.floor(Math.abs(d)/60)+Math.abs(d)%60,4),S:["th","st","nd","rd"][3<r%10?0:(r%100-r%10!=10)*r%10]};return t.replace(this.token,function(e){return e in p?p[e]:e.slice(1,e.length-1)})},e.DateFormatter=new t,t=null}(window.livechat),function(){"use strict";function e(){}var t=e.prototype;function o(e,t){for(var n=e.length;n--;)if(e[n].listener===t)return n;return-1}function n(e){return function(){return this[e].apply(this,arguments)}}this.globalEventListeners=[],t.globalEventListeners=this.globalEventListeners,t.getListeners=function(e){var t,n,i=this._getEvents();if(e instanceof RegExp)for(n in t={},i)i.hasOwnProperty(n)&&e.test(n)&&(t[n]=i[n]);else t=i[e]||(i[e]=[]);return t},t.flattenListeners=function(e){var t,n=[];for(t=0;t<e.length;t+=1)n.push(e[t].listener);return n},t.getListenersAsObject=function(e){var t,n=this.getListeners(e);return n instanceof Array&&((t={})[e]=n),t||n},t.addListener=function(e,t){var n,i=this.getListenersAsObject(e),r="object"==typeof t;for(n in i)i.hasOwnProperty(n)&&-1===o(i[n],t)&&i[n].push(r?t:{listener:t,once:!1});return this},t.addGlobalListener=function(e){var t="object"==typeof e;-1==o(window.livechat.globalEventListeners,e)&&window.livechat.globalEventListeners.push(t?e:{listener:e,once:!1})},t.on=n("addListener"),t.addOnceListener=function(e,t){return this.addListener(e,{listener:t,once:!0})},t.once=n("addOnceListener"),t.defineEvent=function(e){return this.getListeners(e),this},t.defineEvents=function(e){for(var t=0;t<e.length;t+=1)this.defineEvent(e[t]);return this},t.removeListener=function(e,t){var n,i,r=this.getListenersAsObject(e);for(i in r)r.hasOwnProperty(i)&&-1!==(n=o(r[i],t))&&r[i].splice(n,1);return this},t.off=n("removeListener"),t.addListeners=function(e,t){return this.manipulateListeners(!1,e,t)},t.removeListeners=function(e,t){return this.manipulateListeners(!0,e,t)},t.manipulateListeners=function(e,t,n){var i,r,o=e?this.removeListener:this.addListener,s=e?this.removeListeners:this.addListeners;if("object"!=typeof t||t instanceof RegExp)for(i=n.length;i--;)o.call(this,t,n[i]);else for(i in t)t.hasOwnProperty(i)&&(r=t[i])&&("function"==typeof r?o.call(this,i,r):s.call(this,i,r));return this},t.removeEvent=function(e){var t,n=typeof e,i=this._getEvents();if("string"===n)delete i[e];else if(e instanceof RegExp)for(t in i)i.hasOwnProperty(t)&&e.test(t)&&delete i[t];else delete this._events;return this},t.removeAllListeners=n("removeEvent"),t.emitEvent=function(e,t){var n,i,r,o=this.getListenersAsObject(e);for(r in o)if(o.hasOwnProperty(r))for(i=o[r].length;i--;)!0===(n=o[r][i]).once&&this.removeListener(e,n.listener),n.listener.apply(this,t||[])===this._getOnceReturnValue()&&this.removeListener(e,n.listener);return this},t.triggerGloablEvent=function(e,t){var n=window.livechat.globalEventListeners.length,i=[e];Array.prototype.push.apply(i,t);for(var r=0;r<n;r++)window.livechat.globalEventListeners[r].listener.apply(this,i)},t.trigger=n("emitEvent"),t.emit=function(e){var t=Array.prototype.slice.call(arguments,1);return this.emitEvent(e,t)},t.setOnceReturnValue=function(e){return this._onceReturnValue=e,this},t._getOnceReturnValue=function(){return!this.hasOwnProperty("_onceReturnValue")||this._onceReturnValue},t._getEvents=function(){return this._events||(this._events={})},this.EventEmitter=e}.call(window.livechat),"undefined"!=typeof exports&&"undefined"!=typeof require&&"undefined"==typeof setTimeout&&(setTimeout=require("timers").setTimeout,clearTimeout=require("timers").clearTimeout),AbstractChannel.subclass=function(e){var t=function(){this.constructor.apply(this,arguments),this.baseConstructor.apply(this,arguments)};for(var n in t.prototype=new AbstractChannel,e)e.hasOwnProperty(n)&&(t.prototype[n]=e[n]);return t},AbstractChannel.prototype={onmessage:null,rawdata:!1,onclose:null,onopen:null,closed:!1,baseConstructor:function(){this._buffer=[],this._setupConnection()},send:function(e){if(this.closed)throw"Cannot send to a closed connection";this._ready()?this._send(e):this._buffer.push(e)},_flush:function(){for(var e=0;e<this._buffer.length;e++)this._send(this._buffer[e]);this._buffer=[]},_incoming:function(t){if("o"!=t){if(!this.rawdata&&"object"!=typeof t)try{t=JSON.parse(t)}catch(e){throw console.error("Got invalid JSON data:",t.substr(0,40)),e}this.onmessage&&this.onmessage(t)}}};var WebSocketChannel=AbstractChannel.subclass({constructor:function(e){0===e.search(/^https?:/i)&&(e=e.replace(/^http/i,"ws")),this.address=e,this.socket=null,this._reopening=!1,this.pingIntervalId=null},toString:function(){var e="[WebSocketChannel to "+this.address;return this.socket?e+=" readyState: "+this.socket.readyState:e+=" (socket unopened)",this.closed&&(e+=" CLOSED"),e+"]"},close:function(){this.closed=!0,this.socket?this.socket.close():this.onclose&&this.onclose()},_send:function(e){this.socket.send(e)},_ready:function(){return this.socket&&this.socket.readyState==this.socket.OPEN},_setupConnection:function(){this.closed||(this.socket=new WebSocket(this.address),this.socket.onopen=function(){this._flush(),!this._reopening&&this.onopen&&this.onopen(),pingSocket=this.socket,this.pingIntervalId=setInterval(function(){pingSocket.send("h")},3e4),this._reopening=!1}.bind(this),this.socket.onclose=function(e){this.socket=null,clearInterval(this.pingIntervalId),console.error("WebSocket close",e.wasClean?"clean":"unclean","code:",e.code,"reason:",e.reason||"none"),this.closed||(this._reopening=!0,this._setupConnection())}.bind(this),this.socket.onmessage=function(e){this._incoming(e.data)}.bind(this),this.socket.onerror=function(e){console.error("WebSocket error:",e.data)}.bind(this))}}),SocketIoChannel=AbstractChannel.subclass({constructor:function(e,t,n,i,r,o){this.socket=null,this.room=e,this.role=t,this.viewerId=n,this.sdata=i,this.siteId=r,this.chatId=o},toString:function(){var e="[SocketIoChannel to "+this.address;return this.socket?this.socket.connected?e+=" CONNECTED":e+=" CLOSED":e+=" (socket unopened)",e+"]"},close:function(){this.socket&&(this.closed=!0,this.socket.disconnect())},_send:function(e){try{"websocket"!=this.socket.io.engine.transport.name&&e.body&&(e.body=encodeURIComponent(JSON.stringify(e.body)),e.datatype="bytearray"),this.socket.emit("message",e)}catch(e){console.error(e)}},_ready:function(){return this.socket&&this.socket.connected},_setupConnection:function(){var e;e=livechat&&livechat.io?livechat.io:io;var t=["?role=",this.role,"&i=",this.viewerId.toString(),"&s=",this.sdata,"&siteId=",this.siteId,"&room=",this.room.toString()].join("");this.socket=e(OneClickCbUtils.safeSessionGetItem("cobrowsingChannel")+t,{forceNew:!0});var n=function(){this.socket.emit("join",{room:this.room,role:this.role,i:this.viewerId.toString(),s:this.sdata,siteId:this.siteId,chatId:this.chatId}),this._flush()}.bind(this);this.socket.on("connect",n);var i=function(e){this._incoming(e)}.bind(this);this.socket.on("message",i)}}),PostMessageChannel=AbstractChannel.subclass({_pingPollPeriod:100,_pingPollIncrease:100,_pingMax:2e3,constructor:function(e,t){this.expectedOrigin=t,this._pingReceived=!1,this._receiveMessage=this._receiveMessage.bind(this),e&&this.bindWindow(e,!0),this._pingFailures=0},toString:function(){var e="[PostMessageChannel";return this.window?e+=" to window "+this.window:e+=" not bound to a window",this.window&&!this._pingReceived&&(e+=" still establishing"),e+"]"},bindWindow:function(e,t){this.window&&(this.close(),this.closed=!1),e&&e.contentWindow&&(e=e.contentWindow),this.window=e;var n=this.window;"undefined"!=typeof window&&(n=window),n.addEventListener("message",this._receiveMessage,!1),t||this._setupConnection()},_send:function(e){this.window.postMessage(e,this.expectedOrigin||"*")},_ready:function(){return this.window&&this._pingReceived},_setupConnection:function(){if(!this.closed&&!this._pingReceived&&this.window){this._pingFailures++,this._send("hello");var e=this._pingPollPeriod+this._pingPollIncrease*this._pingFailures;e=e>this._pingPollMax?this._pingPollMax:e,this._pingTimeout=setTimeout(this._setupConnection.bind(this),e)}},_receiveMessage:function(e){if(e.source===this.window)if(this.expectedOrigin&&e.origin!=this.expectedOrigin)console.info("Expected message from",this.expectedOrigin,"but got message from",e.origin);else{if(this.expectedOrigin||(this.expectedOrigin=e.origin),"hello"==e.data)return this._pingReceived=!0,this._pingTimeout&&(clearTimeout(this._pingTimeout),this._pingTimeout=null),this.onopen&&this.onopen(),void this._flush();this._incoming(e.data)}},close:function(){this.closed=!0,this._pingReceived=!1,this._pingTimeout&&clearTimeout(this._pingTimeout),window.removeEventListener("message",this._receiveMessage,!1),this.onclose&&this.onclose()}}),PostMessageIncomingChannel=AbstractChannel.subclass({constructor:function(e){this.source=null,this.expectedOrigin=e,this._receiveMessage=this._receiveMessage.bind(this),window.addEventListener("message",this._receiveMessage,!1)},toString:function(){var e="[PostMessageIncomingChannel";return this.source?e+=" bound to source "+e:e+=" awaiting source",e+"]"},_send:function(e){for(var t=0;t<this._buffer.length;t++)this.source.postMessage(this._buffer[t],this.expectedOrigin);this._buffer=[],this.source.postMessage(e,this.expectedOrigin)},_ready:function(){return!!this.source},_setupConnection:function(){},_receiveMessage:function(e){this.expectedOrigin&&"*"!=this.expectedOrigin&&e.origin!=this.expectedOrigin?console.info("Expected message from",this.expectedOrigin,"but got message from",e.origin):(this.expectedOrigin||(this.expectedOrigin=e.origin),this.source||(this.source=e.source),"hello"!=e.data?this._incoming(e.data):this.source.postMessage("hello",this.expectedOrigin))},close:function(){this.closed=!0,window.removeEventListener("message",this._receiveMessage,!1),this._pingTimeout&&clearTimeout(this._pingTimeout),this.onclose&&this.onclose()}}),CHROME_CHANNEL_EVENT="BrowserMirrorChromeChannel",ChromePostMessageChannel=AbstractChannel.subclass({_pingPollPeriod:100,constructor:function(e,t,n){this.expectedOrigin=n,this._pingReceived=!1,this.doc=t,e&&this.bindWindow(e,!0),this._receiveMessage=this._receiveMessage.bind(this),this.doc.addEventListener(CHROME_CHANNEL_EVENT,this._receiveMessage,!1,!0)},toString:function(){var e="[ChromePostMessageChannel";return this.window?e+=" to window "+this.window:e+=" not bound to a window",this.window&&!this._pingReceived&&(e+=" still establishing"),e+"]"},bindWindow:function(e,t){this.window&&this.close(),e&&e.contentWindow&&(e=e.contentWindow),this.window=e,t||this._setupConnection()},_send:function(e){this.window.postMessage(e,this.expectedOrigin||"*")},_ready:function(){return this.window&&this.pingReceived},_setupConnection:function(){this.closed||this._pingReceived||!this.window||(this._send("hello"),this._pingTimeout=setTimeout(this._setupConnection.bind(this),this._pingPollPeriod))},_receiveMessage:function(e){var t=e.target,n=t.getAttribute("data-payload");if(t.parentNode.removeChild(t),t=null,"hello"==n)return this._pingReceived=!0,this._pingTimeout&&(clearTimeout(this._pingTimeout),this._pingTimeout=null),this.onopen&&this.onopen(),void this._flush();self._incoming(n)},close:function(){this.closed=!0,this.doc.remoteEventListener(CHROME_CHANNEL_EVENT,this._receiveMessage,!1,!0),this._pingTimeout&&clearTimeout(this._pingTimeout),this.onclose&&this.onclose()}}),ChromePostMessageIncomingChannel=AbstractChannel.subclass({constructor:function(){this._receiveMessage=this._receiveMessage.bind(this),window.addEventListener("message",this._receiveMessage,!1)},toString:function(){return"[ChromePostMessageIncomingChannel]"},_ready:function(){return!!document.head},_send:function(e){var t=document.createEvent("Events");t.initEvent(CHROME_CHANNEL_EVENT,!0,!1);var n=document.createElement("BrowserMirrorPayloadElement");n.setAttribute("data-payload",e),document.head.appendChild(n),n.dispatchEvent(t)},_setupConnection:function(){},_receiveMessage:function(e){e.source||e.origin||("hello"!=e.data?this._incoming(e.data):this._ready()?this._send("hello"):setTimeout(function(){this._receiveMessage(e)}.bind(this),100))},close:function(){this.closed=!0,window.removeEventListener("message",this._receiveMessage,!1),this.onclose&&this.onclose()}}),PortChannel=AbstractChannel.subclass({constructor:function(e,t){this.prefix=t||"",this.port=e,this._incoming=this._incoming.bind(this),this._remoteOpened=this._remoteOpened.bind(this),this._remoteClosed=this._remoteClosed.bind(this),this._gotHello=!1},toString:function(){var e="[PortChannel";return e+=" port: "+this.port.toString(),this.prefix&&(e+=' prefix: "'+this.prefix+'"'),e+="]"},_setupConnection:function(){this.port.on(this.prefix+"Send",this._incoming),this.port.on(this.prefix+"Opened",this._remoteOpened),this.port.on(this.prefix+"Closed",this._remoteClosed),this.port.emit("Opened")},destroy:function(){this.port.removeListener(this.prefix+"Send",this._incoming),this.port.removeListener(this.prefix+"Opened",this._remoteOpened),this.port.removeListener(this.prefix+"Closed",this._remoteClosed)},_ready:function(){return this._gotHello},_remoteOpened:function(e){this._gotHello=!0,e||this.port.emit("Opened",!0),this.onopen&&this.onopen(),this._flush()},_remoteClosed:function(){this._gotHello=!1,this.onclose&&this.onclose(),this.destroy()},close:function(){this.port.emit("Closed"),this._remoteClosed()},_send:function(e){this.port.emit("Send",e)}}),PortProxyChannel=AbstractChannel.subclass({constructor:function(e,t){this.prefix=e||"",this.self=t||self,this._incoming=this._incoming.bind(this),this._remoteOpened=this._remoteOpened.bind(this)},toString:function(){var e="[PortProxyChannel";return"undefined"!=typeof self&&this.self===self||(e+=" bound to self "+this.self),this.prefix&&(e+=' with prefix "'+this.prefix+'"'),e+"]"},_setupConnection:function(){this.self.port.on(this.prefix+"IncomingData",this._incoming),this.self.port.on(this.prefix+"Opened",this._remoteOpened)},_ready:function(){return!0},_send:function(e){this.self.port.emit(this.prefix+"SendData",e)},close:function(){try{this.self.port.emit(this.prefix+"Close")}catch(e){console.log("Error on close",e,e.name)}this.self.port.removeListener(this.prefix+"IncomingData",this._incoming),this.self.port.removeListener(this.prefix+"Opened",this._remoteOpened),this.closed=!0,this.onclose&&this.onclose()},_remoteOpened:function(){this.onopen&&this.onopen()}});function PortIncomingChannel(t,n,i){function e(e){t.send(e)}function r(){i.port.removeListener(n+"SendData",e),i.port.removeListener(n+"Close",r),t.close()}return n=n||"",(i=i||self).port.on(n+"SendData",e),i.port.on(n+"Close",r),t.rawdata=!0,t.onmessage=function(e){i.port.emit(n+"IncomingData",e)},t.onopen=function(){i.port.emit(n+"Opened")},t.onclose=function(){i.port.emit(n+"Closed")},{close:r}}function EchoProxy(e,t,n){var r=[];function i(n,e,i){function t(){for(var e=[n],t=0;t<arguments.length;t++)e.push(arguments[t]);i.port.emit.apply(i.port,e)}e.port.on(n,t),r.push([e.port,n,t])}return i((n=n||"")+"IncomingData",t,e),i(n+"Opened",t,e),i(n+"Closed",t,e),i(n+"SendData",e,t),i(n+"Close",e,t),{close:function(){for(var e=0;e<r.length;e++)r[e][0].removeListener(r[e][1],r[e][2])},send:function(e){"string"!=typeof e&&(e=JSON.stringify(e)),t.port.emit(n+"SendData",e)}}}function getElementPosition(e){for(var t=0,n=0;e;)e.offsetTop&&(t+=e.offsetTop),e.offsetLeft&&(n+=e.offsetLeft),e=e.offsetParent;return{top:t,left:n}}function doOnLoad(e){"complete"==this.document.readyState?e():window.addEventListener("load",e,!1)}function getScreenRange(e){for(var t=(e=e||document).defaultView,n=t.pageYOffset,i=n+t.innerHeight,r=iterNodes(document.body),o=!0,s=null,a=null,c=0,l=0;;){var u=r();if(!u)break;if(!u.jsmirrorHide&&u.jsmirrorId&&u.nodeType==document.ELEMENT_NODE){for(var h=0,d=u;d;)d.offsetTop&&(h+=d.offsetTop),d=d.offsetParent;if(o){if(n<h){s=a=u,o=!1,c=n-h;continue}}else{if(h+u.clientHeight>i)break;l=i-(h+u.clientHeight),a=u}}}return{start:s,end:a,startOffsetTop:c,endOffsetTop:l}}function iterNodes(e){var n=[[e,null]],i=0;return function(){if(!n[i])return null;var e=n[i];if(null===e[1]){if(!(t=e[0]))throw"weird item in stack";t.nodeType==this.document.ELEMENT_NODE&&t.childNodes.length?n[i]=[t.childNodes,0]:(n[i]=null,i--)}else{var t;if(!(t=e[0][e[1]]))throw"weird item in stack";t.nodeType==this.document.ELEMENT_NODE&&t.childNodes.length?e[1]>=e[0].length-1?n[i]=[t.childNodes,0]:(e[1]++,n[++i]=[t.childNodes,0]):e[1]>=e[0].length-1?(n[i]=null,i--):e[1]++}return t}}function expandRange(e){var n={start:e.startContainer,end:e.endContainer,startOffset:e.startOffset,endOffset:e.endOffset,startText:!1,endText:!1};function t(e){if(n[e].nodeType==this.document.TEXT_NODE)for(;;){var t=n[e].previousSibling;if(null===t){n[e]=n[e].parentNode,n[e+"Text"]="inner";break}if(t.nodeType==this.document.ELEMENT_NODE){n[e]=t,n[e+"Text"]="after";break}t.nodeType==this.document.TEXT_NODE&&(n[e]=t,n[e+"Offset"]+=t.nodeValue.length)}}return t("start"),t("end"),n}function showRange(e,t){var n;if(e.start!=e.end||"inner"!=e.startText||"inner"!=e.endText){"inner"==e.startText?e.start=splitTextAfter(e.start.childNodes[0],e.startOffset):"after"==e.startText?e.start=splitTextAfter(e.start.nextSibling,e.startOffset):e.startOffset&&(n=e.start.childNodes[e.startOffset])&&(e.start=n),"inner"==e.endText?e.end=splitTextBefore(e.end.childNodes[0],e.endOffset):"after"==e.endText?e.end=splitTextBefore(e.end.nextSibling,e.endOffset):e.endOffset&&(n=e.end.childNodes[e.endOffset])&&(e.end=n);for(var i=e.start;;){if(t(i),null===(i=getNextElement(i))){OneClickCbUtils.cobrowseLog(OneClickCbUtils.WARN,"pos fell out to null",e.start);break}for(;containsElement(i,e.end);)i=i.childNodes[0];if(i==e.end){t(i);break}}}else{t(splitTextBetween(e.start,e.startOffset,e.endOffset))}}function containsElement(e,t){if(e==t)return!1;if(e.nodeType!=this.document.ELEMENT_NODE)return!1;for(var n=0;n<e.childNodes.length;n++){if(e.childNodes[n]==t)return!0;if(containsElement(e.childNodes[n],t))return!0}return!1}function getNextElement(e){if(e.childNodes&&e.childNodes.length)return e.childNodes[0];for(;!e.nextSibling;)if(!(e=e.parentNode))return OneClickCbUtils.cobrowseLog(OneClickCbUtils.WARN,"no parent"),null;return e.nextSibling}function splitTextBefore(e,t){var n=this.document.createElement("span");n.artificialRangeElement=!0;var i="";if(e.nodeType!=this.document.TEXT_NODE)throw"Unexpected node: "+e;for(;e.nodeValue.length<t;){i+=e.nodeValue,t-=e.nodeValue.length;var r=e;e=e.nextSibling,r.parentNode.removeChild(r)}i+=e.nodeValue.substr(0,t);var o=e.nodeValue.substr(t,e.nodeValue.length-t);return e.nodeValue=o,n.appendChild(this.document.createTextNode(i)),e.parentNode.insertBefore(n,e),n}function splitTextAfter(e,t){for(;e.nodeValue.length<t;){if(e.nodeValue,t-=e.nodeValue.length,!e.nextSibling){OneClickCbUtils.cobrowseLog(OneClickCbUtils.WARN,"Could not get "+t+"chars from element",e);break}e=e.nextSibling}var n=e.nodeValue.substr(t,e.nodeValue.length-t);e.nodeValue=e.nodeValue.substr(0,t);var i=this.document.createElement("span");i.artificialRangeElement=!0;var r=i;i.appendChild(this.document.createTextNode(n)),e.parentNode.insertBefore(i,e.nextSibling);for(var o=i.nextSibling;o;)if(o.nodeType==this.document.TEXT_NODE)if(i){var s=o;o=o.nextSibling,i.appendChild(s)}else{(i=this.document.createElement("span")).artificialRangeElement=!0;s=o;o=o.nextSibling,s.parentNode.insertBefore(i,s),i.appendChild(s)}else i=null,o=o.nextSibling;return r}function splitTextBetween(e,t,n){if(n<t)throw"Unexpected range: "+t+" to "+n;for(var i=n-t,r="",o="",s="",a=!0,c=!1,l=[],u=0;u<e.childNodes.length;u++){var h=e.childNodes[u];if(h.nodeType==this.document.TEXT_NODE){l.push(h);var d=h.nodeValue;a&&d.length<t?(r+=d,t-=d.length):a&&(r+=d.substr(0,t),a=!1,d=d.substr(t,d.length-t)),a||c||(d.length<i?(s+=d,i-=d.length):(s+=d.substr(0,i),d=d.substr(i,d.length-i),c=!0)),c&&(o+=d)}else{if(c)break;OneClickCbUtils.cobrowseLog(OneClickCbUtils.WARN,"Unexpected element",h)}}var p=this.document.createTextNode(r),f=this.document.createTextNode(o),g=this.document.createElement("span");for(g.artificialRangeElement=!0,g.appendChild(this.document.createTextNode(s)),u=0;u<l.length;u++)e.removeChild(l[u]);return e.insertBefore(f,e.childNodes[0]),e.insertBefore(g,f),e.insertBefore(p,g),g}"undefined"!=typeof exports&&(exports.EchoProxy=EchoProxy,exports.PostMessageChannel=PostMessageChannel,exports.ChromePostMessageChannel=ChromePostMessageChannel,exports.PostMessageIncomingChannel=PostMessageIncomingChannel,exports.PortChannel=PortChannel,exports.PortProxyChannel=PortProxyChannel);var TEMPORARY_HIGHLIGHT_DELAY=1e4;function temporaryHighlight(e,t,n,i){var r=e.ownerDocument;t=t||0,n=n||0;var o=getElementPosition(e),s=this.document.createElement("div");function a(){null!==s&&(r.body.removeChild(s),s=null)}return s.style.backgroundColor="transparent",s.style.border="2px solid #f00",s.style.position="absolute",s.style.width="100px",s.style.height="100px",s.style.borderRadius="50px",s.style.top=o.top+t-50+"px",s.style.left=o.left+n-50+"px",s.jsmirrorHide=!0,r.body.appendChild(s),setTimeout(a,TEMPORARY_HIGHLIGHT_DELAY),a}function binder(t,n,i){i=t.name;return function(){try{var e=t.apply(n||this,arguments)}catch(e){throw console.warn(i+"() raised:",e+""),e}return void 0!==e&&console.log(i+"() returned:",JSON.stringify(e)),e}}var chatjQuery=chatjQuery||livechat.jQuery||jQuery,ELEMENT_NODE;if(!window.Freeze)var Freeze={};Freeze._inputTags={INPUT:!0,TEXTAREA:!0,SELECT:!0,OPTION:!0},Freeze.eventListenerWrapper=function(e,t,n,i){e.addEventListener?e.addEventListener(t,n,i):e.attachEvent("on"+t,n)},Freeze.removeEventListener=function(e,t,n,i){e.removeEventListener?e.removeEventListener(t,n,i):e.removeEvent("on"+t,n)},Freeze.isMaster=function(){return!(!Freeze.elementTracker||!Freeze.elementTracker.cbMaster)},Freeze.scrolledElements=[],setInterval(function(){if(Freeze.isMaster()&&Freeze.scrolledElements.length){var e=!(msg={type:"elScroll",body:{elScroll:{}}});for(i=0;i<Freeze.scrolledElements.length;i++)el=Freeze.scrolledElements[i],9==el.nodeType?Freeze.elementTracker.scrollEventListener():(msg.body.elScroll[el.jsmirrorId]={top:el.scrollTop,left:el.scrollLeft},e=!0);e&&Freeze.elementTracker.send(msg),Freeze.scrolledElements=[]}},100),Freeze._scrollEvents=function(e){var t=e.target||e.scrElement;-1==Freeze.scrolledElements.indexOf(t)&&Freeze.scrolledElements.push(t)},Freeze._changeEvent=function(e){Freeze.isMaster()&&Freeze.elementTracker.send({type:"change",body:{target:e.target.jsmirrorId,value:e.target.value}})},Freeze.attachChangeEvent=function(e){try{if(Freeze._inputTags[e.tagName]){var t;if("INPUT"==e.tagName){if(e.type&&"password"==e.type.toLowerCase())return;var n=chatjQuery(e).attr("value");void 0!==n&&0!=n||(current_value=chatjQuery(e).val(),chatjQuery(e).attr("value",current_value))}t=Freeze.canSendValue(e)?"keyup":"change",Freeze.eventListenerWrapper(e,t,Freeze._changeEvent,!1)}else e.isContentEditable&&Freeze.eventListenerWrapper(e,"change",Freeze._changeEvent,!1)}catch(e){console.log("changeEvent error"+e)}},Freeze.modifierPressed=!1,Freeze.attachKeyBoardEvents=function(e){downResponder=function(e){var t=e.target||e.srcElement,n=e.keyCode||e.which;return"Meta"==e.keyIdentifier||"Meta"==e.key||17==n?(this.modifierPressed=!0,allow=!0):this.modifierPressed?(this.modifierPressed=!1,allow=!0):allow="lc_chat_input_container"==t.id||OneClickCbUtils.allowKeyBoardEvents()||"msg-box"==t.id,allow},eventResponder=function(e){var t=e.target||e.srcElement;return"lc_chat_input_container"==t.id||OneClickCbUtils.allowKeyBoardEvents()||"msg-box"==t.id},e.onkeypress=e.onkeyup=eventResponder,e.onkeydown=downResponder,Freeze.eventListenerWrapper(e,"keydown",downResponder,!0),Freeze.eventListenerWrapper(e,"keyup",eventResponder,!0),Freeze.eventListenerWrapper(e,"keypress",eventResponder,!0)},Freeze.makeId=function e(t){return this.attachChangeEvent(t),this.attachKeyBoardEvents(t),this.eventListenerWrapper(t,"scroll",this._scrollEvents,!1),"el"+e.counter++},Freeze.makeId.counter=1e3,Freeze.skipElementsOKEmpty={LINK:!0,STYLE:!0,HEAD:!0,META:!0,BODY:!0,APPLET:!0,BASE:!0,BASEFONT:!0,BDO:!0,BR:!0,OBJECT:!0,TD:!0,TR:!0,TH:!0,THEAD:!0,TITLE:!0,I:!0,B:!0,SPAN:!0,A:!0,INPUT:!0},Freeze.voidElements={AREA:!0,BASE:!0,BR:!0,COL:!0,COMMAND:!0,EMBED:!0,HR:!0,IMG:!0,INPUT:!0,KEYGEN:!0,LINK:!0,META:!0,PARAM:!0,SOURCE:!0,TRACK:!0,WBR:!0},Freeze.skipElementsBadTags={SCRIPT:!0,NOSCRIPT:!0,IFRAME:!0},Freeze.skipElement=function(e){if(e.isSVG&&1==e.isSVG)return!1;var t=e.tagName;if(Freeze.skipElementsBadTags[t]||e.jsmirrorHide||"webSocketContainer"==e.id)return!0;if(e.id){var n=["cb-block-canvas","oneclick-canvas-wrapper","oneclick-canvas-wrapper","oneclick-background-canvas","oneclick-annotation-button","oneclick-annotation-canvas","oneclick-annotation-toolbar","oneclick-master-cursor","oneclick-client-cursor","oneclick-cobrowse-button","oneclick-cobrowse-url","oneclick-cobrowse-tc","oneclick-cobrowse-gc","lc_chat_layout","lc_cb_actions","livechat_layout","scroll-to-top"];try{for(var i=0;i<n.length;i++)if(-1!=e.id.search(n[i]))return!0}catch(e){console.log("error: search for ",n[i],"undefined")}}return!((!e.style||"none"!=e.style.display||chatjQuery(e).is(":visible"))&&(0!==e.clientWidth||0!==e.clientHeight||Freeze.skipElementsOKEmpty[t]||e.childNodes.length))},Freeze.serializeDocument=function(){for(var e=document,t=e.childNodes[0],n=0;n<e.childNodes.length;n++)if(e.childNodes[n].tagName&&("HTML"==e.childNodes[n].tagName||"html"==e.childNodes[n].tagName)){t=e.childNodes[n];break}return{href:location.href,htmlAttrs:Freeze.serializeAttributes(t),head:Freeze.serializeElement(e.head),body:Freeze.serializeElement(e.body),hash:location.hash||""}},Freeze.cssTextList=[],Freeze.getInlineCSS=function(){for(var e=0;e<document.styleSheets.length;e++){var t=document.styleSheets[e];t.href||this.addCSSRules(t)}return this.cssTextList},Freeze.addCSSRules=function(e){for(var t=0;t<e.cssRules.length;t++){var n=e.cssRules[t];n.type==n.MEDIA_RULE?this.addCSSRules(n):n.type==n.STYLE_RULE&&-1!=n.cssText.search("grid-stack")&&this.cssTextList.push(n.cssText)}},Freeze.elementTracker={},Freeze.trackElement=function(e){var t=this.makeId(e);e.jsmirrorId=t,this.elementTracker.elements[t]=e},Freeze.serializeElement=function(t,e){if("svg"==t.tagName&&(t.isSVG=!0),t.jsmirrorId||Freeze.trackElement(t),"CANVAS"==t.tagName)return["IMG",t.jsmirrorId,{src:t.toDataURL("image/png")},[]];var n,i=this.serializeAttributes(t);if("IFRAME"==t.tagName){var r;n=[];try{r=this.staticHTML(t.contentWindow.document.documentElement)}catch(e){return console.warn("Had to skip iframe for permission reasons:",e+"","src:",t.src),["SPAN",t.jsmirrorId,{},[]]}i.src=this.encodeData("text/html",r)}else for(var o=(n=this.normalChildren(t)).length,s=0;s<o;s++){"string"!=typeof n[s]&&(n[s]=this.serializeElement(n[s]))}var a=[t.tagName.replace(/[^a-zA-Z0-9]/g,""),t.jsmirrorId,i,n,t.parentNode.jsmirrorId];return e&&a.push(t.innerHTML),a},Freeze.normalChildren=function(e){for(var t=[],n=e.childNodes,i=n.length,r=0;r<i;r++){var o=n[r];if(o.isSVG=e.isSVG,!this.skipElement(o))if(o.nodeType==this.TEXT_NODE){var s=o.nodeValue;if(!s)continue;r&&"string"==typeof t[t.length-1]?t[t.length-1]+=s:t.push(s)}else o.nodeType==this.ELEMENT_NODE&&t.push(o)}return t},Freeze.filterInnerHTML=function(e){for(var t=[e[0],e[1],e[2],[]],n=0;n<e[3].length;n++)"string"==typeof e[3][n]?t[3].push(e[3][n]):t[3].push(this.filterInnerHTML(e[3][n]));return t},Freeze.canSendValue=function(e){return!("TEXTAREA"!=e.tagName&&("INPUT"!=e.tagName||!e.type||"text"!=e.type.toLowerCase()&&"email"!=e.type.toLowerCase()))},Freeze.isCheckedElement=function(e){return!(!e||"INPUT"!=e.tagName||!e.type||"checkbox"!=e.type.toLowerCase()&&"radio"!=e.type.toLowerCase())},Freeze.serializeAttributes=function(e){var t={};if(e.attributes)for(var n=e.attributes.length,i=0;i<n;i++){var r=e.attributes[i].name;if("on"!=r.substr(0,2).toLowerCase())if("href"==r||"src"==r||"value"==r)t[r]=e[r];else if("HTML"==e.tagName&&"class"==r){var o=e.attributes[i].nodeValue;o=o.replace("lc-cb-container-vi",""),t[r]=o}else t[r]=e.attributes[i].nodeValue}return Freeze.canSendValue(e)&&(t.value=e.value),this.isCheckedElement(e)?t.checked=e.checked:"SELECT"==e.tagName&&(t.value=e.value),t},Freeze.compareAttributes=function(e,t){var n=0;t.tagName;for(var i in e)if(e.hasOwnProperty(i)){var r;if(n++,"href"==i||"src"==i||"value"==i||"checked"==i&&this.isCheckedElement(t)){if(r=t[i],t.hasAttribute(i)||n--,t.critValue&&t.critValue!==r)return!1}else r=t.getAttribute(i);if(r!=e[i])return-1!=e[i].indexOf(r)&&"stylesheet"==e.rel}var o=t.attributes.length;if(o==n)return!0;for(i=0;i<o;i++){"on"==t.attributes[i].name.substr(0,2).toLowerCase()&&n++}return n==o},Freeze.compareAttributes2=function(e,t){var n,i=this.serializeAttributes(t),r=!0;for(n in e)e[n]!=i[n]&&(r=!1);for(n in i)e[n]!=i[n]&&(r=!1);var o=this.compareAttributes(e,t);return r!=o&&console.log("Disagreement",t.tagName,r,o),r},Freeze.htmlQuote=function(e){return e?-1==e.search(/[&<"]/)?e:e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/"/g,"&quot;"):e},Freeze.encodeData=function(e,t){return"data:"+e+";base64,"+btoa(encodeURIComponent(t))},Freeze.staticHTML=function(e){if("CANVAS"==e.tagName)return'<IMG SRC="'+this.htmlQuote(e.toDataURL("image/png"))+'">';var t=null;if("IFRAME"==e.tagName)try{var n=this.staticHTML(e.contentWindow.document.documentElement);t=this.encodeData("text/html",n)}catch(e){console.warn("Had to skip iframe for permission reasons:",e+"")}var i,r="<"+e.tagName,o=e.attributes;if(o&&(i=o.length))for(var s=0;s<i;s++){var a,c=o[s].name;if("on"!=c.substr(0,2).toLowerCase())a="src"==c&&t?t:"href"==c||"src"==c||"value"==c?e[c]:o[s].nodeValue,r+=" "+c+'="'+this.htmlQuote(a)+'"'}return r+=">",this.voidElements[e.tagName]||(r+=this.staticChildren(e),r+="</"+e.tagName+">"),r},Freeze.getAttributes=function(e){var t=[],n=e.attributes;if(n&&n.length)for(var i=n.length,r=0;r<i;r++){var o,s=n[r].name;if("on"!=s.substr(0,2).toLowerCase())o="href"==s||"src"==s||"value"==s?e[s]:n[r].nodeValue,t.push([s,o])}return t},Freeze.TEXT_NODE=document.TEXT_NODE,Freeze.ELEMENT_NODE=document.ELEMENT_NODE,Freeze.staticChildren=function(e){for(var t="",n=e.childNodes,i=n.length,r=0;r<i;r++){var o=n[r];if(o.isSVG=e.isSVG,!this.skipElement(o))if(o.nodeType==this.TEXT_NODE){var s=o.nodeValue;t+=this.htmlQuote(s)}else o.nodeType==this.ELEMENT_NODE&&(t+=this.staticHTML(o))}return t},Freeze.applyDiff=function(e){for(var t,n,i,r=0;r<e.length;r++){var o=e[r],s=o[0],a=Freeze.getElement(o[1]);if(a){if("attrs"===s&&Freeze.setAttributes(a,o[2]),"deletetext-"===s||"delete-"===s||"delete-+"==s)for(;a.previousSibling&&a.previousSibling.nodeType==document.TEXT_NODE;)a.parentNode.removeChild(a.previousSibling);if("delete+"===s)for(;a.nextSibling&&a.nextSibling.nodeType==document.TEXT_NODE;)a.parentNode.removeChild(a.nextSibling);if("delete"!==s&&"delete-"!==s&&"delete+"!==s&&"delete-+"!==s||a.parentNode.removeChild(a),"delete_last_text"===s){if(!a.childNodes.length){console.warn("Tried to delete_last_text of element with no children",o);continue}var c=a.childNodes[a.childNodes.length-1];if(c.nodeType!=document.TEXT_NODE){console.warn("Got command that deletes something that isn't text",o,c);continue}a.removeChild(c)}if("replace_text"===s)if(1!==a.childNodes.length||a.childNodes[0].nodeType!==document.TEXT_NODE){for(;a.childNodes;)a.removeChild(a.childNodes[0]);a.appendChild(document.createTextNode(o[2]))}else a.childNodes[0].nodeValue=o[2];if("insert_before"===s)for(n=(t=o[2]).length-1;0<=n;n--)i="string"==typeof t[n]?document.createTextNode(t[n]):Freeze.deserializeElement(t[n]),a.parentNode.insertBefore(i,a);if("append_to"===s)for(t=o[2],n=0;n<t.length;n++)i="string"==typeof t[n]?document.createTextNode(t[n]):Freeze.deserializeElement(t[n]),a.appendChild(i)}else console.warn("Got diff command for element that does not exist",o)}},Freeze.unfreeze=function(e,t){var n=t[0],i=t[1],r=t[2],o=t[3];if(e.tagName==n){Freeze.setAttributes(e,r),e.jsmirrorId=i;for(var s=0,a=0;a<o.length;a++){var c=a+s,l=e.childNodes[c];if(l){if(l.jsmirrorHide||"webSocketContainer"==l.id){s++,a--;continue}"string"==typeof o[a]?l.nodeType!=document.TEXT_NODE?l.parentNode.replaceChild(document.createTextNode(o[a]),l):l.nodeValue=o[a]:Freeze.unfreeze(l,o[a])}else e.appendChild(Freeze.deserializeElement(o[a]))}for(;e.childNodes.length-s>o.length;){var u=e.childNodes[o.length+s];u.jsmirrorHide||"webSocketContainer"==u.id?s++:e.removeChild(u)}}else e.parentNode.replaceChild(Freeze.deserializeElement(t),e)},Freeze.deserializeElement=function(e){if("string"==typeof e)return document.createTextNode(e);var t,n,i,r=e[0],o=e[1],s=e[2],a=e[3];if("\x3c!--COMMENT--\x3e"==r)return n=a&&a.length?a[0]:"",(t=document.createComment(n)).jsmirrorId=o,t;t=document.createElement(r);try{for(i in s)s.hasOwnProperty(i)&&t.setAttribute(i,s[i])}catch(e){console.warn("bad attrs",s,JSON.stringify(s))}if(void 0===a)throw console.warn("Bad children",e),"Bad children list";for(i=0;i<a.length;i++){var c=a[i];"string"==typeof c?t.appendChild(document.createTextNode(c)):t.appendChild(Freeze.deserializeElement(c))}return t.jsmirrorId=o,t},Freeze.setAttributes=function(e,t){var n=0;for(var i in t)t.hasOwnProperty(i)&&(n++,"checked"==i&&this.isCheckedElement(e)?e.checked=t[i]:(e.setAttribute(i,t[i]),"value"==i&&(e.value=t[i])));if(e.attributes||(console.trace(),console.log("el.attributes?",e,e.tagName)),e.attributes.length>n){var r=[];for(i=0;i<e.attributes.length;i++)t.hasOwnProperty(e.attributes[i].name)||r.push(e.attributes[i].name);for(i=0;i<r.length;i++)console.debug("removing attr",r[i]),e.removeAttribute(r[i])}},Freeze.setBase=function(e){for(var t=document.getElementsByTagName("base"),n=0;n<t.length;n++)t[n].parentNode.removeChild(t[n]);var i=document.createElement("base");i.href=e,document.head.appendChild(i)},Freeze._elements={},Freeze.getElement=function(e){return Freeze._elements[e]},Freeze.refreshElements=function(){function r(e,t){e[t.jsmirrorId]=t;for(var n=0;n<t.childNodes.length;n++){var i=t.childNodes[n];i.nodeType===document.ELEMENT_NODE&&r(e,i)}}Freeze._elements={},r(Freeze._elements,document.head),r(Freeze._elements,document.body)},OneClickCbUtils={master:null,appCallBack:null,tabId:null,log:{VERBOSE:10,DEBUG:20,INFO:30,NOTIFY:40,WARN:50,ERROR:50,CRITICAL:60},cleanUpSession:function(){this.master&&this.master.cleanUp(),this.master=null},safeSessionGetItem:function(e){return window.sessionStorage?window.sessionStorage.getItem(e):""},safeSessionSetItem:function(e,t){window.sessionStorage&&window.sessionStorage.setItem(e,t)},generateId:function(){for(var e="",t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=0;n<5;n++)e+=t.charAt(Math.floor(Math.random()*t.length));return e},generateRoom:function(){return text=this.generateId(),this.safeSessionSetItem("room",text),text},getRoom:function(){return this.safeSessionGetItem("room")||this.generateRoom()},setMaster:function(e){return this.safeSessionSetItem("cbMaster",e),this.safeSessionGetItem("cbMaster")},getMaster:function(e){return"true"===(this.safeSessionGetItem("cbMaster")||this.setMaster(e))},setSessionParameters:function(e,t,n,i,r,o){e||t||n||i||r||o||OneClickFakeAccounts&&(fakeVisitor=OneClickFakeAccounts.getFakeVisitor(),e=fakeVisitor.name,t=fakeVisitor.role,n=fakeVisitor.viewerId,i=fakeVisitor.sdata,r=fakeVisitor.siteId,o=fakeVisitor.chatId),this.safeSessionSetItem("cbName",e),this.safeSessionSetItem("cbRole",t),this.safeSessionSetItem("cbViewerId",n),this.safeSessionSetItem("cbSdata",i),this.safeSessionSetItem("cbSiteId",r),this.safeSessionSetItem("cbChatId",o)},getSessionParameters:function(){return{name:this.safeSessionGetItem("cbName"),role:this.safeSessionGetItem("cbRole"),viewerId:this.safeSessionGetItem("cbViewerId"),sdata:this.safeSessionGetItem("cbSdata"),siteId:this.safeSessionGetItem("cbSiteId"),chatId:this.safeSessionGetItem("cbChatId")}},isCobrowseActive:function(){return"true"===this.safeSessionGetItem("1click-cobrowsing")},cobrowsingStart:function(e,t,n,i,r,o){this.isCobrowseActive()||(this.setSessionParameters(e,t,n,i,r,o),this.master=new Master(document))},cobrowsingEnd:function(){this.master&&this.master.CbStop(),this.master=null},cobrowseAutoRestart:function(){this.master||(this.master=new Master(document))},allowKeyBoardEvents:function(){return!this.master||this.master.cbMaster},getCobrowseLink:function(){return this.master&&this.isCobrowseActive()?displayText=window.location.protocol+"//"+this.safeSessionGetItem("cobrowsingApp")+"/cb_view/"+this.master.room:displayText="cobrowsing is off.",displayText},takeControl:function(){return this.master&&this.master.takeControl()},giveControl:function(){return this.master&&this.master.giveControl()},setCallback:function(e){this.appCallBack=e},callBack:function(e,t){this.appCallBack?this.appCallBack(e,t):alert(t)},setCobrowsingServer:function(e,t){this.safeSessionSetItem("cobrowsingChannel",e),this.safeSessionSetItem("cobrowsingApp",t)},cobrowseLog:function(e){var t=this.log.DEBUG;if(e>this.log.WARN&&console.trace&&console.trace(),"undefined"!=typeof console&&!(e<t)){for(var n=[],i=1;i<arguments.length;i++)n.push(arguments[i]);var r="log";if(e>=this.log.ERROR&&console.error?r="error":e>=this.log.INFO&&console.info?r="info":console.debug&&(r="debug"),console[r]||(r="log"),console[r].apply)try{console[r].apply(console,n)}catch(e){console[r].apply(console,["Could not log: "+e])}else console.log(n)}}};var chatjQuery=chatjQuery||livechat.jQuery||jQuery;function adaptCanvas(){try{dw=chatjQuery(window).width(),dh=chatjQuery(window).height(),chatjQuery("#oneclick-canvas-wrapper").width(dw).height(dh),resizeCanvas("#oneclick-annotation-canvas",dw,dh),resizeCanvas("#oneclick-background-canvas",dw,dh)}catch(e){console.log(e)}}function windowWidthHeightListener(){var e=OneClickCbUtils.master;width=chatjQuery(window).width(),height=chatjQuery(window).height(),!e||e.windowTimeout||e.windowWidth==width&&e.windowHeight==height||(adaptCanvas(),e.send({type:"window",body:{window:{w:width,h:height}}}),e.windowWidth=width,e.windowHeight=height,e.windowTimeout=setTimeout(function(){e.windowTimeout=null},1e3))}function resizeCanvas(e,t,n){var i=chatjQuery(e);if(i.length){var r=i[0],o=r.width,s=r.height,a=r.getContext("2d"),c=a.getImageData(0,0,o,s);i.prop({width:t-4,height:n-4}),a.putImageData(c,0,0),a.scale(t/o,n/s)}}function createCanvas(e,t,n){if(window.LIVECHAT_SUPPORT&&(t=1051),!document.getElementById(e))return canvas=document.createElement("canvas"),canvas.id=e,canvas.width=chatjQuery(document).width(),canvas.height=chatjQuery(document).height(),canvas.style.display=n,canvas.style.zIndex=t,canvas.style.position="absolute",canvas.style.top="0px",canvas.style.left="0px",document.body.appendChild(canvas),canvas}function Master(t){this.room=OneClickCbUtils.getRoom(),this.srcId=OneClickCbUtils.generateId(),this.cbMaster=OneClickCbUtils.getMaster(!0),this.helloComplete=!1,session=OneClickCbUtils.getSessionParameters(),this.name=session.name,this.role=session.role,this.viewerId=session.viewerId,this.sdata=session.sdata,this.siteId=session.siteId,this.chatId=session.chatId,this.channel=new SocketIoChannel(this.room,this.role,this.viewerId,this.sdata,this.siteId,this.chatId),this.channel.onmessage=this.processCommand,this.document=t,ELEMENT_NODE=this.document.ELEMENT_NODE,this.elements={},this.mouse={x:0,y:0},this.mouseTimeout=null;var n=this;this.mouseEventListenerCallback=function(e){n.mouseEventListener(e)},Freeze.eventListenerWrapper(t,"mousemove",this.mouseEventListenerCallback,!1),this.scrollTop=this.scrollTopGS(),this.scrollLeft=this.scrollLeftGS(),this.scrollEventListenerCallback=function(e){-1==Freeze.scrolledElements.indexOf(t)&&Freeze.scrolledElements.push(t)},Freeze.eventListenerWrapper(t,"scroll",this.scrollEventListenerCallback,!1),(Freeze.elementTracker=this).sendDocInterval=setInterval(binder(this.sendDoc,this),1e3),this.send({type:"masterHello"}),this.sendMasterHelloTimeout=setInterval(binder(this.sendMasterHello,this),1e3),this.send({type:"href",body:{href:location.href}}),this.send({type:"cursor",body:{cursor:{position:this.mouse,name:this.name}}}),this.scrollEventListener(),windowWidthHeightListener(),this.cbMaster?cbBlock="none":cbBlock="block","complete"==t.readyState?(createCanvas("cb-block-canvas","99990",cbBlock),chatjQuery(window).resize(windowWidthHeightListener)):(Freeze.eventListenerWrapper(window,"load",function(){OneClickCbUtils.isCobrowseActive()&&createCanvas("cb-block-canvas","99990",cbBlock)},!1),chatjQuery(t).ready(function(){windowWidthHeightListener(),chatjQuery(window).resize(windowWidthHeightListener)})),this.displayClickWrapper=function(e){OneClickCbUtils.master&&OneClickCbUtils.master.displayClick(e)},Freeze.eventListenerWrapper(t,"click",this.displayClickWrapper,!1),OneClickCbUtils.safeSessionSetItem("1click-cobrowsing","true"),this.currentFaultCount=0,this.maxFaultCount=3,this.faultRecoverTimeOut=null,this.noReflectionElements=[],this.syncHRefCount=0,this.maxSyncHRef=5}Master.prototype={toString:function(){return"[Master channel: "+this.channel+"]"},send:function(e){e.master=this.cbMaster,e.srcId=this.srcId,this.channel.send(e)},sendDoc:function(){windowWidthHeightListener(),this.checkDocumentWidthHeight(),this.clearNoReflectionElements();var e=Freeze.serializeDocument(),t={},n=JSON.stringify(e);if(!this.lastSentDoc||this.lastSentDoc!=n)if(this.lastSentDoc){var i=[],r=this.diffDocuments(this.lastSentDocData.head,this.document.head,i);if(null===r?i=null:null===(r=this.diffDocuments(this.lastSentDocData.body,this.document.body,i,!1))&&(i=null),null===i||!i.length&&1!=i.noReflection)OneClickCbUtils.cobrowseLog(OneClickCbUtils.log.DEBUG,"Sending complete document",null===i?"fault":"diff failure"),t.type="doc",t.body={doc:e},t.css={sheet:Freeze.getInlineCSS()},this.lastSentDoc=n,this.lastSentDocData=e;else if(i&&i.length){OneClickCbUtils.cobrowseLog(OneClickCbUtils.log.DEBUG,"Diffs:");for(var o=0;o<i.length;o++)OneClickCbUtils.cobrowseLog(OneClickCbUtils.log.DEBUG,"...diff",this.diffRepr([i[o]]));t.type="diffs",t.body={diffs:i},t.css={sheet:Freeze.getInlineCSS()},this.lastSentDoc=n,this.lastSentDocData=e}else OneClickCbUtils.cobrowseLog(OneClickCbUtils.log.DEBUG,"No updates to send/should not happen")}else t.type="doc",t.body={doc:e},t.css={sheet:Freeze.getInlineCSS()},this.lastSentDoc=n,this.lastSentDocData=e;t.body&&(this.send(t),Freeze.cssTextList=[]),this.syncHRefCount+=1,this.syncHRefCount>=this.maxSyncHRef&&(this.syncHRefCount=0,t.type="HrefNow",t.body={HrefNow:location.href},this.send(t))},diffDocuments:function(e,t,n){if("svg"==t.tagName&&(t.isSVG=!0),!t)throw"Got bad current argument: "+t;void 0===n&&(n=[]),t.jsmirrorId||(OneClickCbUtils.cobrowseLog(OneClickCbUtils.log.WARN,"Got diffDocuments element without an id",t),t.jsmirrorId=Freeze.makeId(t),this.elements[t.jsmirrorId]=t);var i=e[0],r=e[1],o=e[2],s=e[3],a=e[4];if(i!=t.tagName)return OneClickCbUtils.cobrowseLog(OneClickCbUtils.log.WARN,"got tag name change",i,t.tagName),null;if(Freeze.compareAttributes(o,t)||(currentAttributes=Freeze.serializeAttributes(t),t.noReflection&&(t.critValue?t.critValue===t.value?delete currentAttributes.value:delete t.critValue:delete currentAttributes.value),n.push(["attrs",t.jsmirrorId,currentAttributes])),r!=t.jsmirrorId)return OneClickCbUtils.cobrowseLog(OneClickCbUtils.log.WARN,"Tag ids don't match",r,t.jsmirrorId,t),null;if(!this.cbMaster&&t.noReflection)return n.noReflection=!0,n;if(void 0!==a&&t.innerHTML==a)return n;var c=Freeze.normalChildren(t),l=c.length,u=s.length;if(1===l&&1===u&&"string"==typeof c[0]&&"string"==typeof s[0])return s[0]!==c[0]&&n.push(["replace_text",t.jsmirrorId,c[0]]),n;for(var h=0,d=0;h<u||d<l;)if("string"!=typeof s[h]||s[h]!==c[d]){var p=this.findNextMatch(s,c,h,d);null===p&&(p=[u,l]);var f=p[0],g=p[1];if(h<f)if(h+1==f&&"string"==typeof s[h])u<=f?n.push(["delete_last_text",t.jsmirrorId]):n.push(["deletetext-",s[h+1][1]]);else for(var m="string"==typeof s[h],v=h;v<f;v++)if("string"!=typeof s[v]){var y="delete";v==h+1&&m&&(y+="-"),v+1<s&&"string"==typeof s[v+1]&&(y+="+"),n.push([y,s[v][1],s[v][4]])}if(d<g){var b=[];for(v=d;v<g;v++)"string"==typeof c[v]?b.push(c[v]):(c[v].jsmirrorId||(c[v].jsmirrorId=Freeze.makeId(c[v]),this.elements[c[v].jsmirrorId]=c[v]),b.push(Freeze.serializeElement(c[v])));c[g]?n.push(["insert_before",c[g],b]):n.push(["append_to",t.jsmirrorId,b])}s[f]&&this.diffDocuments(s[f],c[g],n),d=g+1,h=f+1}else h++,d++;return n},findNextMatch:function(e,t,n,i){if(n>=e.length||i>=t.length)return null;for(;"string"==typeof t[i]||!t[i].jsmirrorId;)if(++i>=t.length)return null;var r=n,o=t[i].jsmirrorId;if(!o)for(;r<e.length;){if("string"!=typeof e[r]&&o==e[r][1])return[r,i];r++}for(;"string"==typeof e[n];)if(++n>=e.length)return null;for(o=e[n][1],r=i;r<t.length;){if("string"!=typeof t[r]&&o==t[r].jsmirrorId)return[n,r];r++}return this.findNextMatch(e,t,n+1,i+1)},processCommand:function(e){var t=OneClickCbUtils.master;if(t&&e.srcId!=t.srcId){"bytearray"==e.datatype?payload=JSON.parse(decodeURIComponent(e.body)):payload=e.body;var n=e.type;"event"==n?t.processEvent(payload.event):"getDoc"==n||"reloadDoc"==n?t.processGetDoc():"getResolution"==n?t.processGetResolution():"change"==n?t.processChange(payload):"contentEditable"==n?t.processContentEditable(payload):"highlight"==n?t.processHighlight(payload.highlight):"cursor"==n?t.processCursor(e.clientId,payload):"scroll"==n?t.processScroll(payload):"elScroll"==n?t.processElScroll(payload.elScroll):"takeControl"==n?t.processTakeControl(e):"giveControl"==n?t.helloComplete?t.becomeMaster(e):OneClickCbUtils.cobrowseLog(OneClickCbUtils.log.INFO,"hello is not complete, so not doing giveControl"):"controlTransferComplete"==n?t.processControlTransferComplete(e):"annotation"==n?t.processAnnotation(payload):"bye"==n?t.processBye(e):"cbStop"==n?t.processCbStop():"helloComplete"==n?t.helloComplete=!0:console.log("missed msgs",e)}},triggerMostButtons:function(e,t){!e||"INPUT"!=e.tagName&&"TEXTAREA"!=e.tagName||this.triggerMouseEvent(e,"focus"),this.triggerMouseEvent(e,"mouseover"),this.triggerMouseEvent(e,"mousedown"),this.triggerMouseEvent(e,"mouseup"),this.dispatchEvent(t,e),Freeze.isCheckedElement(e)&&this.triggerMouseEvent(e,"blur")},triggerMouseEvent:function(e,t){var n=document.createEvent("MouseEvents");n.initEvent(t,!0,!0),this.dispatchEvent(n,e)},processEvent:function(e){var t=this.deserializeEvent(e);if("MouseEvent"==t.module&&"click"==t.type){var n=e.target||e.srcElement;this.triggerMostButtons(n,t),n.getAttribute("href")&&n.getAttribute("href").startsWith("#")&&setTimeout(this.scrollEventListener(),200)}else{if("keypress"==t.type){e.type="keydown";var i=this.deserializeEvent(e);this.dispatchEvent(i,e.target)}if(this.dispatchEvent(t,e.target),"keypress"==t.type){e.type="keyup";var r=this.deserializeEvent(e);this.dispatchEvent(r,e.target)}}},serializeEvent:function(e){var t={};for(var n in e){var i=e[n];if((n.toUpperCase()!=n||"number"!=typeof i)&&"function"!=typeof i&&i!==window){if(i&&"object"==typeof i)try{var r=i.jsmirrorId;if(!r)continue;i={jsmirrorId:r}}catch(e){OneClickCbUtils.cobrowseLog(OneClickCbUtils.log.WARN,"could not get jsmirrorId",i,n,e);continue}t[n]=i}}t.cancelable=e.cancelable,t.canBubble=e.canBubble;var o=e+"";return o=o.substr(o.indexOf(" ")+1,o.length-o.indexOf(" ")-2),t.module=o,t},deserializeEvent:function(e){var t;"PointerEvent"==e.module&&(e.module="MouseEvent");var n=this.document.createEvent(e.module);for(var i in e)if(e.hasOwnProperty(i)){if((t=e[i])&&"object"==typeof t&&t.jsmirrorId){var r=this.getElement(t.jsmirrorId)||null;r||OneClickCbUtils.cobrowseLog(OneClickCbUtils.log.WARN,"Could not find element",t.jsmirrorId),t=r}e[i]=t}for(i in this.initEvent(n,e,e.module),e)e.hasOwnProperty(i)&&(n[i]=e[i]);return n},initEvent:function(e,t,n){if(n in this.eventAliases&&(n=this.eventAliases[n]),"UIEvents"===n)e.initUIEvent(t.type,t.canBubble||!0,t.cancelable||!0,t.view||window,t.detail);else if("MouseEvents"==n)OneClickCbUtils.cobrowseLog(OneClickCbUtils.log.INFO,{type:t.type,canBubble:t.canBubble||!0,cancelable:t.cancelable||!0,view:this.document.defaultView,detail:void 0===t.detail?1:this.detail,screenX:t.screenX,screenY:t.screenY,clientX:t.clientX,clientY:t.clientY,ctrlKey:t.ctrlKey,altKey:t.altKey,shiftKey:t.shiftKey,metaKey:t.metaKey,button:t.button,relatedTraget:t.relatedTarget||null}),e.initMouseEvent(t.type,t.canBubble||!0,t.cancelable||!0,this.document.defaultView,1,t.screenX,t.screenY,t.clientX,t.clientY,t.ctrlKey,t.altKey,t.shiftKey,t.metaKey,t.button,t.relatedTarget||null);else if("HTMLEvents"==n)e.initEvent(t.type,t.canBubble||!0,t.cancelable||!0);else if("KeyboardEvent"==n){e[e.initKeyboardEvent?"initKeyboardEvent":"initKeyEvent"](t.type,t.canBubble||!0,t.cancelable||!0,t.view||window,t.ctrlKey,t.altKey,t.shiftKey,t.metaKey,t.keyCode,t.charCode)}},eventAliases:{UIEvent:"UIEvents",KeyEvents:"KeyboardEvent",Event:"HTMLEvents",Events:"HTMLEvents",MouseScrollEvents:"MouseEvents",MouseEvent:"MouseEvents",HTMLEvent:"HTMLEvents",PopupEvents:"MouseEvents"},dispatchEvent:function(e,t){if(OneClickCbUtils.cobrowseLog(OneClickCbUtils.log.INFO,"Dispatching internal event",e.type,e,t),Freeze.isCheckedElement(t)&&(e.doNotTrack=!0),t&&!t.dispatchEvent&&(OneClickCbUtils.cobrowseLog(OneClickCbUtils.log.WARN,"huh",e,t,t===window),t=window),t){var n=t.dispatchEvent(e);OneClickCbUtils.cobrowseLog(OneClickCbUtils.log.DEBUG,"should do default",n,e.type,t.tagName,t.href),n&&t["on"+e.type]&&t["on"+e.type](e),n&&"click"==e.type&&this.doDefaultAction(e,t)}else this.document.dispatchEvent(e)},doDefaultAction:function(e,t){if("A"!==t.tagName)(t=t.parentNode)&&this.doDefaultAction(e,t);else if(t.href){var n=t.href,i="";-1!=n.indexOf("#")&&(i=n.substr(n.indexOf("#"),n.length),n=n.substr(0,n.indexOf("#")));var r=location.href;if(-1!=r.indexOf("#")&&(r=r.substr(0,r.indexOf("#"))),n===r||-1!=t.target.indexOf("_blank"))return location.hash=i,void this.send({type:"baseHash",body:{baseHash:i,href:location.href}});location.href=t.href}},setNoReflection:function(e){-1===this.noReflectionElements.indexOf(e)&&(e.noReflection=!0,this.noReflectionElements.push(e))},processChange:function(e){var t=this.getElement(e.target);this.setNoReflection(t),t.value=e.value,t.critValue=e.value;var n=this.document.createEvent("UIEvent");n.initUIEvent("change",!0,!0,window,{});var i=t.dispatchEvent(n);i&&t.onchange&&t.onchange(n),(n=this.document.createEvent("KeyboardEvent"))[n.initKeyboardEvent?"initKeyboardEvent":"initKeyEvent"]("keyup",!0,!0,window,!1,!1,!1,!1,0,0),(i=t.dispatchEvent(n))&&t.onkeyup&&t.onkeyup(n)},processContentEditable:function(e){var t=this.getElement(e.target);t&&(t.innerHTML=e.value,this.setNoReflection(t))},processHighlight:function(e){var t=this.getElement(e.target);t&&this.temporaryHighlight(t,e.offsetTop,e.offsetLeft,e.mode||"remote")},processCursor:function(e,t){var n,i;if(e){i="oneclick-client-cursor"+e,cursorIdName=i+"-name",n=t.cursor.name||"",cursorIdImg=i+"-image";var r=document.getElementById(i),o=t.cursor.position;if(null===r){var s=this.appendHTML('<div class="lcb-cursor-pointer" id="'+i+'" style="z-index:99999;top:'+o.y+"px;left:"+o.x+'px;position:absolute;"><div class="lcb-cursor-image"><img class="lcb-cursor-img" id="'+cursorIdImg+'"  src="" alt/></div><div class="lcb-cursor-name" id="'+cursorIdName+'">'+n+"</div></div></div>");null!==document.body&&(document.body.appendChild(s),window.livechat&&window.livechat.Chat&&livechat.Chat.setAgentCursorPictureCobrowsing())}else chatjQuery("#"+cursorIdName).text(" "+n+" "),r.style.top=o.y+"px",r.style.left=o.x-22+"px"}},appendHTML:function(e){var t=document.createDocumentFragment(),n=document.createElement("div");for(n.innerHTML=e;n.firstChild;)t.appendChild(n.firstChild);return t},processScroll:function(e){this.scrollTopGS(e.scroll.position.t),this.scrollLeftGS(e.scroll.position.l)},processElScroll:function(e){for(var t in e)if(e.hasOwnProperty(t)){var n=this.getElement(t);n&&(n.scrollTop=e[t].top,n.scrollLeft=e[t].left)}},processControlTransferComplete:function(e){e.dstId==this.srcId&&OneClickCbUtils.callBack("info","control transfer complete")},processAnnotation:function(e){if(canvas=document.getElementById("oneclick-annotation-canvas"),canvas){var t=e.data;"start"===t?this.canvasChange("block"):"end"===t?this.canvasChange("none"):"clear"===t?this.canvasClear(e,canvas):"wb-on"===t?chatjQuery("#oneclick-canvas-wrapper").css({opacity:1}):"wb-off"===t?chatjQuery("#oneclick-canvas-wrapper").css({opacity:.01}):this.canvasDraw(e)}},canvasChange:function(e){chatjQuery("#oneclick-canvas-wrapper").css({display:e,opacity:.01}),chatjQuery("#oneclick-annotation-canvas").css({display:e}),chatjQuery("#oneclick-background-canvas").css({display:e}),chatjQuery("#oneclick-annotation-toolbar").css({display:e})},canvasClear:function(e,t){var n=chatjQuery("oneclick-background-canvas");if(n.length){n[0].getContext("2d");bgCanvasContext.clearRect(0,0,t.width,t.height)}e.admin&&t.getContext("2d").clearRect(0,0,t.width,t.height)},canvasDraw:function(e){"none"==document.getElementById("oneclick-canvas-wrapper").style.display&&this.canvasChange("block");var t=chatjQuery("oneclick-background-canvas");if(t.length){t[0].getContext("2d");if(e.context){var n=e.context.split(":");bgCanvasContext.lineWidth=n[0],bgCanvasContext.strokeStyle=n[1]}bgCanvasContext.beginPath();var i=e.data.split(","),r=i[0].split("#");bgCanvasContext.moveTo(r[0],r[1]);for(var o=1;o<i.length;o++){var s=i[o].split("#");bgCanvasContext.lineTo(s[0],s[1]),bgCanvasContext.stroke()}}},processBye:function(e){var t=e.clientId;t&&(cursorId="#oneclick-client-cursor"+t,chatjQuery(cursorId).remove())},doFaultRecovery:function(){this.faultRecoverTimeOut||(this.currentFaultCount+=1,this.currentFaultCount>=this.maxFaultCount&&this.sendDocWithTimeout())},processGetDoc:function(){this.faultRecoverTimeOut||this.sendDocWithTimeout()},sendDocWithTimeout:function(){var e=Freeze.serializeDocument(),t=JSON.stringify(e);this.lastSentDoc=t,this.lastSentDocData=e;var n={type:"doc"};n.body={doc:e},n.css={sheet:Freeze.getInlineCSS()},Freeze.cssTextList=[],this.send(n);var i=this;this.faultRecoverTimeOut=setTimeout(function(){i.faultRecoverTimeOut=null,i.currentFaultCount=0},15e3)},processGetResolution:function(){this.windowWidth=this.windowHeight=null,windowWidthHeightListener()},getElement:function(e){return e&&"object"==typeof e&&e.jsmirrorId&&(e=e.jsmirrorId),this.elements[e]||(this.doFaultRecovery(),console.warn("Could not find element",e)),this.elements[e]||null},processCbStop:function(){OneClickCbUtils.callBack("info","cbStop"),this.cleanUp()},CbStop:function(){msg={type:"cbStop"},this.channel.send(msg),this.cleanUp()},mouseEventListener:function(e){var t=this,n=(e.clientX||e.pageX)+this.scrollLeftGS(),i=(e.clientY||e.pageY)+this.scrollTopGS();t.mouse.x==n&&t.mouse.y==i||(t.mouse.x=n,t.mouse.y=i,null===t.mouseTimeout&&(t.mouseTimeout=setTimeout(function(){t.mouseTimeout=null,t.send({type:"cursor",body:{cursor:{position:t.mouse,name:t.name}}})},250)))},scrollTopGS:function(t){if(void 0===t){try{t=this.document.documentElement.scrollTop||this.document.body.scrollTop}catch(e){t=0}return t}if(this.document.documentElement)try{this.document.documentElement.scrollTop=t}catch(e){}if(this.document.body)try{this.document.body.scrollTop=t}catch(e){}},scrollLeftGS:function(t){if(void 0===t){try{t=this.document.documentElement.scrollLeft||this.document.body.scrollLeft}catch(e){t=0}return t}if(this.document.documentElement)try{this.document.documentElement.scrollLeft=t}catch(e){}if(this.document.body)try{this.document.body.scrollLeft=t}catch(e){}},scrollEventListener:function(){this.scrollTop=this.scrollTopGS(),this.scrollLeft=this.scrollLeftGS(),this.send({type:"scroll",body:{scroll:{position:{t:this.scrollTop,l:this.scrollLeft}}}})},checkDocumentWidthHeight:function(){try{dw=chatjQuery(document).width(),dh=chatjQuery(document).height(),this.dw==dw&&this.dh==dh||(this.dw=dw,this.dh=dh,resizeCanvas("#cb-block-canvas",dw,dh))}catch(e){console.log(e)}},clearNoReflectionElements:function(){if(this.cbMaster){for(i=0;i<this.noReflectionElements.length;i++)el=this.noReflectionElements[i],delete el.noReflection,el.isContentEditable&&el.jsmirrorId&&(el.jsmirrorId=Freeze.makeId(el),this.elements[el.jsmirrorId]=el);this.noReflectionElements=[]}},setMasterParams:function(){this.cbMaster=!0,OneClickCbUtils.setMaster(!0),this.scrollEventListener(),chatjQuery("#cb-block-canvas").hide()},processTakeControl:function(e){console.log("processTabControl",e),"agent"==e.role?this.becomeFollower():"visitor"==e.role?0==this.cbMaster&&(this.setMasterParams(),OneClickCbUtils.callBack("info","Agent has given the control to you.")):console.error("unexpected role for takeControl",e)},becomeFollower:function(){this.cbMaster&&(this.cbMaster=!1,OneClickCbUtils.setMaster(!1),chatjQuery("#cb-block-canvas").show(),OneClickCbUtils.callBack("info","Agent has taken the control back."))},takeControl:function(){return this.setMasterParams(),msg={type:"takeControl"},msg.master=this.cbMaster,msg.role="visitor",this.channel.send(msg),!0},becomeMaster:function(e){this.setMasterParams(),msg={type:"controlTransferComplete"},msg.master=this.cbMaster,msg.srcId=this.srcId,msg.dstId=e.srcId,this.channel.send(msg),OneClickCbUtils.callBack("info","Agent has given the control to you.")},giveControl:function(){return!!this.cbMaster&&(msg={type:"giveControl"},msg.master=this.cbMaster,msg.srcId=this.srcId,this.channel.send(msg),this.cbMaster=!1,OneClickCbUtils.setMaster(!1),chatjQuery("#cb-block-canvas").show(),!0)},sendMasterHello:function(){!this.helloComplete&&OneClickCbUtils.isCobrowseActive()?this.send({type:"masterHello"}):clearInterval(this.sendMasterHelloTimeout)},getClickPosition:function(e){var t=0,n=0;return((e=e||window.event).clientX||e.clientY)&&document.body&&null!=document.body.scrollLeft&&(t=e.clientX+document.body.scrollLeft,n=e.clientY+document.body.scrollTop),(e.clientX||e.clientY)&&"CSS1Compat"==document.compatMode&&document.documentElement&&null!=document.documentElement.scrollLeft&&(t=e.clientX+document.documentElement.scrollLeft,n=e.clientY+document.documentElement.scrollTop),(e.pageX||e.pageY)&&(t=e.pageX,n=e.pageY),{clickX:t,clickY:n}},cloneClick:function(){return templateClick=chatjQuery("#oneclick-template-cursor"),templateClick.length||(templateClick=chatjQuery("<div/>",{id:"oneclick-template-cursor"}).addClass("lc-cb-touch-bg-vi").appendTo("body").hide()),templateClone=templateClick.clone(),templateClone.attr("id",null),templateClone},displayClick:function(e){var t=e.target||e.srcElement;if(!e.doNotTrack){if(t){if("cb-block-canvas"==t.id)return;if(Freeze.isCheckedElement(t)){var n=this.serializeEvent(event);this.send({type:"event",body:{event:n}})}}var i=this.getClickPosition(e),r=this.cloneClick();chatjQuery(document.body).append(r),r.css({top:i.clickY,left:i.clickX,borderColor:"red",display:"block"}),setTimeout(function(){r.addClass("freshdesk-hover")},400),setTimeout(function(){r.remove()},2e3)}},deleteMirrorIds:function(e){for(var t in e)e.hasOwnProperty(t)&&(el=e[t],el.jsmirrorId&&delete el.jsmirrorId)},diffRepr:function(t){for(var e="",n=0;n<t.length;n++){e&&(e+="\n");var i=t[n][0],r=t[n][1];if(window.OneClickCbUtils.master||window.mirror)try{var o=(window.OneClickCbUtils.master||window.mirror).getElement(r);o&&(r=o.tagName+":"+r)}catch(e){console.log(t);continue}"attrs"===i?e+="attrs("+r+")="+this.keys(t[n][2],!0).join(","):"delete"==i.substr(0,6)?e+=i+"("+r+")":(e+=i+"("+r+")="+t[n][2].length+"/"+parseInt(JSON.stringify(t[n][2]).length,10),e+="\n    "+JSON.stringify(t[n][2]))}return e},keys:function(e,t){var n=[];for(var i in e)n.push(i);return t&&n.sort(),n},cleanUp:function(){try{clearInterval(this.sendDocInterval),Freeze.removeEventListener(document,"mousemove",this.mouseEventListenerCallback,!1),Freeze.removeEventListener(document,"scroll",this.scrollEventListenerCallback,!1),Freeze.removeEventListener(document,"click",this.displayClickWrapper,!1),chatjQuery(window).off("resize",windowWidthHeightListener),msg={type:"cobrowseEnd"},this.send(msg),chatjQuery("div").filter(function(){return this.id.match(/oneclick-client-cursor/)}).remove(),chatjQuery("#cb-block-canvas").hide(),Freeze.elementTracker=null,this.deleteMirrorIds(this.elements),Freeze.makeId.counter=1e3,OneClickCbUtils.safeSessionSetItem("1click-cobrowsing","false"),OneClickCbUtils.setMaster(!0);var e=this;setTimeout(function(){e.channel.close()},1e3)}catch(e){console.error(e)}}},OneClickCbUtils.isCobrowseActive()&&OneClickCbUtils.cobrowseAutoRestart(),function(){var e,t;e=window.livechat,t=function(){function e(e,t){this.name=e,this.label=t.title,this.options=t.options,this.setVisibility(t.show),this.setValidator(e),this.value=null}return e.prototype.getValue=function(){return this.value||""},e.prototype.setVisibility=function(e){this.visibility=e,this.visibility&&"string"==typeof this.visibility&&(this.visibility=parseInt(this.visibility,10)),this.visibility||(this.visibility=0)},e.prototype.isRequired=function(){return 2===this.visibility},e.prototype.isNotRequired=function(){return 2!==this.visibility},e.prototype.isShown=function(){return 1===this.visibility},e.prototype.isHidden=function(){return 0===this.visibility},e.prototype.isValid=function(e){var t;return t=e||this.value,this.validator(t)},e.prototype.setValidator=function(e){switch(e){case"name":this.validator=function(){return this.isNotRequired()&&!this.value||this.value&&this.value.length<=100};break;case"email":this.validator=function(){var e;return e=/^([a-zA-Z0-9_\'\.\-\+])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/,this.isNotRequired()&&!this.value||this.value&&e.test(this.value)};break;case"phone":this.validator=function(){return this.isNotRequired()&&!this.value||this.value&&this.value.match(/^[0-9\-\(\)\s+]+$/)};break;case"textfield":this.validator=function(){return this.isNotRequired()&&!this.value||this.value&&0<this.value.length};break;case"textarea":this.name="textarea",this.validator=function(e){return this.isNotRequired()&&!this.value||this.value&&0<this.value.length};break;case"dropdown":this.validator=function(e){return this.isNotRequired()&&"-1"===this.value||this.value&&"-1"!==this.value};break;default:this.validator=function(){return!1}}},e}(),e.Field=t}.call(this),window.livechat=window.livechat||{},window.livechat.templates=window.livechat.templates||{},livechat.templates.chat='<div id="lc_chat_layout" class="lc-collapsed lc-prechat lc-support-widget <%= widgetPosition %>"><div id="lc_chat_header" class="<%= widgetColors.classes%> lc-header-bg"><img id="lc_agent_profile_pic" src="" class="lc-profile-pic"/><span id="lc_chat_title"><%= widgetTitle %></span><span id="lc-close" class="lc-close" title="Close"><i>&plus;</i></span><span id="lc_minimize" class="lc-minimize" title="Minimize"><i>&minus;</i></span></div><div id="lc_chat_container"><div id="lc_chat_window" class="lc-chat-window"><div class="overlay-bg"><div class="loader-desc"><%= loaderMessage %>...</div><div class="sloader"></div></div><div id="lc_chat_message_window"></div><div id="lc_chat_notification_window"></div><textarea id="lc_chat_input_container" tabindex="-1" placeholder="<%= messageBoxPlaceholder%>"></textarea><button id="lc_button_send" title="send"></button></div></div><div class="lc-end-chat hide"><p> </p><div class="lc-ec-choices"><button id="lc-ec-cancel" class="lc-ec-yes lc-ec-cancel"></button><button id="lc-ec-ok" class="lc-ec-no lc-ec-ok"></button></div></div></div><ul id="lc_cb_actions_vi" class="lc-cb-actions-vi"><li><div class="lc-cb-profile-vi"><img title="Username"/></div><div class="lc-cb-profile-info-vi"><div class="lc-cb-control-mode-vi"><p><%=livechat.defaultMessages.cb_viewing_screen_vi%></p><span class="lc-cb-give-control-vi" title="Give Control"><%=livechat.defaultMessages.cb_give_control_vi%></span></div><div class="lc-cb-view-mode-vi"><p><%=livechat.defaultMessages.cb_controlling_screen_vi%></p><p class="subtext"><%=livechat.defaultMessages.cb_view_mode_subtext%></p></div></div><div class="lc-cb-session-request-vi"><p> <%=livechat.defaultMessages.cb_visitor_session_request%></p><button id="deny_cb_session_vi" class="lc-cb-session-deny-vi" >Deny</button><button id="allow_cb_session_vi" class="lc-cb-session-allow-vi">Allow</button></div><div class="lc-cb-notification-vi"><p><%=livechat.defaultMessages.cobrowsing_agent_request_control%> </p><button id="deny_cb_vi" class="lc-cb-button-deny-vi" >Deny</button><button id="allow_cb_vi" class="lc-cb-button-allow-vi">Allow</button></div></li><li class="lc-cb-stop-vi" title="Stop Screen Sharing"><i class="lcb-cross">+</i><span><%=livechat.defaultMessages.cobrowsing_stop_request%></span></li></ul>',livechat.templates.message='<p class="<%=message.class%>"><span class="lc-msg-block"><span class="lc-msg"><% if(message.type === \'typing\'){ %><span class=\'lc-typing-dots\'><span></span><span></span><span></span></span><% }else{%><%=message.content%></span><% if(message.time) {%><span class="lc-time"><%=message.time%></span><% } %><% } %><% if(message.chatId ) {%><span id="<%=message.id%>" createdAt= "<%= new Date(message.createdAt) %>" actualCreatedAt= "<%= message.actualCreatedAt %>" actualReceivedAt= "<%=message.actualReceivedAt %>" style="display: none;"></span><% } %></span></p>',livechat.templates.notification='<p id="<%= notification.id%>" class="<%= notification.class%>" ><%= notification.content %></p>',livechat.templates.offline='<div id="lc_offline_chat_form" class="lc-offline-form"><p><%= nonAvailabilityMessage %></p><ul class="lc-form-field-wrap"><%livechat._.each(fields, function(field){ %><li class="lc-textfield-wrap"><label for="lc_chat_offline_<%=field.name%>" class="lc-chat-required"><%= field.label%><span> *</span></label><% if(field.name == "textarea"){ %><textarea type="text" id="lc_chat_offline_textarea"><%if(msg){ %><%= msg %> <% } %></textarea><% }else{ %><input type="text" maxlength="50" id="lc_chat_offline_<%=field.name%>" value="<%=field.getValue()%>"><% } %></li><% })%></ul><div id="lc_button_holder" class="lc-button-holder"><button id="lc_offline_submit"  class="lc-button-submit"></button></div></div>',livechat.templates.prechat='<div id="lc_prechat_form" class="lc-pre-form"><p><%= preChatMessage %></p><ul class="lc-form-field-wrap"><%livechat._.each(fields, function(field){ %><% if(!field.isHidden()) { %><li class="lc-textfield-wrap"><% if(field.isRequired()) { %><label for="lc_chat_<%=field.name%>" class="lc-chat-required"><%=field.label%><span> *</span></label><% }else{ %><label for="lc_chat_<%=field.name%>"><%=field.label%></label><% } %><% if(field.name == "dropdown") { %><div class="lc-select"><span><%= (field.getValue() || "...") %></span><select id="lc_chat_<%=field.name%>" ><option <%= (field.getValue() ? "" : "selected" )%> value="-1" >...</option><%livechat._.each(field.options, function(option) { %><option <%= ((field.getValue() === option) ? "selected" : "") %> value="<%= option%>" ><%= option%></option><% })%></select></div><% } else{ if (field.name == "name" || field.name == "textfield"){ %><input type="text" maxlength="100" id="lc_chat_<%=field.name%>" value="<%=field.getValue()%>"><% } else { %><input type="text" maxlength="50" id="lc_chat_<%=field.name%>" value="<%=field.getValue()%>"><% } } %></li><% } %><% });%></ul><div id="lc_button_holder" class="lc-button-holder"><button id="lc_prechat_submit" class="lc-button-submit"></button></div></div>',function(){var r,n,e,i;r=window.livechat,n=r.Constants,r.Browser,r.jQuery,i=r._,e=function(){function e(){this.id=null,this.name=null,this.email=null,this.phone=null,this.textfield=null,this.dropdown=null,this.chatId=null,this.blocked=!1,this.session=null,this.visitCount=0,this.recentChatId=null,this.autoConnectTimer=null,this.forceDisconnectTimer=null}return e.prototype.initialize=function(){this.chat=r.Chat,this.chatView=r.ChatView,this.widget=r.Widget,this.migrateOldCookies(),this.id=this.getId(),!window.LIVECHAT_SUPPORT&&this.id||this.initizlizeId(),this.hasValues(window.FRESHCHAT_VISITORINFO)?this.setVisitorProperties(window.FRESHCHAT_VISITORINFO):(this.setName(r.Cache.getItem("livechat_vname")),this.setEmail(r.Cache.getItem("livechat_vemail")),this.setPhone(r.Cache.getItem("livechat_vphone")),this.setTextfield(r.Cache.getItem("livechat_vtextfield")),this.setDropdown(r.Cache.getItem("livechat_vdropdown")),this.visitCount=r.Cache.getItem("livechat_vcount")),this.setSession()},e.prototype.initizlizeId=function(){this.setId(this.generateVisitorId())},e.prototype.getId=function(){return this.id||r.Cache.getItem("livechat_vid")},e.prototype.getName=function(){return this.name||r.Cache.getItem("livechat_vname")},e.prototype.getEmail=function(){return this.email||r.Cache.getItem("livechat_vemail")},e.prototype.getPhone=function(){return this.phone||r.Cache.getItem("livechat_vphone")},e.prototype.getTextfield=function(){return this.textfield||r.Cache.getItem("livechat_vtextfield")},e.prototype.getDropdown=function(){var e;return(e=r.Cache.getItem("livechat_vdropdown"))&&"-1"===e&&(e=null),e},e.prototype.getSupportDropdown=function(){var e;return this.widget.preChatFields.dropdown&&(e="active"===SUBSCRIPTION_STATE?this.widget.preChatFields.dropdown.options[1]:this.widget.preChatFields.dropdown.options[0]),e},e.prototype.getVisitCount=function(){return this.visitCount||r.Cache.getItem("livechat_vcount")},e.prototype.getDiconnectedFlag=function(){return r.Cache.getItem("livechat_vdisconnected")},e.prototype.setId=function(e){e&&r.Cache.setItem("livechat_vid",this.id=e)},e.prototype.setName=function(e){e&&r.Cache.setItem("livechat_vname",this.name=e)},e.prototype.setEmail=function(e){/^([a-zA-Z0-9_;\&\#\'\.\-\+])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/.test(e)&&r.Cache.setItem("livechat_vemail",this.email=e)},e.prototype.setPhone=function(e){e&&/^[0-9\-\(\)\s+]+$/.test(e)&&r.Cache.setItem("livechat_vphone",this.phone=e)},e.prototype.setTextfield=function(e){e?r.Cache.setItem("livechat_vtextfield",this.textfield=e):r.Cache.removeItem("livechat_vtextfield")},e.prototype.setDropdown=function(e){e&&-1!==e&&"-1"!==e?r.Cache.setItem("livechat_vdropdown",this.dropdown=e):r.Cache.removeItem("livechat_vdropdown")},e.prototype.incrementVisitCount=function(){++this.visitCount,r.Cache.setItem("livechat_vcount",""+this.visitCount)},e.prototype.setDisconnectedFlag=function(){return r.Cache.setItem("livechat_vdisconnected",(new Date).toString())},e.prototype.removeDisconnectedFlag=function(){return r.Cache.removeItem("livechat_vdisconnected")},e.prototype.generateVisitorId=function(){return"visitor"+(window.LIVECHAT_SUPPORT&&CURRENT_USER.id&&CURRENT_ACCOUNT.id?CURRENT_ACCOUNT.id+"x"+CURRENT_USER.id:Math.round(Math.random()*(new Date).getTime()))},e.prototype.setVisitorProperties=function(e){var t;for(t in(e=i.omit(e,["created_at","updated_at"])).textfield=e.custom_field1,e.dropdown=e.custom_field2,delete e.custom_field1,delete e.custom_field2,e)new Function("self","return self.set"+t.replace(/\w\S*/g,function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()}))(this)(e[t])},e.prototype.hasValues=function(e){return 0<(e?i.compact(i.values(e)):"").length},e.prototype.clearDetails=function(){this.id=null,this.name=null,this.email=null,this.phone=null,this.textfield=null,this.dropdown=null,this.visitCount=null,this.chatId=null,this.blocked=!1,this.session=null,r.Cache.removeItem("livechat_vid"),r.Cache.removeItem("livechat_vname"),r.Cache.removeItem("livechat_vemail"),r.Cache.removeItem("livechat_vphone"),r.Cache.removeItem("livechat_vtextfield"),r.Cache.removeItem("livechat_vdropdown"),r.Cache.removeItem("livechat_vcount"),this.initizlizeId()},e.prototype.migrateOldCookies=function(){var e,t,n,i;for(i in t={fc_vid:"livechat_vid",fc_vname:"livechat_vname",fc_vmail:"livechat_vemail",fc_vphone:"livechat_vphone",fc_vtextfield:"livechat_vtextfield",fc_vdropdown:"livechat_vdropdown",fc_vcount:"livechat_vcount",fc_agent:"livechat_agent_name"})n=t[i],(e=r.Cookies.getCookie(i))&&r.Cache.setItem(n,e)},e.prototype.setSession=function(){var e,n;(e=r.Cache.getItem("livechat_session"))?this.session=JSON.parse(e):(this.session={},r.Location.fetch((n=this,function(e){n.session.location=e,r.Browser.detect(function(e){var t;n.session.browser=e,(t={}).is_tablet=!!navigator.userAgent.match(/(iPad|SCH-I800|xoom|kindle)/i),t.is_phone=!t.is_tablet&&!!navigator.userAgent.match(/(iPhone|iPod|blackberry|android 0.5|htc|lg|midp|mmp|mobile|nokia|opera mini|palm|pocket|psp|sgh|smartphone|symbian|treo mini|Playstation Portable|SonyEricsson|Samsung|MobileExplorer|PalmSource|Benq|Windows Phone|Windows Mobile|IEMobile|Windows CE|Nintendo Wii)/i),t.is_mobile=t.is_tablet||t.is_phone,n.session.device=t,n.session.locale=n.getLocale(),n.session.visitedPage=encodeURI(window.location.href),n.session.referer=document.referrer,r.Cache.setItem("livechat_session",r.JSON3.stringify(n.session))})})))},e.prototype.getLocale=function(){var e,t;return 2===(e=((t=window.navigator).language||t.browserLanguage||t.systemLanguage||t.userLanguage||"").split("-")).length?{language:e[0].toLowerCase(),country:e[1].toLowerCase()}:e?{language:e[0].toLowerCase(),country:null}:{language:null,country:null}},e.prototype.startAutoConnectTimer=function(){this.autoConnectTimer=setTimeout(function(){r.client.connect()},n.TIME.AUTO_CONNECT)},e.prototype.stopAutoConnectTimer=function(){clearTimeout(this.autoConnectTimer),this.autoConnectTimer=null},e.prototype.startForceDisconnectTimer=function(e){var t;this.forceDisconnectTimer=setTimeout((t=this,function(){t.chat.isActive()?t.startForceDisconnectTimer(n.TIME.CHECK_CHAT):r.client.isConnected()&&(t.stopForceDisconnectTimer(),r.client.primary.pushToVisitorTabs("force disconnect",{force_disconnect:!0}))}),e)},e.prototype.stopForceDisconnectTimer=function(){clearTimeout(this.forceDisconnectTimer),this.forceDisconnectTimer=null},e.prototype.connectionRequest=function(){var e;(e=this.chatView.getVisitorDetails()).widget_id=this.widget.id,e.recentChatId=this.recentChatId,e.current_session=this.session,e.isReturningVisitor=0<this.visitCount,e.visitorLimitReached=this.widget.visitorLimitReached,r.client.pushToServer("connection request",e)},e.prototype.block=function(e){this.blocked=!0,r.client.primary.pushToVisitorTabs("force disconnect",{force_disconnect:!0})},e.prototype.unblock=function(){this.blocked=!1},e.prototype.isReturnVisitor=function(){var e;return r.client?r.client.primary.isInReturningVisitorChannel():null!=(e=r.Cache.getItem("livechat_vcount"))?e:{true:!1}},e.prototype.resetVisitor=function(){this.stopAutoConnectTimer(),r.Visitor=new e},e}(),r.Visitor=new e}.call(this),function(){var l,u,e,a,c=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};(l=window.livechat).Constants,u=l.jQuery,a=l._,e=function(){function e(){this.name=null,this.id=null,this.name=null,this.show=!1,this.active=!1,this.debug=null,this.nodeUrl=null,this.siteId=null,this.siteUrl=null,this.teamstatus=!1,this.environment=null,this.windowPosition=null,this.windowOffset=null,this.windowColor=null,this.proactiveChat=null,this.proactiveTime=null,this.title=null,this.welcomeMessage=null,this.messageBoxPlaceholder=null,this.waitingMessage=null,this.moreWaitingMessage=null,this.trasferredMessage=null,this.thanksMessage=null,this.loaderMessage=null,this.nonAvailabilityMessage=null,this.nonAvailabilityLinkUrl=null,this.nonAvailabilityCustomLink=null,this.preChatForm=!1,this.preChatMessage=null,this.businessCalendar=null,this.offlineChat=!1,this.offlineChatSettings=null,this.hideWidget=!1,this.assetUrlPrefix=null,this.sessionHash=null,this.preChatFields=null,this.offlineChatFields=null,this.soundEnabled=!0,this.helpdeskName=null,this.visitorLimitReached=!1}return e.prototype.initialize=function(){var e;try{e=u.parseJSON(l.Base64.decode(window.livechat_setting||window.livechatSettings||window.freshchat_setting))}catch(e){return void console.log("Error in parsing widget setting")}this.id=e.widget_id,this.name=e.name,this.siteId=e.fc_id,this.siteUrl=e.weburl,this.environment=e.environment,this.debug=e.debug,this.initializeNodeUrl(e.nodeurl)},e.prototype.initializeNodeUrl=function(e){var t,n,i,r;e=e.replace("https://","").replace(":443",""),"development"===this.environment?(this.nodeUrl="http://"+e+":4000",this.photosUrl="http://"+this.siteUrl+":3000"):"staging"===this.environment?(this.nodeUrl="https:"===(null!=(t=window.location)?t.protocol:void 0)?"https://"+e+":443":"http://"+e+":80",this.photosUrl="https:"===(null!=(n=window.location)?n.protocol:void 0)?"https://"+this.siteUrl+":443":"http://"+this.siteUrl+":80"):(this.nodeUrl="http:"===(null!=(i=window.location)?i.protocol:void 0)&&this.isLegacyIEVersion?"http://"+e+":80":"https://"+e+":443",this.photosUrl="http:"===(null!=(r=window.location)?r.protocol:void 0)&&this.isLegacyIEVersion?"http://"+this.siteUrl+":80":"https://"+this.siteUrl+":443")},e.prototype.isLegacyIEVersion=function(){var e,t;return-1!==(e=navigator.userAgent.toLowerCase()).indexOf("msie")&&(8===(t=parseInt(e.split("msie")[1]))||9===t)},e.prototype.isInBusinessHours=function(){return!this.businessCalendar||l.BusinessHours.isBusinessHour(this.businessCalendar)},e.prototype.updateSettings=function(e,t){var n,i,r;try{n=u.parseJSON(l.Base64.decode(window.livechat_setting||window.livechatSettings||window.freshchat_setting)),r=u.parseJSON(e.widget_preferences)}catch(e){return void console.log("Error in parsing the widget livechat_setting")}i=e.defaultMessages,this.id=this.id||e.id||e.widget_id,this.name=this.name||e.name,this.siteId=this.siteId||e.site_id,this.active=e.active||!1,this.teamstatus=t,this.windowColor=r.window_color||i.widget_preferences.window_color,this.windowOffset=r.window_offset||i.widget_preferences.window_offset,this.me=n.me?n.me:"Me",this.proactiveTime=e.proactive_time,this.proactiveChat=e.proactive_chat,this.businessCalendar=e.business_calendar,this.windowPosition=r.window_position||i.widget_preferences.window_position,this.title=r.header||i.widget_preferences.header,this.messageBoxPlaceholder=r.text_place||i.widget_preferences.text_place,this.welcomeMessage=r.welcome_message||i.widget_preferences.welcome_message,this.moreWaitingMessage=r.wait_message||i.widget_preferences.wait_message,this.thanksMessage=r.thank_message||i.widget_preferences.thank_message,this.loaderMessage=i.widget_preferences.loader_message,this.endChatConfirmMessage=r.end_chat_confirm_msg||i.widget_preferences.end_chat_confirm_msg,this.agentNetworkDisconnectMessage=r.agent_network_disconnect_msg||i.widget_preferences.agent_network_disconnect_msg,this.preChatForm=e.prechat_form||!1,this.preChatMessage=e.prechat_message||i.prechat_message,this.sessionHash=e.sessionHash,this.helpdeskName=n.helpdeskname,OneClickCbUtils.setCobrowsingServer(e.cobrowsingSocketServer,e.cobrowsingRailsApp),this.assetUrlPrefix="development"===this.environment?this.nodeUrl:e.cloudfront,l.Sound.initialize(),l.defaultMessages=e.cbDefaultMessages,this.setPreChatFields(e,i.prechat_fields),this.setOfflineSettings(e,i.offline_chat),this.setNonAvailabilitySettings(e,i.non_availability_message),this.trasferredMessage=r.agent_transfer_msg_to_visitor||i.widget_preferences.agent_transfer_msg_to_visitor},e.prototype.setOfflineSettings=function(e,t){var n,i,r,o,s,a,c;for(i in e.offline_chat?(this.offlineChatSettings=JSON.parse(e.offline_chat),this.offlineChatSettings=this.setDefaults(this.offlineChatSettings,t)):this.offlineChatSettings=t,this.teamstatus&&this.isInBusinessHours()||("1"===this.offlineChatSettings.show||!this.teamstatus&&this.isInBusinessHours()&&"2"!==this.offlineChatSettings.show||window.LIVECHAT_SUPPORT?(this.offlineChat=!0,this.preChatForm=!1):this.hideWidget=!0),this.offlineChatFields={},c=l.Visitor,o=this.offlineChatSettings.form)s=o[i],"message"===i&&(i="textarea"),n=new l.Field(i,{title:s,show:2}),c[r="get"+i.charAt(0).toUpperCase()+i.substr(1).toLowerCase()]&&(a=c[r].call(c)),a&&"null"!==a&&(n.value=a),this.offlineChatFields[i]=n},e.prototype.setPreChatFields=function(e,t){var n,i,r,o,s,a,c;for(r in this.preChatFields={},c=l.Visitor,n=e.prechat_fields?(n=JSON.parse(e.prechat_fields),this.setDefaults(n,t)):t)s=n[r],i=new l.Field(r,s),c[o="get"+r.charAt(0).toUpperCase()+r.substr(1).toLowerCase()]&&(a=c[o].call(c)),a&&"null"!==a&&(i.value=a),this.preChatFields[r]=i},e.prototype.setNonAvailabilitySettings=function(e,t){var n,i,r,o,s,a,c;a=e.non_availability_message,n=t.text,c=/#(.*?)#/g,a?"string"==typeof(a=u.parseJSON(a)).customLink&&(a.customLink=parseInt(a.customLink,10)):a=t,r=(s=a.text?a.text:n)?s.match(c):"",o=a.customLinkUrl,r&&o&&(s=a.customLink&&!this.offlineChat?(i="<a class='ticket_link' target='_blank' href="+(-1===o.indexOf("://")?"//"+o:o)+">"+r[0].substring(1,r[0].length-1)+"</a>",s.replace(r[0],i)):s.replace(r[0],r[0].substring(1,r[0].length-1))),this.nonAvailabilityMessage=s,this.nonAvailabilityCustomLink=a.customLink,this.nonAvailabilityLinkUrl=a.customLinkUrl},e.prototype.setDefaults=function(t,n){var e,i,r,o,s;for(i in e=a.keys(n),s=a.keys(t),t)if(t.hasOwnProperty(i))for(o in r=t[i])r.hasOwnProperty(o)&&""===r[o]&&(t[i][o]=n[i][o]);return livechat._.each(e,function(e){if(c.call(s,e)<0)return t[e]=n[e]}),t},e.prototype.disableSound=function(){},e.prototype.sitesToSkipAutoConnect=function(){return["da56e9d03c3d40df7ed32873991e62c0","bbac2e6afb1af7a8b571ec40a9a7fddb"]},e.prototype.resetWidget=function(){l.Widget=new e},e}(),l.Widget=new e}.call(this),function(){var r,n,e;(r=window.livechat).Constants,n=r.jQuery,r._,e=function(){function e(){this.visitor=r.Visitor,this.widget=r.Widget,this.id=null,this.type=null,this.pings=[],this.pingSent=!1,this.missed=!1,this.offline=!1,this.agentId=null,this.agentName=null,this.agentNameCached=null,this.cachedPing=null,this.cachedPingTime=null,this.closed=!1,this.active=!1,this.proactive=!1,this.ongoing=!1,this.agentDisconnected=!1,this.agentNetworkDisconnected=!1,this.messageHistory=[],this.visitorClosedChat=!1}return e.prototype.initialize=function(){this.initializeCachedPing()},e.prototype.initializeCachedPing=function(){var e;e=r.Cache.getItem("pingStatus"),this.pings=[];try{e?(e=JSON.parse(e),(new Date).getTime()-e.pingCreatedAt>=r.Constants.TIME.PING_STORAGE_TIMEOUT+r.Constants.TIME.PING_STORAGE_GRACE_TIME||e.userId!==this.visitor.getId()?(this.removeCachedPing(),e=null):(this.cachedPing=e,this.cachedPing.isProactive&&(this.proactive=this.cachedPing.isProactive),this.pings.push(this.cachedPing),this.cachedPingTime=this.cachedPing.pingCreatedAt)):this.cachedPing=null}catch(e){this.cachedPing=null}},e.prototype.pushToCachedPing=function(e,t){this.cachedPing=this.cachedPing||{ping:!0,pingCreatedAt:(new Date).getTime(),userId:this.visitor.getId(),msg:[]},this.visitor.getId()!==this.cachedPing.userId&&(this.cachedPing.userId=this.visitor.getId(),this.cachedPing.pingCreatedAt=(new Date).getTime()),e&&this.cachedPing.msg.push(e),this.cachedPing.isProactive=t,r.Cache.setItem("pingStatus",JSON.stringify(this.cachedPing))},e.prototype.getCachedPing=function(){return this.cachedPing},e.prototype.removeCachedPing=function(){localStorage.removeItem("pingStatus"),this.cachedPing=null},e.prototype.setRecentChatDetails=function(e){(e.active||e.ongoing)&&(this.id=e.chatId,this.ongoing=e.ongoing,this.active=e.active,e.agentId&&(this.agentId=e.agentId),e.agentName&&(this.agentName=e.agentName),e.hasOwnProperty("closed")&&(this.closed=e.closed))},e.prototype.getAgentName=function(){return this.agentName||r.Cache.getItem("livechat_agent_name")},e.prototype.setAgentName=function(e,t){e&&(this.agentName=e,r.Cache.setItem("livechat_agent_name",e))},e.prototype.clearAgentName=function(){this.agentName=null,r.Cache.removeItem("livechat_agent_name")},e.prototype.isInActive=function(){return!this.isActive()},e.prototype.isActive=function(){return!this.visitor.blocked&&(this.ongoing||this.active)},e.prototype.fetchTranscript=function(e){var t;t={userId:this.visitor.getId(),siteId:this.widget.siteId,code:"fd",chatId:this.id},n.ajax({type:"GET",url:this.widget.nodeUrl+"/visitors/chatTranscript",data:t,dataType:"json",cache:!1,success:e,error:function(e,t,n){window.console&&console.log&&console.log("error getting visitor transcript",n)}})},e.prototype.sendMessage=function(e){var t,n,i;i=this.visitor.getName()||this.visitor.getId(),t=this.visitor.session?this.visitor.session.location:null,n={id:this.id,msg:e,username:i,photo:"/images/fillers/profile_blank_thumb.gif",inConversation:this.ongoing,widget_id:this.widget.id,widget_name:this.widget.name,location:t,current_session:this.visitor.session,socket:r.client.getAuxiliarySocketId(),actualCreatedAt:(new Date).toUTCString(),dropdown:this.visitor.getDropdown(),visitorLimitReached:this.widget.visitorLimitReached},r.client.pushToServer("my_msg_visitor",n)},e.prototype.addMessageToHistory=function(e){return this.messageHistory.push(e)},e.prototype.isADuplicateMessage=function(t){return livechat._.find(this.messageHistory,function(e){if(e.id===t.id)return!0})},e.prototype.setAgentProfilePicture=function(){n("#lc_chat_header #lc_agent_profile_pic").attr("src",this.widget.photosUrl+"/users/"+this.agentId+"/profile_image")},e.prototype.setAgentCursorPictureCobrowsing=function(){n(".lcb-cursor-img").attr("src",this.widget.photosUrl+"/users/"+this.agentId+"/profile_image")},e.prototype.clearAgentProfilePicture=function(){n("#lc_chat_header #lc_agent_profile_pic").attr("src","")},e.prototype.resetChat=function(){this.removeCachedPing(),r.Chat=new e},e}(),r.Chat=new e}.call(this),function(){var n,e;n=window.livechat,e=function(){function e(){this.widget=n.Widget,this.initialized=!1,this.audioElement=null}return e.prototype.initialize=function(){return this.initialized=!0,this.audioElement=document.createElement("audio"),this.audioElement.src=this.widget.assetUrlPrefix+"/sound/message_alert.mp3"},e.prototype.play=function(e,t){!n.Cookies.getCookie(e)&&this.initialized&&(n.Cookies.setCookie(e,!0,5e3),this.audioElement.play(t))},e.prototype.resetSound=function(){n.Sound=new e},e}(),n.Sound=new e}.call(this),function(){var s,e,r={}.hasOwnProperty;(s=window.livechat)._,s.jQuery,e=function(e){function t(){this.visitor=s.Visitor,this.widget=s.Widget,this.chat=s.Chat,this.chatView=s.ChatView,this.coBrowseView=s.CoBrowseView,this.namespace="/visitor",this.connection=null}return function(e,t){for(var n in t)r.call(t,n)&&(e[n]=t[n]);function i(){this.constructor=e}i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype}(t,s.EventEmitter),t.prototype.connect=function(e){var t,n,i;this.isConnected()?e&&e():this.connection?this.connection.io.connect():(n=this.widget.nodeUrl+this.namespace,t=["siteid="+this.widget.siteId,"s="+this.widget.sessionHash,"c=fd","i="+this.visitor.getId(),"w_id="+this.widget.id,"r="+this.visitor.getVisitCount()].join("&"),!1===window.livechat.cookieTest&&(t=t+"&cookieVisitor="+window.livechat.cookieTest),(i={forceNew:!0}).reconnectionAttempts=window._lc_reconnect_attempt,this.connection=s.io.connect(n+"?"+t,i),this.initializeLogger(),this.bindEvents())},t.prototype.initializeLogger=function(){var e,n,i,t;4===this.widget.debug&&(localStorage.debug="socket.io-client:socket",e=this.connection.emit,this.connection.emit=(t=this,function(){console.log(new Date,"***","emit",Array.prototype.slice.call(arguments)),e.apply(t.connection,arguments)}),n=this.connection.onevent,this.connection.onevent=(i=this,function(e){var t;t=e.data||[],console.log(new Date,"***","onevent",t),n.call(i.connection,e)}))},t.prototype.bindEvents=function(){var e,t,n,i,r,o;this.connection.on("connect",(e=this,function(){e.chatView.connect()})),this.connection.on("error",(t=this,function(e){4===t.widget.debug&&window.console&&console.log&&console.error("Unable to connect ",e)})),this.connection.on("disconnect",(n=this,function(e){n.chatView.disableInputContainer(),n.visitor.stopForceDisconnectTimer(),n.chat.id=""})),this.connection.on("connection accepted",(i=this,function(e){s.client.primary.isConnected()&&i.chatView.disableLoader(),s.client.triggerGloablEvent("visitor-connection-accepted",[e])})),this.connection.on("join",(r=this,function(e){r.pushToServer("join room",{id:e.roomId}),r.chatView.stopAgentDisconnectTimer()})),this.connection.on("leave",(o=this,function(e){o.pushToServer("leave room",{id:e.roomId})}))},t.prototype.isConnected=function(){var e;return null!=(e=this.connection)?e.connected:void 0},t.prototype.disconnect=function(){this.connection.io.disconnect()},t.prototype.pushToServer=function(e,t){this.connection.emit(e,t)},t.prototype.getSocketId=function(){return this.connection.io.engine.id},t}(),s.SocketConnection=e}.call(this),function(){var n,e,i=function(e,t){return function(){return e.apply(t,arguments)}},r={}.hasOwnProperty;n=window.livechat,e=function(e){function t(){this.reset=i(this.reset,this),this.bindCustomEvents=i(this.bindCustomEvents,this),this.sound=n.Sound,this.visitor=n.Visitor,this.widget=n.Widget,this.chat=n.Chat,this.connection=null}return function(e,t){for(var n in t)r.call(t,n)&&(e[n]=t[n]);function i(){this.constructor=e}i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype}(t,n.EventEmitter),t.prototype.connectToReturnOrOnline=function(){},t.prototype.subscribeConversationChannel=function(){},t.prototype.subscribeChatChannel=function(){},t.prototype.getReturnVisitorChannel=function(){},t.prototype.unSubscribeFromChannel=function(){},t.prototype.unsubscribeFromAllChannels=function(){},t.prototype.bindCustomEvents=function(){var e;(e=this._getEvents())["chat-closed"]||this.on("chat-closed",function(e){this.switchChannelsOnChatClose(e.chatId),this.chatView.postChatCloseEvents(e)}),e["visitor-connection-accepted"]||this.on("visitor-connection-accepted",function(e){return e&&this.chat.setRecentChatDetails(e),this.chatView.isChatInProgress(),this.chat.ongoing?(this.chat.removeCachedPing(),this.chat.pings=[],e&&e.visitorClosedChat?this.chat.loadTranscript=!1:this.chat.loadTranscript=!0,this.subscribeChatChannel(this.chat.id),this.subscribeConversationChannel(),this.chatView.postChatConnectedEvents(e)):(this.chatView.enableInputContainer(),this.chatView.sendPingMessages())})},t.prototype.reset=function(){this.sound=n.Sound,this.visitor=n.Visitor,this.widget=n.Widget,this.chat=n.Chat,this.unsubscribeFromAllChannels(),this.disconnect(),this.removeEvent("chat-closed"),this.removeEvent("visitor-connection-accepted")},t}(),n.Abstract=e}.call(this),function(){var n;(n=window.livechat).chatEvents={visitor_new_msg:function(e){var t;e.socket&&e.socket!==n.client.getAuxiliarySocketId()&&(e.content=e.msg,this.chatView.addMessage(e),n.MainView.pageActive||this.sound.play("messageAlert",e.id),this.chatView.flashPageTitle(e.name,e.content)),e.userId!==this.visitor.getId()&&(n.client.pushToServer("msg received",t={id:e.id,chatId:e.chatId,actualReceivedAt:(new Date).toUTCString()}),this.chatView.hideTyping(),this.chatView.addMessageReceivedAt(t.id,t.actualReceivedAt))},typing:function(e){this.visitor.getId()!==e.userId&&this.chatView.showTyping(e)}}}.call(this),function(){var t,n;t=window.livechat,n=t.jQuery,t.visitorEvents={"ping accepted":function(e){var t;this.chat.proactive=!1,this.chatView.reason=null,this.chatView.postChatConnectedEvents(e),n("#lc-close").removeClass("hide"),this.chatView.triggerEvent("fd_lc_ping_accepted"),this.chat.removeCachedPing(),this.subscribeConversationChannel(e.id),this.subscribeChatChannel(e.id),t=n("#lc_chat_layout"),n("#chat-widget").length&&!t.is(":visible")&&t.show()},"chat close":function(e){e.chatId===this.chat.id&&t.client.triggerGloablEvent("chat-closed",[e]),this.chatView.triggerEvent("fd_lc_chat_closed")},"update chat":function(e){e&&e.chatId&&(e.agentName=this.chat.agentNameCached,this.chatView.postChatConnectedEvents(e),this.subscribeConversationChannel(e.chatId),this.subscribeChatChannel(e.chatId))},"ping initiated":function(e){e.clearChatCookie&&(this.chat.active=!1),this.chatView.startWaitingMessageAndTimer()},transfer:function(e){t.client.pushToServer("leave room",{id:this.chat.id}),this.unSubscribeFromChatChannel(this.chat.id),t.client.pushToServer("join room",{id:e.id}),this.subscribeChatChannel(e.id),this.chatView.postChatConnectedEvents(e),this.chatView.showChatTransferredMessage()},"agent connect":function(e){this.chatView.agentConnected(e)},"agents available":function(e){this.chatView.updateWaitingAndNonAvailabilityTimers(e)},"blocked visitor":function(e){this.visitor.block(e)},"unblocked visitor":function(e){this.visitor.unblock(e)},"update details":function(e){this.visitor.setVisitorProperties(e)},"agent network disconnect":function(e){this.chatView.agentNetworkDisconnected(e)},"agent network connect":function(e){this.chatView.agentNetworkConnected(e)},"agent disconnect":function(e){this.chatView.agentDisconnected(e)},"force disconnect":function(e){e.force_disconnect&&t.client.disconnect(),this.chatView.disableInputContainer(),this.visitor.stopForceDisconnectTimer()},"cobrowse start":function(e){t.CoBrowseView.setLocalStorage("CBVisitorReqStartTime",0),this.coBrowseView.cbTimerHandle&&window.clearInterval(t.CoBrowseView.cbTimerHandle),this.coBrowseView.requestCoBrowsingSession(e)},"cobrowse stop":function(e){this.coBrowseView.cobrowsingEnd(e)},"cobrowse request cancelled":function(){this.coBrowseView.coBrowsingRequestCancelled()},"cobrowse control request":function(){this.coBrowseView.coBrowseControlRequest()},"ping received ack":function(e){window&&window.livechat&&window.livechat.printpingack&&console.log("livechat::debug:::ping received ack::",e)}}}.call(this),function(){var a,o,s,e,c,r={}.hasOwnProperty;a=window.livechat,s=a.Constants,o=a.jQuery,c=a._,e=function(e){function i(e){var t,n;this.bindEvents=(t=this.bindEvents,n=this,function(){return t.apply(n,arguments)}),this.appKeys=e,this.chatView=a.ChatView,this.coBrowseView=a.CoBrowseView,this.visitor=a.Visitor,this.client=a.client,i.__super__.constructor.apply(this,arguments)}return function(e,t){for(var n in t)r.call(t,n)&&(e[n]=t[n]);function i(){this.constructor=e}i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype}(i,a.Abstract),i.prototype.connect=function(e){var t,n,i;this.visitor.removeDisconnectedFlag(),n={authEndpoint:this.widget.nodeUrl+"/visitors/grantPermissions",authTransport:"jsonp",auth:{params:{userId:this.visitor.getId(),siteId:this.widget.siteId}}},4===this.widget.debug&&(Pusher.log=function(e){return console.log("Recevied Message ---\x3e",e)}),console.log("appKeys ===>",this.appKeys),t=this.appKeys,c.isObject(this.appKeys)&&(t=this.appKeys.key,this.appKeys.cluster&&(n.cluster=this.appKeys.cluster)),this.connection=new Pusher(t,n),this.connection.connection.bind("state_change",(i=this,function(e){if(e&&"unavailable"===e.current)return i.visitor.setDisconnectedFlag()})),this.bindCustomEvents(),this.subscribeToUserChannel(e)},i.prototype.disconnect=function(){this.connection.disconnect()},i.prototype.isConnected=function(){return this.connection&&this.connection.connection&&"connected"===this.connection.connection.state},i.prototype.connectToReturnOrOnline=function(e){if(window.LIVECHAT_SUPPORT)return e&&e();this.chat.id&&!this.chat.closed?this.subscribeConversationChannel(this.chat.id,e):0<this.visitor.getVisitCount()?this.subscribeToChannel(this.getReturnVisitorChannelName(),e):this.subscribeToChannel(this.getOnlineChannelName(),e)},i.prototype.subscribeConversationChannel=function(e,t){this.chat.ongoing=!0,this.subscribeToChannel(this.getConversationChannelName(),t),this.unSubscribeFromChannel(this.getOnlineChannelName()),this.unSubscribeFromChannel(this.getReturnVisitorChannelName())},i.prototype.subscribeToUserChannel=function(t){var e,n,r;this.visitorPrivateChannel=this.subscribeToChannel(this.getUserChannelName(),(r=this,function(){var e,n,i;return t?(r.connection.connected=!0,a.client.auxiliary.isConnected()&&r.chatView.disableLoader(),t(),void(t=null)):r.visitor.getDiconnectedFlag()?(e="siteId="+r.widget.siteId+"&vid="+r.visitor.getId()+"&c=fd",r.widget.id&&(e=e+"&widget_id="+r.widget.id),i=r.chatView.getVisitorDetails(),r.visitor.getDiconnectedFlag()&&Math.abs(new Date(r.visitor.getDiconnectedFlag())-new Date)>s.TIME.CURRENT_VISITOR_TIME_OUT&&!(0<r.visitor.getVisitCount())&&(r.visitor.incrementVisitCount(),i.isReturningVisitor=!0,n=!0),r.visitor.removeDisconnectedFlag(),o.ajax({type:"GET",url:r.widget.nodeUrl+"/visitors/getChatDataOnReconnect",data:e,dataType:"json",cache:!1,success:function(e){var t;r.connection.connected=!0,(t=e.data)&&t.closed?r.switchChannelsOnChatClose(t.chatId,function(e){e&&a.client.auxiliary.isConnected()&&setTimeout(function(){a.client.pushToServer("change_visitor_type",i)},s.TIME.CHANGE_VISITOR_TIME_OUT)}):t?t&&!t.closed&&n&&a.client.auxiliary.isConnected()&&setTimeout(function(){a.client.pushToServer("change_visitor_type",i)},s.TIME.CHANGE_VISITOR_TIME_OUT):r.connectToChannelOnChatClose(function(e){e&&a.client.auxiliary.isConnected()&&setTimeout(function(){a.client.pushToServer("change_visitor_type",i)},s.TIME.CHANGE_VISITOR_TIME_OUT)})},error:function(){window.console&&console.log&&console.log("Error while fetching chat details")}})):void 0})),this.connectToReturnOrOnline(),n=["connection accepted","join","leave","join chat room"],e=c.chain({}).extend(a.visitorEvents).omit(n).value(),this.bindEvents(e)},i.prototype.subscribeChatChannel=function(e,t){var n,i,r,o,s;if(s=!1,(n=this.connection.channel(this.getChatChannelName(e)))&&n.subscribed||(s=!0),t&&t(s),i=this.subscribeToChannel(this.getChatChannelName(e)))for(r in o=a.chatEvents)o[r],i.bind(r,a.chatEvents[r].bind(this))},i.prototype.unSubscribeFromChatChannel=function(e){this.unSubscribeFromChannel(this.getChatChannelName(e))},i.prototype.unsubscribeFromAllChannels=function(){var e,t;e=c.pluck(this.connection.channels.channels,"name"),c.each(e,(t=this,function(e){return t.unSubscribeFromChannel(e)}))},i.prototype.subscribeToChannel=function(t,e){var n,i,r;try{return(n=this.connection.channel(t))&&n.subscribed?void(e&&e()):(r=this.connection.subscribe(t),e&&(r.bind("pusher:subscription_succeeded",e),r.bind("pusher:subscription_error",e)),r)}catch(e){i=e,window.console&&console.log&&console.log("Error in while subscribing to channel -> "+t,i)}},i.prototype.unSubscribeFromChannel=function(t){var e,n;try{if((e=this.connection.channel(t))&&e.subscribed)return this.connection.unsubscribe(t)}catch(e){n=e,window.console&&console.log&&console.log("Error in while subscribing to channel -> "+t,n)}},i.prototype.switchChannelsOnChatClose=function(e,t){this.unSubscribeFromChatChannel(e),this.connection.channel(this.getUserChannelName()),this.unSubscribeFromChannel(this.getConversationChannelName()),t&&t(!1)},i.prototype.isInReturningVisitorChannel=function(e){var t,n;return n=!1,(t=this.connection.channel(this.getReturnVisitorChannelName()))&&t.subscribed&&(n=!0),n},i.prototype.connectToChannelOnChatClose=function(e){var t,n;n=this.connection.channel(this.getReturnVisitorChannelName()),t=this.connection.channel(this.getOnlineChannelName()),this.getOnlineChannelName(),0<this.visitor.getVisitCount()?n&&n.subscribed?e&&e(!1):(this.subscribeToChannel(this.getReturnVisitorChannelName()),e&&e(!0),t&&t.subscribed&&this.unSubscribeFromChannel(this.getOnlineChannelName())):t&&t.subscribed?e&&e(!1):(this.subscribeToChannel(this.getOnlineChannelName()),e&&e(!0))},i.prototype.bindEvents=function(e){var t;for(t in e)e[t],this.visitorPrivateChannel.bind(t,e[t].bind(this))},i.prototype.pushToVisitorTabs=function(e,t){this.connection.channel(this.getUserChannelName()).trigger("client-"+e,t),a.visitorEvents[e].call(this,t)},i.prototype.getReturnVisitorChannel=function(){return pusherInstance.channel(this.getReturnVisitorChannelName())},i.prototype.getReturnVisitorChannelName=function(){return"private-visitors-"+this.widget.siteId+"-return-"+this.visitor.getId()},i.prototype.getConversationChannelName=function(){return"private-visitors-"+this.widget.siteId+"-conversation-"+this.visitor.getId()},i.prototype.getOnlineChannelName=function(){return"private-visitors-"+this.widget.siteId+"-online-"+this.visitor.getId()},i.prototype.getUserChannelName=function(){return"private-"+this.widget.siteId+"-"+this.visitor.getId()},i.prototype.getChatChannelName=function(e){return"presence-chat-"+this.widget.siteId+"-"+e},i}(),a.PusherConnection=e}.call(this),function(){var o,s,a,e,i,n=function(e,t){return function(){return e.apply(t,arguments)}},r={}.hasOwnProperty,c=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};o=window.livechat,a=o.Constants,s=o.jQuery,i=o._,e=function(e){function t(e){this.receiveMessage=n(this.receiveMessage,this),this.unSubscribeFromChatChannel=n(this.unSubscribeFromChatChannel,this),this.disconnect=n(this.disconnect,this),this.bindEvents=n(this.bindEvents,this),this.appKeys=e,this.chatView=o.ChatView,this.coBrowseView=o.CoBrowseView,this.visitor=o.Visitor,this.client=o.client,t.__super__.constructor.apply(this,arguments)}return function(e,t){for(var n in t)r.call(t,n)&&(e[n]=t[n]);function i(){this.constructor=e}i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype}(t,o.Abstract),t.prototype.connect=function(t){var e,n,i;n=this.widget.siteId+":"+this.visitor.getId(),e={siteId:this.widget.siteId,authKey:n},s.ajax({type:"GET",url:this.widget.nodeUrl+"/visitors/grantPermissions",data:e,dataType:"jsonp",crossDomain:!0,jsonpCallback:"jsonpCallback",cache:!1,context:this,success:(i=this,function(e){"success"===(null!=e?e.status:void 0)&&(i.connection=PUBNUBVisitor.init({publish_key:i.appKeys.publish_key,subscribe_key:i.appKeys.subscribe_key,uuid:n,auth_key:n,instance_id:!0,ssl:!0}),i.bindCustomEvents(),i.subscribeToChatChannelGroup(function(){i.subscribeToUserChannel(t)}))}),error:function(){window.console&&console.log&&console.log("error in granting pubnub permissions")}})},t.prototype.subscribeToChatChannelGroup=function(e){var t;this.connection.channel_group_add_channel({callback:(t=this,function(){t.connection.subscribe({channel_group:t.getChatsGroupName(),message:t.receiveMessage,connect:function(){t.connection.channel_group_remove_channel({channel_group:t.getChatsGroupName(),channel:"dummy",callback:function(){}}),t.bindEvents(o.chatEvents),e&&e()}})}),error:function(e){window.console&&console.log&&console.log("Error creating group ",e)},channel:"dummy",channel_group:this.getChatsGroupName()})},t.prototype.bindEvents=function(e){var t;for(t in e)e[t],this.connection.events.list[t]||this.connection.events.bind(t,e[t].bind(this))},t.prototype.subscribeToUserChannel=function(e){var r,t,n;this.connection.subscribe({channel:this.getUserChannelName(),heartbeat:60,callback:this.receiveMessage,connect:this.onUserChannelSubscriptionSuccess((n=this,function(){if(window.LIVECHAT_SUPPORT)return e&&e();n.connectToReturnOrOnline(e)})),disconnect:(t=this,function(){t.connection.connected=!1,t.visitor.setDisconnectedFlag()}),reconnect:(r=this,function(){var e,n,i;e="siteId="+r.widget.siteId+"&vid="+r.visitor.getId()+"&c=fd",r.widget.id&&(e=e+"&widget_id="+r.widget.id),i=r.chatView.getVisitorDetails(),Math.abs(new Date(r.visitor.getDiconnectedFlag())-new Date)>a.TIME.CURRENT_VISITOR_TIME_OUT&&!(0<r.visitor.getVisitCount())&&(r.visitor.incrementVisitCount(),i.isReturningVisitor=!0,n=!0),s.ajax({type:"GET",url:r.widget.nodeUrl+"/visitors/getChatDataOnReconnect",data:e,dataType:"json",cache:!1,success:function(e){var t;r.connection.connected=!0,(t=e.data)&&t.closed?r.switchChannelsOnChatClose(t.chatId,function(e){e&&o.client.auxiliary.isConnected()&&setTimeout(function(){o.client.pushToServer("change_visitor_type",i)},a.TIME.CHANGE_VISITOR_TIME_OUT)}):t?t&&!t.closed&&n&&o.client.auxiliary.isConnected()&&setTimeout(function(){o.client.pushToServer("change_visitor_type",i)},a.TIME.CHANGE_VISITOR_TIME_OUT):r.connectToChannelOnChatClose(function(e){e&&o.client.auxiliary.isConnected()&&setTimeout(function(){o.client.pushToServer("change_visitor_type",i)},a.TIME.CHANGE_VISITOR_TIME_OUT)})},error:function(){window.console&&console.log&&console.log("Error while fetching chat details")}})}),error:function(e){window.console&&console.log&&console.log("error subscribe channel user id",e)}})},t.prototype.onUserChannelSubscriptionSuccess=function(e){var t,n;o.client.auxiliary.isConnected()&&this.chatView.disableLoader(),this.connection.connected=!0,n=["connection accepted","join","leave","join chat room"],t=i.chain({}).extend(o.visitorEvents).omit(n).value(),this.bindEvents(t),e&&e()},t.prototype.disconnect=function(){this.connection.unsubscribe({channel:this.connection.get_subscribed_channels(),channel_group:this.getChatsGroupName()}),this.connection.connected=!1},t.prototype.isConnected=function(){var e;return null!=(e=this.connection)?e.connected:void 0},t.prototype.connectToReturnOrOnline=function(e){this.chat.id&&!this.chat.closed?this.subscribeConversationChannel(this.chat.id,e):0<this.visitor.getVisitCount()?this.subscribeToChannel(this.getReturnVisitorChannelName(),e):this.subscribeToChannel(this.getOnlineChannelName(),e)},t.prototype.connectToChannelOnChatClose=function(e){var t,n,i;if(window.LIVECHAT_SUPPORT)return e&&e(!1);i=this.connection.get_subscribed_channels(),t=this.getOnlineChannelName(),0<this.visitor.getVisitCount()?(n=this.getReturnVisitorChannelName(),c.call(i,n)<0?(this.subscribeToChannel(this.getReturnVisitorChannelName(),function(){return e&&e(!0)}),0<=c.call(i,t)&&this.unSubscribeFromChannel(this.getOnlineChannelName())):e&&e(!1)):c.call(i,t)<0?this.subscribeToChannel(this.getOnlineChannelName(),function(){return e&&e(!0)}):e&&e(!1)},t.prototype.subscribeConversationChannel=function(e,t){var n,i,r,o;this.chat.ongoing=!0,o=this.connection.get_subscribed_channels(),n=this.getConversationChannelName(),0<=c.call(o,n)?t&&t():this.connection.subscribe({channel:this.getConversationChannelName(),state:{chatId:e},heartbeat:60,connect:function(){t&&t()},callback:this.receiveMessage,error:function(e){window.console&&console.log&&console.log("error subscribe channel user id",e),t&&t()}}),i=this.getOnlineChannelName(),0<=c.call(o,i)&&this.unSubscribeFromChannel(this.getOnlineChannelName()),r=this.getReturnVisitorChannelName(),0<=c.call(o,r)&&this.unSubscribeFromChannel(this.getReturnVisitorChannelName())},t.prototype.subscribeChatChannel=function(n){var t,i;this.connection.channel_group_list_channels({channel_group:this.getChatsGroupName(),callback:(i=this,function(e){var t;t=i.getChatChannelName(n),c.call(e.channels,t)<0?i.connection.channel_group_remove_channel({channel_group:i.getChatsGroupName(),channels:e.channels,callback:function(){return i.connection.state({channel:i.getConversationChannelName(),state:{chatId:n}}),i.connection.channel_group_add_channel({channel_group:i.getChatsGroupName(),channel:t})}}):console.log("The chat channel("+t+") is already present in the channel group(@getChatsGroupName()) - ",e)}),error:(t=this,function(e){console.log("Error while getching the channel group list of channels ",e),t.connection.channel_group_add_channel({channel_group:t.getChatsGroupName(),channel:t.getChatChannelName(n)})})})},t.prototype.unSubscribeFromChatChannel=function(e){this.connection.channel_group_remove_channel({channel_group:this.getChatsGroupName(),channel:this.getChatChannelName(e),callback:function(){}})},t.prototype.unsubscribeFromAllChannels=function(){this.connection.unsubscribe({channel:[this.getConversationChannelName(),this.getReturnVisitorChannelName(),this.getOnlineChannelName(),this.getUserChannelName()]})},t.prototype.receiveMessage=function(e,t,n){4===this.widget.debug&&console.log("Received message ---\x3e ",e,t,n),this.connection.events.fire(e.type,e.data)},t.prototype.subscribeToChannel=function(t,n){var i,e;try{e=this.connection.get_subscribed_channels(),0<=c.call(e,t)?n&&n():this.connection.subscribe({channel:t,callback:this.receiveMessage,heartbeat:60,connect:function(){n&&n()},error:function(e){window.console&&console.log&&console.log("error subscribe channel user id",e),n&&n()}})}catch(e){i=e,window.console&&console.log&&console.log("Error in while subscribing to channel -> "+t,i)}},t.prototype.unSubscribeFromChannel=function(t){var n;try{this.connection.unsubscribe({channel:t})}catch(e){n=e,window.console&&console.log&&console.log("Error in while subscribing to channel -> "+t,n)}},t.prototype.isInReturningVisitorChannel=function(e){var n,i;n=!1,this.connection.where_now({uuid:this.widget.siteId+":"+this.visitor.getId(),callback:(i=this,function(e){var t;return t=i.getReturnVisitorChannelName(),0<=c.call(e,t)&&(n=!0),n}),error:function(e){return n}})},t.prototype.switchChannelsOnChatClose=function(e,t){var n;this.unSubscribeFromChatChannel(e),n=this.getConversationChannelName(),0<=c.call(this.connection.get_subscribed_channels(),n)&&this.unSubscribeFromChannel(this.getConversationChannelName()),t&&t(!1)},t.prototype.pushToVisitorTabs=function(e,t){return this.connection.publish({channel:this.getUserChannelName(),message:{type:e,data:t}})},t.prototype.getReturnVisitorChannelName=function(){return this.widget.siteId+".presence:return"},t.prototype.getConversationChannelName=function(){return this.widget.siteId+".presence:conversation"},t.prototype.getOnlineChannelName=function(){return this.widget.siteId+".presence:online"},t.prototype.getUserChannelName=function(){return this.widget.siteId+"."+this.visitor.getId()+".private"},t.prototype.getChatChannelName=function(e){return this.widget.siteId+"."+e+".chat"},t.prototype.getChatsGroupName=function(){return this.widget.siteId+":"+this.visitor.getId()+".chat"},t}(),o.PubNubConnection=e}.call(this),function(){var i,e,r,o=function(e,t){return function(){return e.apply(t,arguments)}},s={}.hasOwnProperty;(i=window.livechat).Constants,i.jQuery,r=i._,e=function(e){function t(e,t,n){switch(this.connectAuxiliaryClient=o(this.connectAuxiliaryClient,this),this.connectPrimaryClient=o(this.connectPrimaryClient,this),this.connect=o(this.connect,this),this.visitor=i.Visitor,this.widget=i.Widget,this.chat=i.Chat,this.chatView=i.ChatView,this.coBrowseView=i.CoBrowseView,this.appKeys=n,e){case"pubnub":this.primary=new i.PubNubConnection(this.appKeys);break;case"pusher":this.primary=new i.PusherConnection(this.appKeys)}switch(t){case"socket":this.auxiliary=new i.SocketConnection}}return function(e,t){for(var n in t)s.call(t,n)&&(e[n]=t[n]);function i(){this.constructor=e}i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype}(t,i.EventEmitter),t.prototype.connect=function(e){this.chatView.enableLoader(),this.bindGlobalListener(),this.isPrimaryClientConnected()?this.connectAuxiliaryClient():this.connectPrimaryClient(this.connectAuxiliaryClient)},t.prototype.pushToServer=function(e,t){this.auxiliary.pushToServer(e,t)},t.prototype.isConnected=function(){return this.primary.isConnected()&&this.auxiliary.isConnected()},t.prototype.connectPrimaryClient=function(e){this.primary.connect(e)},t.prototype.connectAuxiliaryClient=function(e){this.auxiliary.connect(e)},t.prototype.isPrimaryClientConnected=function(){return this.primary.isConnected()},t.prototype.isAuxiliaryClientConnected=function(){return this.auxiliary.isConnected()},t.prototype.disconnect=function(){this.disconnectPrimaryClient(),this.disconnectAuxiliaryClient()},t.prototype.disconnectPrimaryClient=function(){this.primary.disconnect()},t.prototype.disconnectAuxiliaryClient=function(){this.auxiliary.disconnect()},t.prototype.getAuxiliarySocketId=function(){return this.auxiliary.getSocketId()},t.prototype.bindGlobalListener=function(){var n;this.addGlobalListener((n=this,function(){var e,t;e=arguments[0],t=r.rest(arguments),n.primary.trigger(e,t),n.auxiliary.trigger(e,t)}))},t}(),i._Client=e}.call(this),function(){var l,u,r,e,h,t=function(e,t){return function(){return e.apply(t,arguments)}};l=window.livechat,r=l.Constants,u=l.jQuery,h=l._,e=function(){function e(){this.showTyping=t(this.showTyping,this),this.triggerTyping=t(this.triggerTyping,this),this.postChatConnectedEvents=t(this.postChatConnectedEvents,this),this.visitor=l.Visitor,this.widget=l.Widget,this.chat=l.Chat,this.pageTitle=document.title,this.titleTimer=null,this.chatExpireTimer=null,this.reason=null,this.close="#lc-close",this.endChatPopUp=".lc-end-chat",this.forceMinimized=!1}return e.prototype.initialize=function(){this.isMobileBrowser=l.MainView.isMobileBrowser},e.prototype.connect=function(){this.enableInputContainer(),this.visitor.stopAutoConnectTimer(),this.visitor.startForceDisconnectTimer(r.TIME.FORCE_DISCONNECT),this.visitor.connectionRequest(),this.enableClose()},e.prototype.postChatConnectedEvents=function(t){var n;this.chat.id=t.chatId||t.id,this.chat.agentId=t.agentId,this.chat.agentNetworkDisconnected=!1,this.chat.agentDisconnected=!1,this.chat.closed=!1,t.agentName&&this.setAgentName(t.agentName),this.chatExpireTimerOff(),this.stopMoreWaitingTimer(),this.stopNonAvailabilityTimer(),l.OfflineView.stopOfflineSubmitTimer(),this.chat.setAgentProfilePicture(),(this.widget.offlineChat&&!l.OfflineView.messageSent||this.widget.preChatForm)&&(this.widget.offlineChat=!1,u("#lc_chat_layout").addClass("lc-chat").removeClass("lc-prechat lc-offline"),u("#lc_chat_title").html(this.getTitle())),u("#lc-close").removeClass("hide"),t.visitorClosedChat?this.disableClose():this.enableClose(),this.chat.loadTranscript&&(this.chat.loadTranscript=!1,this.disableInputContainer(),this.chat.fetchTranscript((n=this,function(e){(null!=e?e.data:void 0)&&n.updateTranscript(e.data,t.closed),n.enableInputContainer(),n.sendPingMessages()})))},e.prototype.updateTranscript=function(e,t){var n,i,r,o,s,a,c;if(0<(s=(r=u("#lc_chat_message_window")).find("p")).length&&s.remove(),o=e.history,!((c=h(o).sortBy(function(e){return+new Date(e.createdAt)})).length<0)){for(t&&this.isMaximized()||this.isMobileBrowser?this.collapse():!t&&this.isMinimized()&&this.expand(!1),this.clearNotifications(),n=0,i=c.length;n<i;n++)(a=c[n]).content=a.msg,r.append(h.template(l.templates.message,{message:this.prepareMessage(a)}));r.scrollTop(r.get(0).scrollHeight)}},e.prototype.sendPingMessages=function(){var t,e,n,i;i=this.chat.pings,t=!1,0<i.length&&(n={},0<(e=(e=u.map(i,function(e){if(e.fromMsg&&(t=!0,delete e.fromMsg),(null!=e?e.pingCreatedAt:void 0)&&(n.pingCreatedAt=e.pingCreatedAt),null!=e?e.msg:void 0)return e.msg}).join("\n")).replace(/^(\r?\n|\r)/g,"")).length&&(n.msg=e),this.chat.pings=[],this.sendMessageOrPing(n,!t))},e.prototype.sendMessageOrPing=function(e,t){l.client.isConnected()?(this.chat.visitorClosedChat&&(e.visitorClosedChat=!0,e.agentId=this.chat.agentId),this.chat.isActive()&&!t?(this.chat.sendMessage(e.msg),this.addMessage({name:this.widget.me,content:e.msg})):(t?this.sendPing(e,t):this.sendPing(e),e.msg&&this.addMessage({name:this.widget.me,content:e.msg})),this.chat.visitorClosedChat=!1):(e.fromMsg=!0,this.chat.pings.push(e),l.client.connect())},e.prototype.sendPing=function(e,t){var n,i;this.chat.pingSent=!0,this.startWaitingMessageAndTimer(),this.startNonAvailabilityTimer(),n=this.getVisitorDetails(),this.chat.pushToCachedPing(!t||n.isProactive?e.msg:null,n.isProactive),n.msg=e.msg,n.detailsFromPreChatForm=null!=(i=e.detailsFromPreChatForm)&&i,n.visitorLimitReached=this.widget.visitorLimitReached,l.client.pushToServer("visitor ping",n)},e.prototype.showWelcomeMessage=function(){0<u("#lc_chat_message_window .lc_welcome_message").length||0<u("#lc_chat_message_window .lc-msg-block").length||this.addDefaultMessage(this.widget.welcomeMessage,"welcome")},e.prototype.getVisitorDetails=function(){var e,t,n,i,r;return r=this.visitor.getName()||this.visitor.getId(),n=null!=(i=this.visitor.session)?i.location:void 0,window.LIVECHAT_SUPPORT?(e=this.visitor.getSupportDropdown(),t=!0):e=this.visitor.getDropdown(),e&&(e=this.escapeSpecialCharacters(e)),{name:r,email:this.visitor.getEmail(),phone:this.visitor.getPhone(),textfield:this.visitor.getTextfield(),dropdown:e,widget_name:this.widget.name,isProactive:this.chat.proactive,location:n,returnVisitor:this.visitor.isReturnVisitor(),title:document.title,appSupport:t}},e.prototype.escapeSpecialCharacters=function(e){return(e||"").replace(/\(/g,"&#40;").replace(/\)/g,"&#41;")},e.prototype.addMessageReceivedAt=function(e,t){u("#"+e).attr("actualReceivedAt",t)},e.prototype.addMessage=function(e,t){var n;u(this.endChatPopUp).hasClass("hide")||(u(this.endChatPopUp).addClass("hide"),u(this.close).removeAttr("disabled",!0),u(this.close).css("pointer-events","auto")),e.id&&this.chat.isADuplicateMessage(e)||(this.chat.addMessageToHistory(e),this.clearNotifications(),t||(e.content=l.MainView.escapeHtml(e.content)),e=this.prepareMessage(e),n=u("#lc_chat_message_window"),"lc-guest"===e.class&&l.isMobileBrowser&&u("#lc_chat_input_container").blur(),n.append(h.template(l.templates.message,{message:e})),this.agentDisconnectTimer&&this.showAgentDisconnectMessage(this.widget.agentNetworkDisconnectMessage),n.scrollTop(n.get(0).scrollHeight))},e.prototype.addDefaultMessage=function(e,t){var n,i;i=!(n="lc-guest"),"welcome"===t&&(n+=" lc_welcome_message"),"non availability"===t&&(i=!0),this.addMessage({content:e,class:n,createdAt:new Date},i)},e.prototype.addNotification=function(e,t){var n,i;this.clearNotifications(),i={content:e,class:t?"lc-notification-message lc-nm-active":"lc-notification-message",id:"lc_notification_message"},(n=u("#lc_chat_message_window")).append(h.template(l.templates.notification,{notification:i})),n.scrollTop(n.get(0).scrollHeight)},e.prototype.clearNotifications=function(){u("#lc_chat_message_window").find("#lc_notification_message").remove()},e.prototype.addPresistNotification=function(e){var t,n;this.clearNotifications(),n={content:e,class:"lc-notification-message",id:"lc_presist_message"},(t=u("#lc_chat_message_window")).append(h.template(l.templates.notification,{notification:n})),t.scrollTop(t.get(0).scrollHeight)},e.prototype.prepareMessage=function(e){return e.time=l.DateFormatter.format(new Date(e.createdAt||new Date),"hh:MM TT"),e.class||(e.class=e.userId&&0!==e.userId.search("visitor")?"lc-guest":"lc-self"),"typing"!==e.type&&(e.content=l.Autolinker.link(e.content.replace(/\n/g,"<br>"))),e},e.prototype.startWaitingMessageAndTimer=function(){var e;this.moreWaitingTimer||(e=r.TIME.WAIT_MESSAGE,this.chat.cachedPingTime&&(e=(e-=(new Date).getTime()-this.chat.cachedPingTime)<0?0:e),this.startMoreWaitingTimer(e))},e.prototype.startMoreWaitingTimer=function(e){var t;this.moreWaitingTimer||this.widget.moreWaitingMessage&&(this.moreWaitingTimer=setTimeout((t=this,function(){t.addDefaultMessage(t.widget.moreWaitingMessage)}),e))},e.prototype.stopMoreWaitingTimer=function(){clearTimeout(this.moreWaitingTimer),this.moreWaitingTimer=null},e.prototype.startNonAvailabilityTimer=function(){var e,t;this.nonAvailabilityTimer||(e=r.TIME.NON_AVAILABILITY,this.chat.cachedPingTime&&(t=(new Date).getTime()-this.chat.cachedPingTime,e-=(new Date).getTime()-this.chat.cachedPingTime,t<0&&(e+=t),e<0&&(e=0)),this.nonAvailabilityTimer=setTimeout(this.showNonAvailabilityMessage.bind(this),e))},e.prototype.showNonAvailabilityMessage=function(){this.chat.missed=!0,this.widget.nonAvailabilityCustomLink?(this.disableInputContainer(),this.addDefaultMessage(this.widget.nonAvailabilityMessage,"non availability"),this.setTitle(this.widget.offlineChatSettings.messages.title),l.OfflineView.sendOfflineChatEvent(null,!1),this.chat.removeCachedPing()):l.OfflineView.render(!0)},e.prototype.stopNonAvailabilityTimer=function(){clearTimeout(this.nonAvailabilityTimer),this.nonAvailabilityTimer=null},e.prototype.updateWaitingAndNonAvailabilityTimers=function(e){e.status||("unavailable in groups"===e.reason||"agents unavailable"===e.reason?(this.reason="agents_unavailable",this.stopNonAvailabilityTimer(),this.showNonAvailabilityMessage(),this.chat.missed=!1):"Chat limit reached for agents in routed groups"!==e.reason&&"Chat limit reached for all agents"!==e.reason||"agents_limit_reached"!==this.reason&&(this.reason="agents_limit_reached",this.stopMoreWaitingTimer(),this.startMoreWaitingTimer(0)))},e.prototype.disableClose=function(){if(!window.LIVECHAT_SUPPORT)return u(".lc-close").attr("disabled",!0),u(".lc-close").css("pointer-events","none")},e.prototype.enableClose=function(){return u("#lc-close").removeAttr("disabled"),u("#lc-close").css("pointer-events","auto")},e.prototype.showChatClose=function(){return u("#lc-close").removeClass("hide"),this.enableClose()},e.prototype.enableInputContainer=function(){u("#lc_chat_input_container").prop("disabled",!1)},e.prototype.disableInputContainer=function(){u("#lc_chat_input_container").prop("disabled",!0)},e.prototype.enableLoader=function(){this.disableInputContainer(),u("#lc_chat_message_window p").hide(),u(".overlay-bg").show()},e.prototype.disableLoader=function(){this.enableInputContainer(),u("#lc_chat_message_window p").show(),u(".overlay-bg").hide()},e.prototype.isMinimized=function(){return u("#lc_chat_layout").hasClass("lc-collapsed")},e.prototype.isMaximized=function(){return u("#lc_chat_layout").hasClass("lc-expanded")},e.prototype.getTitle=function(){var e,t;return t=this.chat.active&&!this.chat.closed?this.chat.getAgentName():this.widget.title,this.widget.offlineChat&&(e=this.widget.offlineChatSettings.messages,t=l.OfflineView.messageSent?e.thank_header:e.title),t},e.prototype.setTitle=function(e){var t,n;n=u("#lc_chat_layout").find("#lc_chat_title"),t=e||this.getTitle(),n.html(t)},e.prototype.setAgentName=function(e){this.chat.setAgentName(e),this.setTitle()},e.prototype.clearAgentName=function(){this.chat.clearAgentName(),this.setTitle()},e.prototype.triggerTyping=function(){var e;this.triggerTypingTimer||(l.client.pushToServer("typing",{id:this.chat.id,userId:this.visitor.getId()}),this.triggerTypingTimer=setTimeout((e=this,function(){e.triggerTypingTimer=null}),r.TIME.TYPING))},e.prototype.showTyping=function(e){var t,n;t={createAt:new Date,photo:e.photo,name:e.name,type:"typing",class:"lc-guest"},u(this.endChatPopUp).hasClass("hide")||(u(this.endChatPopUp).addClass("hide"),u(this.close).removeAttr("disabled",!0),u(this.close).css("pointer-events","auto")),0===u(".lc-typing-dots").length&&(this.addMessage(t),this.typingTimer=setTimeout((n=this,function(){n.hideTyping()}),r.TIME.TYPING))},e.prototype.hideTyping=function(){this.typingTimer&&(clearTimeout(this.typingTimer),this.typingTimer=null),u("#lc_chat_message_window .lc-typing-dots").closest("p").remove()},e.prototype.agentConnected=function(e){this.setAgentName(e.agentName),u("#lc_chat_header").removeClass("lc-inactive"),this.clearNotifications(),this.agentDisconnectTimer&&this.stopAgentDisconnectTimer(),this.stopAgentNetworkDisconnectTimer()},e.prototype.agentDisconnected=function(e){var t;this.showAgentDisconnectMessage(this.widget.agentNetworkDisconnectMessage),u("#lc_chat_header").addClass("lc-inactive"),this.agentDisconnectTimer||(this.agentDisconnectTimer=setTimeout((t=this,function(){t.chat.agentDisconnected=!0,t.agentDisconnectTimer=null}),r.TIME.AGENT_LEFT))},e.prototype.agentNetworkDisconnected=function(e){var t;this.showAgentDisconnectMessage(this.widget.agentNetworkDisconnectMessage),this.stopAgentDisconnectTimer(),this.stopAgentNetworkDisconnectTimer(),u("#lc_chat_header").addClass("lc-inactive"),this.agentNetworkDisconnectTimer||(this.agentNetworkDisconnectTimer=setTimeout((t=this,function(){e.agentId=t.chat.agentId,t.chat.agentNetworkDisconnected=!0}),r.TIME.AGENT_NETWORK_DISCONNECT))},e.prototype.stopAgentDisconnectTimer=function(){this.agentDisconnectTimer&&(clearTimeout(this.agentDisconnectTimer),this.agentDisconnectTimer=null,this.chat.agentDisconnected=!1)},e.prototype.stopAgentNetworkDisconnectTimer=function(){this.agentNetworkDisconnectTimer&&(clearTimeout(this.agentNetworkDisconnectTimer),this.agentNetworkDisconnectTimer=null)},e.prototype.agentNetworkConnected=function(e){u("#lc_chat_header").removeClass("lc-inactive"),u("#lc_agent_left_msg").remove(),this.stopAgentNetworkDisconnectTimer()},e.prototype.chatExpireTimerOn=function(e,t){var n,i;this.chatExpireTimer||(n=e&&0<=e?e:r.TIME.CHAT_EXPIRE,this.chatExpireTimer=setTimeout((i=this,function(){i.chat.id=null,i.chat.active=!1,i.chat.agentNameCached=null,i.clearAgentName()}),n))},e.prototype.chatExpireTimerOff=function(){clearTimeout(this.chatExpireTimer),this.chatExpireTimer=null,this.chat.active=!0,this.chat.agentNameCached=null},e.prototype.closeSupport=function(){return this.widget.offlineChat&&(this.widget.offlineChat=!1),l.CoBrowseView.setLocalStorage("livechat_support","false"),u("#lc_cb_actions_vi").remove(),u("#lc_chat_layout").remove()},e.prototype.closeChat=function(e){var t;this.chat.ongoing&&(this.chat.isInActive()?(t={type:"visitor",userId:e.agentId,siteId:this.widget.siteId,chatId:e.chatId,visitorId:this.visitor.getId(),fromVisitor:!0,closed:!0,url:this.widget.siteUrl,closeByVistior:!0},l.client.pushToServer("visitor endchat",t)):e.closeByVistior&&((t=e).closed=!0,l.client.pushToServer("visitor endchat",t))),window.LIVECHAT_SUPPORT&&(this.closeSupport(),l.client&&l.client.primary&&l.client.primary.pushToVisitorTabs("force disconnect",{force_disconnect:!0}),this.visitor.resetVisitor(),this.widget.resetWidget(),this.chat.resetChat(),l.Sound.resetSound(),l.ChatView.resetChatView(),l.OfflineView.resetOfflineView(),l.CoBrowseView.resetCoBrowseView(),l.MainView.resetMainView())},e.prototype.postChatCloseEvents=function(e){var t;t=null,this.chat.ongoing=!1,this.chat.closed=!0,e.emptyChat&&(t=0),this.chat.agentNameCached=this.chat.getAgentName(),this.chatExpireTimerOn(t),this.chat.agentNetworkDisconnected?(this.chat.id="",this.showAgentLeftMessage(this.widget.agentDisconnectedMessage,e.CbActive),this.disableClose()):this.chat.agentDisconnected?this.disableClose():e.visitorClosedChat||e.isClosedByVisitor||(this.widget.thanksMessage&&this.addDefaultMessage(this.widget.thanksMessage),this.disableClose()),e.visitorClosedChat&&(u(".lc-end-chat").addClass("hide"),u("#lc_chat_message_window").empty(),this.disableClose(),this.collapse(),this.chat.visitorClosedChat=!0),this.setTitle(),this.chat.clearAgentProfilePicture()},e.prototype.showAgentLeftMessage=function(e,t){var n,i;n=e||this.widget.agentLeftMessage,t?this.addNotification(livechat.defaultMessages.cobrowsing_stop_msg):n&&(i=this.chat.getAgentName(),n=(n=n.replace("{{agent_name}}",i).replace("$",i)).replace("{{helpdesk_name}}",this.widget.helpdeskName||""),this.addNotification(n))},e.prototype.showAgentDisconnectMessage=function(e){var t;return t=this.chat.getAgentName(),e=(e=e.replace(/{{agent_name}}/g,t).replace("$",t)).replace(/{{helpdesk_name}}/g,this.widget.helpdeskName||""),u("#lc_agent_profile_pic,#lc_chat_title").addClass("inactive"),this.addNotification(e,!0)},e.prototype.showChatTransferredMessage=function(){var e,t;(e=this.widget.trasferredMessage)&&(t=this.chat.getAgentName(),e=(e=e.replace("{{agent_name}}",t).replace("$",t)).replace("{{helpdesk_name}}",this.widget.helpdeskName||""),this.addPresistNotification(e))},e.prototype.expand=function(e){var t,n,i,r,o;r=u("#lc_chat_layout"),n=u("#lc_chat_container"),i=u("#lc_chat_header"),e&&!window.LIVECHAT_SUPPORT?(t="lc-expanded lc-prechat",o="lc-collapsed lc-alert lc-chat lc-offline",r.find("#lc_prechat_form").length||(l.MainView.renderPreChatForm(),l.MainView.registerPreChatFormDOMEvents(),l.MainView.registerCoBrowseDOMEvents()),u("#lc-close").addClass("hide")):this.widget.offlineChat?(t="lc-expanded lc-offline",o="lc-collapsed lc-alert lc-prechat lc-chat",u("#lc-close").addClass("hide")):(t="lc-expanded lc-chat",o="lc-collapsed lc-alert lc-prechat lc-offline"),this.isChatInProgress(),r.removeClass(o).addClass(t),this.isMobileBrowser||this.isSmallWindow()||r.css("height",n.outerHeight()+i.outerHeight()+"px"),this.setTitle(),this.chat.cachedPing||this.widget.offlineChat||this.showWelcomeMessage(),u(":focus").is("input")||l.isMobileBrowser||this.setInputElementFocus(),window.LIVECHAT_SUPPORT&&this.showChatClose()},e.prototype.collapse=function(){var e,t;t=u("#lc_chat_layout"),e=u("#lc_chat_header"),t.removeClass("lc-expanded "+this.blinkStyle()).addClass("lc-collapsed"),this.isChatInProgress(),this.isMobileBrowser||this.isSmallWindow()||t.css("height",e.outerHeight()+"px"),this.setTitle()},e.prototype.blinkStyle=function(){return this.isMobileBrowser?"lc-alert-mobile":"lc-alert"},e.prototype.setInputElementFocus=function(){var e,t;t=u("#lc_chat_"+(this.offline?"name":"offline_name")),e=t.length?t.attr("id"):"lc_chat_input_container",setTimeout(function(){u("#"+e).focus()},600)},e.prototype.flashPageTitle=function(e,t){var n,i;n=e+": "+t,this.cancelFlashTitleTimer(),this.titleTimer=setInterval((i=this,function(){i.startFlashTitleTimer(n)}),1e3),this.isMinimized()&&u("#lc_chat_layout").addClass(this.blinkStyle()).find("#lc_chat_title").html(n)},e.prototype.cancelFlashTitleTimer=function(){clearInterval(this.titleTimer),this.titleTimer=null},e.prototype.startFlashTitleTimer=function(e){document.title=document.title===this.pageTitle?e:this.pageTitle,l.MainView.pageActive&&(document.title=this.pageTitle,this.cancelFlashTitleTimer())},e.prototype.endChat=function(){var e;return e={siteId:this.widget.siteId,userId:this.chat.agentId,username:this.chat.getAgentName(),chatId:this.chat.id,type:"visitor",participantId:this.visitor.getId(),fromVisitor:!0,url:this.widget.siteUrl,closeByVistior:!0},this.closeChat(e)},e.prototype.isChatInProgress=function(){return this.chat.isActive()&&!this.chat.closed?(u("#lc_chat_layout").addClass("lc-active"),this.enableClose()):(u("#lc_chat_layout").removeClass("lc-active"),this.disableClose())},e.prototype.resetChatView=function(){this.stopMoreWaitingTimer(),this.stopNonAvailabilityTimer(),this.stopAgentDisconnectTimer(),this.stopAgentNetworkDisconnectTimer(),l.ChatView=new e},e.prototype.isSmallWindow=function(){return u(window).width()<720},e.prototype.triggerEvent=function(e,t){var n;window.Event&&document.dispatchEvent&&((n=document.createEvent("CustomEvent")).initCustomEvent(e,!1,!0,t),document.dispatchEvent(n))},e}(),l.ChatView=new e}.call(this),function(){var l,u,i,e,n,s=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};l=window.livechat,i=l.Constants,u=l.jQuery,n=l._,e=function(){function e(){this.widget=l.Widget,this.visitor=l.Visitor,this.chat=l.Chat,this.sound=l.Sound,this.chatView=l.ChatView,this.messageSent=!1,this.chatId=null}return e.prototype.render=function(e){var t;this.widget.offlineChat=!0,window.LIVECHAT_SUPPORT||u("#lc-close").addClass("hide"),u("#lc_chat_layout").removeClass("lc-prechat lc-chat lc-offline").addClass("lc-offline"),t={nonAvailabilityMessage:this.widget.nonAvailabilityMessage,fields:this.widget.offlineChatFields},this.chat&&this.chat.cachedPing&&this.chat.cachedPing.msg&&this.chat.cachedPing.msg.length?t.msg=this.chat.cachedPing.msg.join("\n"):t.msg="",u("#lc_chat_layout #lc_chat_window").before(n.template(l.templates.offline,t)),this.chatView.setTitle(this.widget.offlineChatSettings.messages.title),this.registerWidgetDOMEvents(),this.chat.missed&&this.startOfflineSubmitTimer()},e.prototype.registerWidgetDOMEvents=function(){return u("#lc_offline_submit").on("click",(e=this,function(){e.createOfflineChat()}));var e},e.prototype.startOfflineSubmitTimer=function(){var e,t,n;this.offlineSubmitTimer||(t=0,(e=this.chat.getCachedPing())&&(t=(new Date).getTime()-(e.pingCreatedAt+2*i.TIME.WAIT_MESSAGE)),this.offlineSubmitTimer=setTimeout((n=this,function(){n.offlineSubmitTimer&&(n.sendOfflineChatEvent(null,!1),n.chat.removeCachedPing())}),i.TIME.MISSED_CHAT_FORM-t))},e.prototype.sendOfflineChatEvent=function(e,t,i){var n;(n=this.chatView.getVisitorDetails()).widgetId=this.widget.id,n.siteId=this.widget.siteId,n.id=this.visitor.getId(),n.chatType=this.chat.missed?"missed":"offline",n.createTicket=t,this.messageSent&&this.chatId&&(n.chatId=this.chatId),this.messageSent=!0,n.message=e||void 0,u.ajax({type:"POST",url:this.widget.nodeUrl+"/visitors/missedChat",data:n,dataType:"json",cache:!1,context:this,success:function(e){var t;return this.chat.active=!1,(null!=e&&null!=(t=e.data)?t.chatId:void 0)&&(this.chatId=e.data.chatId),l.client&&l.client.primary&&l.client.primary.pushToVisitorTabs("force disconnect",{force_disconnect:!0}),i(!0)},error:function(e,t,n){return window.console&&console.log&&console.log("error getting ",n,", responseText: ",e.responseText),i(!1,e.responseText)}})},e.prototype.createOfflineChat=function(){var e,n;this.validateOfflineForm()&&(this.saveOfflineFormFields(),this.chat.removeCachedPing(),this.stopOfflineSubmitTimer(),e=u("#lc_chat_offline_textarea").val(),this.sendOfflineChatEvent(e,!0,(n=this,function(e,t){return e?n.showThanksMessage():n.showErrorMessage(t)})))},e.prototype.validateOfflineForm=function(){var e,t,n,i,r,o,s,a,c;for(i={},o=!0,s=0,a=(c=u("#lc_offline_chat_form input, #lc_offline_chat_form textarea")).length;s<a;s++)if(e=c[s],n=(e=u(e)).attr("id").replace("lc_chat_offline_",""),r=u.trim(e.val()),i[n]=l.MainView.escapeHtml(r),(t=this.widget.offlineChatFields[n]).value=l.MainView.escapeHtml(r),!t.isValid()){e.addClass("lc-input-error"),o=!1;break}return o},e.prototype.saveOfflineFormFields=function(){var e,t,n,i,r,o;for(t in o=["textarea"],i=this.widget.offlineChatFields)r=(e=i[t]).name,s.call(o,r)<0&&(n="set"+e.name.charAt(0).toUpperCase()+e.name.substr(1).toLowerCase(),this.visitor[n].call(this.visitor,e.value))},e.prototype.stopOfflineSubmitTimer=function(){window.clearTimeout(this.offlineSubmitTimer=null)},e.prototype.showThanksMessage=function(){var e,t,n;t=u("#lc_chat_layout"),e=u("#lc_chat_header"),n=this.widget.offlineChatSettings.messages,u("#lc_chat_title").html(n.thank_header),u("#lc_chat_container").html("<p class='lc-offline-message'>"+n.thank+"<p>"),t.addClass("lc-thank-message"),u(".lc-thank-message").css("height",u(".lc-offline-message").outerHeight()+e.outerHeight()+"px")},e.prototype.showErrorMessage=function(e){var t,n,i,r;t=(e=JSON.parse(e)).message,i=u("#lc_chat_layout"),n=u("#lc_chat_header"),r=this.widget.offlineChatSettings.messages,u("#lc_chat_title").html(r.thank_header),u("#lc_chat_container").html("<p class='lc-offline-message'>"+t+"<p>"),i.addClass("lc-thank-message"),u(".lc-thank-message").css("height",u(".lc-offline-message").outerHeight()+n.outerHeight()+"px")},e.prototype.resetOfflineView=function(){this.stopOfflineSubmitTimer(),l.OfflineView=new e},e}(),l.OfflineView=new e}.call(this),function(){var o,s,n,e;o=window.livechat,n=o.Constants,s=o.jQuery,o._,e=function(){function e(){this.visitor=o.Visitor,this.cache=o.Cache,this.chatView=o.ChatView,this.mainView=o.MainView,this.widget=o.Widget,this.tabId=this.generateTabId(),window.addEventListener("storage",this.message_receive,!1)}return e.prototype.initialize=function(){var e;s("html").addClass("lc-cb-container-vi"),OneClickCbUtils.setCallback(function(e,t){switch(t){case"control transfer complete":return s("html").addClass("lc-cb-controlling-vi");case"Agent has given the control to you.":return s("html").removeClass("lc-cb-controlling-vi");case"control transferred to agent":case"Agent has taken the control back.":return s("html").addClass("lc-cb-controlling-vi");case"cbStop":return o.CoBrowseView.coBrowseStopped()}}),OneClickCbUtils.isCobrowseActive()&&(e="true"+(new Date).getTime(),this.setLocalStorage("cb_initiate",e),this.cobrowsingStart("cobrowsing is on"),OneClickCbUtils.master.cbMaster||s("html").addClass("lc-cb-controlling-vi")),"true"===this.getLocalStorage("CBSessionRequest")?this.requestCoBrowsingSession():"true"===sessionStorage.getItem("CBControlRequest")&&s("html").addClass("lc-cb-notify-vi ").removeClass("lc-cb-default-vi ")},e.prototype.requestCoBrowsingSession=function(e){var t;if(!this.unsupportedProtocol(e)&&(e&&e.location_protocol&&this.cache.setItem("livechat_cb_agent_protocol",e.location_protocol),!OneClickCbUtils.isCobrowseActive()&&!this.isAgentBusy()))return s("html").addClass("lc-cb-container-vi lc-cb-active-vi lc-cb-request-vi"),this.setLocalStorage("CBSessionRequest","true"),e&&e.id&&this.setLocalStorage("CBSessionRequestChatId",e.id),t=0,null!==this.getLocalStorage("CBVisitorReqStartTime")&&0!==this.getLocalStorage("CBVisitorReqStartTime")?t=Date.now()-this.getLocalStorage("CBVisitorReqStartTime"):this.setLocalStorage("CBVisitorReqStartTime",Date.now()),0<(t=n.TIME.CB_REQ_TIMEOUT-t)?this.cbTimerHandle=window.setTimeout(this.clearReq,t):(s("html").removeClass("lc-cb-active-vi lc-cb-request-vi"),o.CoBrowseView.setLocalStorage("CBSessionRequest","false"),this.setLocalStorage("CBVisitorReqStartTime",0)),this.disableCobrowsingButton()},e.prototype.clearReq=function(){var e;o.CoBrowseView.setLocalStorage("CBVisitorReqStartTime",0),OneClickCbUtils.isCobrowseActive()||(o.CoBrowseView.cbTimerHandle&&window.clearInterval(o.CoBrowseView.cbTimerHandle),s("html").removeClass("lc-cb-active-vi lc-cb-request-vi"),o.CoBrowseView.setLocalStorage("CBSessionRequest","false"),e={id:o.CoBrowseView.chatView.chat.id,userName:o.CoBrowseView.visitor.getName()||o.CoBrowseView.visitor.getId(),agentId:o.CoBrowseView.chatView.chat.agentId,photo:"/images/fillers/profile_blank_thumb.gif",inConversation:o.fc_inConversation,actualCreatedAt:(new Date).toUTCString()},o.client.chat_socket&&(e.socket=o.client.chat_socket.io.engine.id),o.client.pushToServer("cobrowse session timeout",e))},e.prototype.setLocalStorage=function(e,t){var n;if(this.getLocalStorage(e)!==t)return n={id:this.tabId,value:t},n=JSON.stringify(n),this.cache.setItem(e,n)},e.prototype.getLocalStorage=function(e){var t,n;try{if(t=this.cache.getItem(e))return JSON.parse(t).value}catch(e){n=e,console.log("parsing failed with error:",n)}return null},e.prototype.generateTabId=function(){var e;return e=OneClickCbUtils.tabId?OneClickCbUtils.tabId:OneClickCbUtils.generateId(),OneClickCbUtils.tabId=e},e.prototype.unsupportedProtocol=function(e){var t,n;return(n=void 0!==e&&"https:"===e.location_protocol&&e.location_protocol!==window.location.protocol)&&(t={id:this.chatView.chat.id,userName:this.visitor.getName()||this.visitor.getId(),agentId:this.chatView.chat.agentId,photo:"/images/fillers/profile_blank_thumb.gif",inConversation:o.fc_inConversation,actualCreatedAt:(new Date).toUTCString()},o.client.chat_socket&&(t.socket=o.client.chat_socket.io.engine.id),this.setLocalStorage("CBSessionRequest","false"),o.client.pushToServer("cobrowse upsupported protocol",t)),n},e.prototype.isAgentBusy=function(){var e,t;return(e="true"===sessionStorage.getItem("CBActive")||"PENDING"===sessionStorage.getItem("CBRequest"))&&(t={id:this.chatView.chat.id,userName:this.visitor.getName()||this.visitor.getId(),agentId:this.chatView.chat.agentId,photo:"/images/fillers/profile_blank_thumb.gif",inConversation:o.fc_inConversation,actualCreatedAt:(new Date).toUTCString()},o.client.chat_socket&&(t.socket=o.client.chat_socket.io.engine.id),this.setLocalStorage("CBSessionRequest","false"),o.client.pushToServer("cobrowse agent busy",t)),e},e.prototype.cobrowsingRequestAccepted=function(){return this.chatView.addNotification(livechat.defaultMessages.cobrowsing_start_msg),this.cobrowsingStart(),this.sendCoBrowseLink(this.getCobrowseLink()),s("html").removeClass("lc-cb-request-vi"),s("html").addClass("lc-cb-default-vi lc-cb-controlling-vi"),createCanvas("cb-block-canvas","99990","block"),chatjQuery("#cb-block-canvas").show(),this.setLocalStorage("CBSessionRequest","false")},e.prototype.cobrowsingRequestDenied=function(){return this.coBrowseSessionRejected(),s("html").removeClass("lc-cb-active-vi lc-cb-request-vi lc-cb-controlling-vi"),this.enableCobrowsingButton()},e.prototype.cobrowsingStart=function(){var e,t,n,i;return t=this.visitor.name||this.cache.getItem("livechat_vname"),this.chatView.agentName||this.cache.getItem("livechat_agent_name"),i=this.widget.siteId,e=this.getLocalStorage("CBSessionRequestChatId")||this.chatView.chat.id,n=sessionStorage.getItem("cbSdata")||this.widget.sessionHash,OneClickCbUtils.cobrowsingStart(t,"visitor",0,n,i,e),OneClickCbUtils.callBack("info","started"),s("html").addClass("lc-cb-container-vi lc-cb-active-vi lc-cb-default-vi "),this.disableCobrowsingButton()},e.prototype.cobrowsingEnd=function(e){if("true"===this.getLocalStorage("CBSessionRequest")&&this.cobrowsingRequestDenied(),OneClickCbUtils.isCobrowseActive())return OneClickCbUtils.cobrowsingEnd(),this.coBrowseStopped(e)},e.prototype.getCobrowseLink=function(){return OneClickCbUtils.getCobrowseLink()},e.prototype.takeControl=function(){OneClickCbUtils.takeControl()?alert("now you are in control of page"):alert("Sorry, you are not master or cobrowsing hasn't been started yet")},e.prototype.giveControl=function(){OneClickCbUtils.giveControl()?OneClickCbUtils.callBack("info","GIVE CONTROL"):OneClickCbUtils.callBack("info","CONTROL GIVEN")},e.prototype.sendCoBrowseLink=function(e){return this.coBrowseStarted(e)},e.prototype.coBrowseStarted=function(e){var t;return t={id:this.chatView.chat.id,userName:this.visitor.getName()||this.visitor.getId(),photo:"/images/fillers/profile_blank_thumb.gif",inConversation:o.fc_inConversation,agentId:this.chatView.chat.agentId,actualCreatedAt:(new Date).toUTCString(),signal:"started",roomName:OneClickCbUtils.getRoom(),coBrowsingURL:e},o.client.chat_socket&&(t.socket=o.client.chat_socket.io.engine.id),o.client.pushToServer("cobrowse started",t)},e.prototype.coBrowseStopped=function(e){var t;return this.cleanUpView(),this.enableCobrowsingButton(),t={id:this.chatView.chat.id,userName:this.visitor.getName()||this.visitor.getId(),agentId:this.chatView.chat.agentId,photo:"/images/fillers/profile_blank_thumb.gif",inConversation:o.fc_inConversation,actualCreatedAt:(new Date).toUTCString()},o.client.chat_socket&&(t.socket=o.client.chat_socket.io.engine.id),void 0!==e&&void 0!==e.closeEvent||this.chatView.addNotification(livechat.defaultMessages.cobrowsing_stop_msg),o.client.pushToServer("cobrowse stopped",t)},e.prototype.cleanUpView=function(){return sessionStorage.removeItem("CBControlRequest"),s("html").removeClass("lc-cb-active-vi lc-cb-default-vi lc-cb-request-vi lc-cb-controlling-vi lc-cb-notify-vi")},e.prototype.coBrowseSessionRejected=function(){var e;return e={id:this.chatView.chat.id,userName:this.visitor.getName()||this.visitor.getId(),agentId:this.chatView.chat.agentId,photo:"/images/fillers/profile_blank_thumb.gif",inConversation:o.fc_inConversation,actualCreatedAt:(new Date).toUTCString()},o.client.chat_socket&&(e.socket=o.client.chat_socket.io.engine.id),this.setLocalStorage("CBSessionRequest","false"),o.client.pushToServer("cobrowse session rejected",e)},e.prototype.coBrowsingRequestCancelled=function(){var e;return s("html").removeClass("lc-cb-active-vi lc-cb-request-vi lc-cb-controlling-vi"),this.enableCobrowsingButton(),e={id:this.chatView.chat.id,userName:this.visitor.getName()||this.visitor.getId(),agentId:this.chatView.chat.agentId,photo:"/images/fillers/profile_blank_thumb.gif",inConversation:o.fc_inConversation,actualCreatedAt:(new Date).toUTCString()},o.client.chat_socket&&(e.socket=o.client.chat_socket.io.engine.id),this.chatView.addNotification(livechat.defaultMessages.cobrowsing_cancel_visitor_msg),this.setLocalStorage("CBSessionRequest","false"),o.client.pushToServer("cobrowse request cancelled",e)},e.prototype.coBrowseControlRequest=function(){if(OneClickCbUtils.isCobrowseActive())return sessionStorage.setItem("CBControlRequest",!0),s("html").addClass("lc-cb-notify-vi ").removeClass("lc-cb-default-vi ")},e.prototype.denyCBSessionControl=function(){var e;return s("html").removeClass("lc-cb-notify-vi ").addClass("lc-cb-default-vi "),sessionStorage.removeItem("CBControlRequest"),e={id:this.chatView.chat.id,userName:this.visitor.getName()||this.visitor.getId(),agentId:this.chatView.chat.agentId,photo:"/images/fillers/profile_blank_thumb.gif",inConversation:o.fc_inConversation,actualCreatedAt:(new Date).toUTCString()},o.client.chat_socket&&(e.socket=o.client.chat_socket.io.engine.id),o.client.pushToServer("cobrowse control rejected",e)},e.prototype.allowRequestedControl=function(){return s("html").removeClass("lc-cb-notify-vi ").addClass("lc-cb-default-vi "),sessionStorage.removeItem("CBControlRequest"),this.giveControl()},e.prototype.parseEvent=function(e){var t,n,i;try{return i=o.Cache.decode(e),(n=JSON.parse(i))?n.id===o.CoBrowseView.tabId?"same_tab":n.value:"null"}catch(e){return t=e,console.log("livechat error:",t),"null"}},e.prototype.message_receive=function(e){var t,n,i,r;if("CBSessionRequest"===e.key)"null"!==(t=o.CoBrowseView.parseEvent(e.newValue))&&"false"!==t||s("html").removeClass("lc-cb-active-vi lc-cb-request-vi lc-cb-controlling-vi");else if("livechat_support"===e.key){if(i=o.CoBrowseView.parseEvent(e.newValue),r=o.CoBrowseView.parseEvent(e.oldValue),"true"===i)return void o.MainView.render();"false"!==i&&"null"!==i||"true"!==r&&"same_tab"!==r||(o.CoBrowseView.cobrowsingEnd(),o.ChatView.endChat())}else if("cb_initiate"===e.key){if("same_tab"!==(t=o.CoBrowseView.parseEvent(e.newValue))&&OneClickCbUtils.isCobrowseActive())return n="true"+(new Date).getTime(),o.CoBrowseView.setLocalStorage("cb_initiate_stop",n)}else if("cb_initiate_stop"===e.key&&"same_tab"!==(t=o.CoBrowseView.parseEvent(e.newValue)))return o.CoBrowseView.resetCoBrowsing()},e.prototype.resetCoBrowsing=function(){if(OneClickCbUtils.isCobrowseActive())return OneClickCbUtils.cleanUpSession(),s("html").removeClass("lc-cb-active-vi lc-cb-controlling-vi lc-cb-default-vi"),this.enableCobrowsingButton()},e.prototype.disableCobrowsingButton=function(){window.LIVECHAT_SUPPORT&&s(".lc-cb-btn").addClass("disabled ")},e.prototype.enableCobrowsingButton=function(){if(window.LIVECHAT_SUPPORT)return s(".lc-cb-btn").removeClass("disabled ")},e.prototype.resetCoBrowseView=function(){o.CoBrowseView=new e},e}(),o.CoBrowseView=new e}.call(this),function(){var a,l,e,n,c=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};(a=window.livechat).Constants,l=a.jQuery,n=a._,e=function(){function e(){this.visitor=a.Visitor,this.widget=a.Widget,this.chat=a.Chat,this.chatView=a.ChatView,this.coBrowseView=a.CoBrowseView,this.offlineView=a.OfflineView,this.pageActive=!0,this.isMobileBrowser=!1,this.mainLayout="#lc_chat_layout",this.header="#lc_chat_header",this.container="#lc_chat_container",this.customWidget="#chat-widget",this.chatWindow="#lc_chat_window",this.close="#lc-close",this.closeConform="#lc-ec-ok",this.closeCanel="#lc-ec-cancel",this.endChatPopUp=".lc-end-chat"}return e.prototype.render=function(){this.visitor.initialize(),this.widget.initialize(),this.chat.initialize(),this.checkMobileBrowser(),this.chatView.initialize(),this.teamstatus(),this.coBrowseView.initialize(),this.triggerFDLCWidgetLoaded()},e.prototype.renderAgentSupport=function(){if("true"!==a.CoBrowseView.getLocalStorage("livechat_support"))return a.CoBrowseView.setLocalStorage("livechat_support","true"),this.render();this.chatView.expand(!1)},e.prototype.checkMobileBrowser=function(){var e;return e=navigator.userAgent||navigator.vendor||window.opera,this.isMobileBrowser=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4)),this.isMobileBrowser},e.prototype.teamstatus=function(e){var t,i;t="siteId="+this.widget.siteId+"&vid="+this.visitor.getId()+"&c=fd",this.widget.id&&(t=t+"&widget_id="+this.widget.id),l.ajax({type:"GET",url:this.widget.nodeUrl+"/visitors/teamstatus",data:t,dataType:"json",cache:!1,success:(i=this,function(e){var t,n;!e||e.data&&e.data.disabledOrBlocked?console.log("Chat Disabled or Visitor blocked!"):((n=e.data).isVisitorLimitReached&&(i.widget.visitorLimitReached=!0),n.setting&&i.widget.updateSettings(n.setting,n.teamstatus),n.recentChatDetails&&i.chat.setRecentChatDetails(n.recentChatDetails),i.visitor.recentChatId=null!=(t=n.recentChatDetails)?t.chatId:void 0,n.isReturnVisitor&&!i.visitor.getVisitCount()&&i.visitor.incrementVisitCount(),i.widget.hideWidget?(i.hideCustomChatWidget(),i.hideNormalChatWidget()):(i.renderWidget(),i.registerWidgetDOMEvents(),i.customChatWidgetExists()&&i.chat.isInActive()&&i.hideNormalChatWidget(),i.widget.offlineChat?(i.offlineView.render(!1),window.LIVECHAT_SUPPORT&&(i.chatView.expand(!1),i.chatView.showChatClose())):(i.registerWindowDOMEvents(),i.registerCoBrowseDOMEvents(),window.LIVECHAT_SUPPORT||(i.renderPreChatForm(),i.registerPreChatFormDOMEvents()),i.registerTextContainerDOMEvents(),a.client=new a._Client(n.primary,n.auxiliary,n.appKeys),i.chat.isActive()||i.chat.cachedPing||window.LIVECHAT_SUPPORT?(i.isMobileBrowser?i.chatView.collapse():(i.chat.ongoing||i.chat.cachedPing||window.LIVECHAT_SUPPORT)&&i.chatView.expand(!1),a.client.connect(),window.LIVECHAT_SUPPORT&&i.chatView.showChatClose()):(i.startProactiveTimer(),i.triggerEventDocument(),-1===i.widget.sitesToSkipAutoConnect().indexOf(i.widget.siteId)&&(n.isVisitorLimitReached||i.visitor.startAutoConnectTimer())))))}),error:function(){window.console&&console.log&&console.log("Error while fetching agent's availability status")}})},e.prototype.startProactiveTimer=function(){var e;this.widget.proactiveChat&&-1<this.widget.proactiveTime&&(this.proactiveTimer=setTimeout((e=this,function(){e.chatView.isMinimized()&&!e.chatView.forceMinimized&&(l("#lc_chat_layout").show(),e.chat.proactive=!0,e.chatView.expand(!1))}),1e3*this.widget.proactiveTime))},e.prototype.hideCustomChatWidget=function(){l(this.customWidget).hide()},e.prototype.customChatWidgetExists=function(){return!!l(this.customWidget).length},e.prototype.hideNormalChatWidget=function(){l(this.mainLayout).hide()},e.prototype.renderWidget=function(){var e;e={widgetPosition:this.widgetPosition(),widgetColors:this.widgetColors(),widgetTitle:this.widgetTitle(),loaderMessage:this.widget.loaderMessage,messageBoxPlaceholder:this.widget.messageBoxPlaceholder},l("body").append(n.template(a.templates.chat,e))},e.prototype.widgetPosition=function(){var e,t,n,i;return n=this.widget.windowOffset,i="Bottom Left"===this.widget.windowPosition?"left:":"right:",e=this.mainLayout+" {"+i+n+"px} ",l("head").append("<style type='text/css'>"+e+"</style>"),t="Bottom Left"===this.widget.windowPosition?"lc-align-left":"lc-align-right",this.isMobileBrowser?t:""},e.prototype.widgetColors=function(){var e,t,n,i,r,o,s;return i=this.widget.windowColor,t=this.convert2Hex(i,30),400<(s=parseInt(i.substr(1,2),16)+parseInt(i.substr(3,2),16)+parseInt(i.substr(5,2),16))&&(e="lc-dark-icon"),r=400<s?r="#000000":"#FFFFFF",o=" "+this.mainLayout+" "+this.header+" {color:"+r+";background-color:"+i+"} ",n=" "+this.mainLayout+" "+this.container+"  {border-color: "+t+"} ",l("head").append("<style type='text/css'> "+o+" /*"+n+"*/ </style>"),{classes:e}},e.prototype.widgetTitle=function(){return this.chat.active&&!this.chat.closed?this.chat.getAgentName():this.widget.title},e.prototype.triggerCookieTest=function(){return window.location.origin||(window.location.origin=window.location.protocol+"//"+window.location.hostname),l("#fc_chat_layout, #lc_chat_layout").append('<iframe id="testCookie" src='+window.livechat.Widget.nodeUrl+"/cookieTest?origin="+encodeURIComponent(window.location.origin)+' style="display:none"></iframe>'),window.addEventListener("message",function(e){var t;livechat.Widget.nodeUrl&&(t=window.livechat.Widget.nodeUrl.match(/^(?:https?:\/\/)?(?:[^@\n]+@)?(?:www\.)?([^:\/\n]+)/im),e.origin===t[0]&&(window.livechat.cookieTest=e.data))},!1)},e.prototype.triggerEventDocument=function(){var e;window.Event&&document.dispatchEvent&&((e=document.createEvent("CustomEvent")).initCustomEvent("lc_widget_loaded",!1,!0,!1),document.dispatchEvent(e))},e.prototype.triggerFDLCWidgetLoaded=function(){var e;window.Event&&document.dispatchEvent&&((e=document.createEvent("CustomEvent")).initCustomEvent("fd_lc_widget_loaded",!1,!0,!1),document.dispatchEvent(e))},e.prototype.convert2Hex=function(e,t){return e=e.replace("#",""),"rgba("+parseInt(e.substring(0,2),16)+","+parseInt(e.substring(2,4),16)+","+parseInt(e.substring(4,6),16)+","+(t/=100)+")"},e.prototype.renderPreChatForm=function(){var e,t;e=l(this.mainLayout),this.canShowPreform()&&(t={preChatMessage:this.widget.preChatMessage,fields:this.widget.preChatFields},e.find(this.chatWindow).before(n.template(a.templates.prechat,t)))},e.prototype.startChat=function(){this.validateForm()&&(this.saveFormFields(),this.chatView.expand(!1),this.chatView.sendMessageOrPing({detailsFromPreChatForm:!0}))},e.prototype.validateForm=function(){var e,t,n,i,r,o,s,a,c;for(i={},o=!0,s=0,a=(c=l("#lc_prechat_form input, #lc_prechat_form select")).length;s<a;s++)if(e=c[s],n=(e=l(e)).attr("id").replace("lc_chat_",""),r=l.trim(e.val()),i[n]=r,(t=this.widget.preChatFields[n]).value=r,!t.isValid()){"dropdown"===n?e.parent().addClass("lc-input-error"):e.addClass("lc-input-error"),o=!1;break}return o},e.prototype.saveFormFields=function(){var e,t,n,i,r,o,s,a;for(n in a=["textarea"],s=["name","email"],t=this.widget.offlineChat?this.widget.offlineChatFields:this.widget.preChatFields)r=(e=t[n]).name,c.call(a,r)<0&&e.value&&(i="set"+e.name.charAt(0).toUpperCase()+e.name.substr(1).toLowerCase(),this.visitor[i].call(this.visitor,this.escapeHtml(e.value)),o=e.name,0<=c.call(s,o)&&(this.widget.offlineChat?this.widget.preChatFields[n].value=e.value:this.widget.offlineChatFields[n].value=e.value))},e.prototype.registerPreChatFormDOMEvents=function(){var t,e;return l("#lc_prechat_form :input").on("keydown",(t=this,function(e){l(e.target).removeClass("lc-input-error"),13!==e.keyCode||e.shiftKey||(e.preventDefault(),t.startChat())})),l("#lc_prechat_submit").on("click",(e=this,function(){e.startChat()})),l("#lc_prechat_form").on("change","select",function(e){var t,n;(n=l(e.target)).parent().removeClass("lc-input-error"),"-1"!==(t=n.val())&&-1!==t||(t="..."),n.prev().html(t)}),l("#lc_chat_message_window").on("mousewheel",function(e){var t;if(0===(t=e.originalEvent.wheelDelta||-e.originalEvent.detail))return!1;l("#lc_chat_message_window").get(0).scrollTop+=30*(t<0?1:-1),e.preventDefault()})},e.prototype.registerCoBrowseDOMEvents=function(){var e,t,n,i,r,o,s;return l(".lc-cb-stop-vi").on("click",(e=this,function(){e.coBrowseView.cobrowsingEnd()})),l(".lc-cb-take-control-vi").on("click",(t=this,function(){t.coBrowseView.takeControl()})),l(".lc-cb-give-control-vi").on("click",(n=this,function(){n.coBrowseView.giveControl()})),l("#deny_cb_session_vi").on("click",(i=this,function(){i.coBrowseView.cobrowsingRequestDenied()})),l("#allow_cb_session_vi").on("click",(r=this,function(){r.coBrowseView.cobrowsingRequestAccepted()})),l(".lc-cb-button-allow-vi").on("click",(o=this,function(){o.coBrowseView.allowRequestedControl()})),l(".lc-cb-button-deny-vi").on("click",(s=this,function(){s.coBrowseView.denyCBSessionControl()}))},e.prototype.registerTextContainerDOMEvents=function(){var n,i,r;(n=l("#lc_chat_input_container")).on("keydown",(i=this,function(e){var t;13!==e.keyCode||e.shiftKey?i.isValidKey(e)&&i.chat.isActive()&&i.chatView.triggerTyping():(e.preventDefault(),(t=l.trim(n.val()))&&(i.chatView.sendMessageOrPing({msg:t}),n.val("")),self.isMobileBrowser&&n.blur())})),l("#lc_button_send").on("click",(r=this,function(e){var t;n=l("#lc_chat_input_container"),(t=l.trim(n.val()))&&(r.chatView.sendMessageOrPing({msg:t}),n.val(""))}))},e.prototype.registerWidgetDOMEvents=function(){var e,t,n,i,r,o,s;l(window).focus((t=this,function(){t.pageActive=!0})).blur((e=this,function(){e.pageActive=!1})),l(this.header).on("click",(n=this,function(e){n.chatView.isMinimized()?(n.chatView.forceMinimized=!1,n.chatView.expand(n.canShowPreform())):(n.chatView.forceMinimized=!0,n.chatView.collapse())})),l(this.close).on("click",(i=this,function(e){return e.stopPropagation(),i.chatView.isMinimized()&&i.chatView.expand(),window.LIVECHAT_SUPPORT&&a.Widget.offlineChat&&l(".lc-offline-message").is(":visible")?i.chatView.endChat():(l(i.endChatPopUp+" p").html(i.widget.endChatConfirmMessage),l(i.endChatPopUp).removeClass("hide"))})),l(this.closeCanel).on("click",(r=this,function(e){return l(r.endChatPopUp).addClass("hide"),l(r.close).removeAttr("disabled",!0),l(r.close).css("pointer-events","auto")})),l(this.closeConform).on("click",(o=this,function(e){return o.coBrowseView.cobrowsingEnd(),o.chatView.endChat(),o.chatView.collapse()})),l(this.customWidget).click((s=this,function(){l(s.mainLayout).is(":visible")||(l(s.mainLayout).toggle(),s.chatView.forceMinimized=!1,s.chatView.expand(s.canShowPreform()))}))},e.prototype.registerWindowDOMEvents=function(){var e;l(window).on("beforeunload",(e=this,function(){a.client.isConnected()&&(a.client.pushToServer("visitor unload",{chatId:e.chat.id,pageUnload:!0,agentId:e.chat.agentId}),e.chat.isActive()&&e.chatView.chatExpireTimerOn(null,!0),a.client.disconnect()),window.LIVECHAT_SUPPORT&&a.Cache.removeItem("livechat_vid")}))},e.prototype.isValidKey=function(e){var t,n;return t=!0,n=[9,16,17,18,27,37,38,39,40,224],(""===l(e.target).val()||e.metaKey||e.ctrlKey||0<=n.indexOf(e.keyCode))&&(t=!1),t},e.prototype.escapeHtml=function(e){var t;return t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},String(e).replace(/[&<>"']/g,function(e){return t[e]})},e.prototype.canShowPreform=function(){return this.widget.preChatForm&&this.chat.isInActive()&&!this.chat.pingSent},e.prototype.resetMainView=function(){a.client&&a.client.primary&&a.client.primary.reset(),a.MainView=new e},e}(),a.MainView=new e}.call(this),function(){var e;(e=window.livechat).JSON3=JSON3.noConflict(),e.MainView.render()}.call(this);